(this.webpackJsonpsmc=this.webpackJsonpsmc||[]).push([[0],{594:function(e,t,n){},903:function(e,t,n){"use strict";n.r(t);var i=n(53),r=n.n(i),a=(n(594),n(40)),o=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,932)).then((function(t){var n=t.getCLS,i=t.getFID,r=t.getFCP,a=t.getLCP,o=t.getTTFB;n(e),i(e),r(e),a(e),o(e)}))},s=n(30),c=n(43),d=n(44),l=n(26),u=n(12),h=(Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_PLATFORM,"native"===Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_PLATFORM?Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_API_SERVER:""),p=function e(t,n,i){Object(l.a)(this,e),this.id=void 0,this.name=void 0,this.description=void 0,this.id=t,this.name=n,this.description=i,Object(u.o)(this,{id:u.p,name:u.p,description:u.p})},b=function(e){Object(c.a)(n,e);var t=Object(d.a)(n);function n(){var e;return Object(l.a)(this,n),(e=t.call(this,"".concat(h,"/api/project"),void 0,!1)).deserialize=function(e){return new p(e.id,e.name,e.description)},e}return Object(s.a)(n,[{key:"serializeUpdateDraft",value:function(e){return{id:e.name,name:e.name,description:e.description}}},{key:"serializeCreateDraft",value:function(e){return{name:e.name,description:e.description}}}]),n}(a.b),f=n(0),v=n.n(f);function j(e){return void 0!==e.nLines}var g=function(e){Object(c.a)(n,e);var t=Object(d.a)(n);function n(){var e;return Object(l.a)(this,n),(e=t.call(this,"".concat(h,"/api/tablerow"),void 0,!1,[new a.j("table","index")])).findByTable=function(t,n,i){var r=e.tableIndex.index.get(t);if(void 0===r)return[];for(var a=[],o=0;o<i;o++){var s=r.get(o+n);if(void 0===s)break;a.push(e.records.get(s))}return a},e.deserialize=function(e){return Object.values(e.links).forEach((function(e){e.forEach((function(e){null!==e.entity&&(e.entityId=e.entity),e.candidate_entities.forEach((function(e){e.entityId=e.entity,delete e.entity})),e.candidateEntities=e.candidate_entities,delete e.entity_id,delete e.candidate_entities}))})),e},e}return Object(s.a)(n,[{key:"tableIndex",get:function(){return this.indices[0]}},{key:"index",value:function(e){this.tableIndex.add(e)}}]),n}(a.l),x=function(e){Object(c.a)(n,e);var t=Object(d.a)(n);function n(){var e;return Object(l.a)(this,n),(e=t.call(this,"".concat(h,"/api/table"),void 0,!1,[new a.m("project")])).findByProject=function(t,n,i){return Array.from(e.projectIndex.index.get(t)||[]).map((function(t){return e.records.get(t)}))},e.deserialize=function(e){return e.contextPage=e.context_page,null!==e.contextPage&&void 0!==e.contextPage&&null!==e.contextPage.entity&&(e.contextPage.entityId=e.contextPage.entity,delete e.contextPage.entity),e.contextValues=e.context_values,void 0!==e.context_tree&&(e.contextTree=e.context_tree.map((function(e){return e.contentBefore=e.content_before.map((function(e){return void 0!==e.n_lines&&(e.nLines=e.n_lines,delete e.n_lines),e})),e.contentAfter=e.content_after.map((function(e){return void 0!==e.n_lines&&(e.nLines=e.n_lines,delete e.n_lines),e})),delete e.content_before,delete e.content_after,e})),delete e.context_tree),delete e.context_tree,delete e.context_values,delete e.context_page,e},e}return Object(s.a)(n,[{key:"projectIndex",get:function(){return this.indices[0]}},{key:"index",value:function(e){this.projectIndex.add(e)}}]),n}(a.l),O=n(42),y=n(45),m=n(38),w=function e(t){var n=this;Object(l.a)(this,e),this.counter={},this.id2num={},this.label=function(e){return void 0===n.id2num[e.id]||1===n.id2num[e.id]?e.label:"".concat(e.label," ").concat(n.id2num[e.id])},this.nextLabel=function(e,t){return void 0===n.counter[e]?t:"".concat(t," ").concat(n.counter[e])},this.add=function(e){void 0===n.counter[e.uri]&&(n.counter[e.uri]=1),n.id2num[e.id]=n.counter[e.uri],n.counter[e.uri]+=1},this.getNum=function(e){return n.id2num[e.id]};var i,r=Object(m.a)(t||[]);try{for(r.s();!(i=r.n()).done;){var a=i.value;"class_node"===a.nodetype&&(void 0===this.counter[a.uri]&&(this.counter[a.uri]=1),this.id2num[a.id]=this.counter[a.uri],this.counter[a.uri]+=1)}}catch(o){r.e(o)}finally{r.f()}},I=function(){function e(t,n,i){var r=this;Object(l.a)(this,e),this.id=void 0,this.version=void 0,this.nodes=void 0,this.edges=void 0,this.stale=void 0,this.nodeId2Index={},this.column2nodeIndex={},this.uriCount=void 0,this.clone=function(){var t=r.toJS();return new e(r.id,t.nodes,t.edges)},this.onSave=function(){r.stale=!1},this.node=function(e){return r.nodes[r.nodeId2Index[e]]},this.hasNode=function(e){return void 0!==r.nodeId2Index[e]},this.nodesByURI=function(e){return r.nodes.filter((function(t){return"class_node"===t.nodetype&&t.uri===e}))},this.nodeByColumnIndex=function(e){return r.nodes[r.column2nodeIndex[e]]},this.nodeByEntityId=function(e){return r.nodes.filter((function(t){return"literal_node"===t.nodetype&&"entity-id"===t.value.type&&t.value.id===e}))[0]},this.edge=function(e,t){return r.edges.filter((function(n){return n.source===e&&n.target===t}))[0]},this.hasEdge=function(e,t){return r.edges.filter((function(n){return n.source===e&&n.target===t})).length>0},this.incomingEdges=function(e){return r.edges.filter((function(t){return t.target===e}))},this.outgoingEdges=function(e){return r.edges.filter((function(t){return t.source===e}))},this.nextNodeId=function(){for(var e=0;e<100*r.nodes.length;e++){var t="c-".concat(e);if(void 0===r.nodeId2Index[t])return t}throw new Error("Cannot find new id for a node")},this.findPathMax2hops=function(e,t){var n,i=[],a=r.outgoingEdges(e),o=Object(m.a)(a);try{for(o.s();!(n=o.n()).done;){var s=n.value;if(s.target!==t){var c,d=Object(m.a)(r.outgoingEdges(s.target));try{for(d.s();!(c=d.n()).done;){var l=c.value;l.target===t&&i.push([s,l])}}catch(u){d.e(u)}finally{d.f()}}else i.push([s,void 0])}}catch(u){o.e(u)}finally{o.f()}return i},this.getClassIdOfColumnIndex=function(e){var t,n=r.incomingEdges(r.nodeByColumnIndex(e).id),i=Object(m.a)(n);try{for(i.s();!(t=i.n()).done;){var a=t.value;if("http://www.w3.org/2000/01/rdf-schema#label"===a.uri){if(n.length>1)throw new Error("Invalid semantic model. An entity column has two incoming edges");return a.source}}}catch(o){i.e(o)}finally{i.f()}},this.getOutgoingProperties=function(e){var t,n=[],i=Object(m.a)(r.outgoingEdges(e));try{for(i.s();!(t=i.n()).done;){var a=t.value,o=r.node(a.target);if("class_node"===o.nodetype&&"http://wikiba.se/ontology#Statement"===o.uri){var s,c=Object(m.a)(r.outgoingEdges(a.target));try{for(c.s();!(s=c.n()).done;){var d=s.value;n.push([a,d])}}catch(l){c.e(l)}finally{c.f()}}else n.push([a,void 0])}}catch(l){i.e(l)}finally{i.f()}return n},this._removeNode=function(e){if(void 0!==r.nodeId2Index[e]&&void 0!==r.nodes[r.nodeId2Index[e]]){var t=r.nodeId2Index[e],n=r.nodes[t];if(!("data_node"===n.nodetype||"literal_node"===n.nodetype&&n.isInContext)){r.nodes[t]=void 0;var i,a=r.edges.filter((function(t){return t.source===e||t.target===e})),o=Object(m.a)(a);try{for(o.s();!(i=o.n()).done;){var s=i.value;r._removeEdge(s.source,s.target)}}catch(c){o.e(c)}finally{o.f()}}}},this._removeEdge=function(e,t){for(var n=void 0,i=0,a=0,o=0;o<r.edges.length;o++){var s=r.edges[o];s.source===e&&s.target===t&&(n=o),s.source!==e&&s.target!==e||(i+=1),s.source!==t&&s.target!==t||(a+=1)}void 0!==n&&(r.edges.splice(n,1),1===i&&r._removeNode(e),1===a&&r._removeNode(t))},this.buildIndex=function(){r.nodeId2Index={},r.column2nodeIndex={};for(var e=0;e<r.nodes.length;e++){var t=r.nodes[e];r.nodeId2Index[t.id]=e,"data_node"===t.nodetype&&null!==t.columnIndex&&(r.column2nodeIndex[t.columnIndex]=e)}},this.id=t,this.version=0,this.nodes=n,this.edges=i,this.stale=!1,this.buildIndex(),this.uriCount=new w(this.nodes),Object(u.o)(this,{version:u.p,nodes:u.p,edges:u.p,stale:u.p,nodeId2Index:u.p,column2nodeIndex:u.p,uriCount:u.p,addColumnRelationship:u.f,upsertColumnType:u.f,upsertRelationship:u.f,addClassNode:u.f,addLiteralNode:u.f,removeNode:u.f,updateClassNode:u.f,updateDataNode:u.f,updateLiteralNode:u.f,addEdge:u.f,removeEdge:u.f,updateEdge:u.f})}return Object(s.a)(e,[{key:"toJS",value:function(){return{nodes:Object(u.s)(this.nodes),edges:Object(u.s)(this.edges),nodeId2Index:Object(u.s)(this.nodeId2Index)}}},{key:"addColumnRelationship",value:function(e,t,n){var i=this.nodeByColumnIndex(e),r=this.nodeByColumnIndex(t),a=this.incomingEdges(i.id);if(0===a.length)throw new Error("Cannot add link from a data node to another node");if(1!==a.length)throw new Error("The source column connects to multiple class nodes! Don't know the exact class node to choose");var o=this.incomingEdges(r.id);if(o.length>1)throw new Error("The target column connects to multiple class nodes! Don't know the exact class node to choose");var s=a[0].source,c=0===o.length?r.id:o[0].source;this.addEdge(Object(y.a)(Object(y.a)({},n),{},{source:s,target:c}))}},{key:"upsertColumnType",value:function(e,t){var n=this.nodeByColumnIndex(e),i=this.incomingEdges(n.id);if(i.length>1)throw new Error("The column connects to multiple class nodes! Don't know the exact class node to choose");if(0===i.length){var r=this.nextNodeId();this.addClassNode(Object(y.a)(Object(y.a)({},t),{},{id:r})),this.addEdge({source:r,target:n.id,uri:"http://www.w3.org/2000/01/rdf-schema#label",label:"rdfs:label",approximation:!1})}else{var a=i[0];this.updateClassNode(a.source,t),"http://www.w3.org/2000/01/rdf-schema#label"!==a.uri&&this.updateEdge(a.source,a.target,{uri:"http://www.w3.org/2000/01/rdf-schema#label",label:"rdfs:label",approximation:a.approximation})}}},{key:"upsertRelationship",value:function(e,t,n,i){var r=this.findPathMax2hops(e,t);if(0!==r.length){if(r.length>1)throw new Error("There are more one path between two nodes. Don't know which path to update it");var a=Object(O.a)(r[0],2),o=a[0],s=a[1];this.updateEdge(o.source,o.target,{uri:n.uri,label:n.label,approximation:!1}),void 0!==s&&this.updateEdge(s.source,s.target,{uri:i.uri,label:i.label,approximation:!1})}else if(n.uri===i.uri)this.addEdge({source:e,target:t,uri:n.uri,label:n.label,approximation:!1});else{var c=this.nextNodeId();this.addClassNode({id:c,uri:"http://wikiba.se/ontology#Statement",label:"wikibase:Statement",approximation:!1,nodetype:"class_node"}),this.addEdge({source:e,target:c,uri:n.uri,label:n.label,approximation:!1}),this.addEdge({source:c,target:t,uri:i.uri,label:i.label,approximation:!1})}}},{key:"addClassNode",value:function(e){if(void 0!==this.nodeId2Index[e.id])throw new Error("Duplicated id");this.nodeId2Index[e.id]=this.nodes.length,this.nodes.push(e),this.uriCount.add(e),this.version+=1,this.stale=!0}},{key:"addLiteralNode",value:function(e){if(void 0!==this.nodeId2Index[e.id])throw new Error("Duplicated id");this.nodeId2Index[e.id]=this.nodes.length,this.nodes.push(e),this.version+=1,this.stale=!0}},{key:"removeNode",value:function(e){this._removeNode(e),this.nodes=this.nodes.filter((function(e){return void 0!==e})),this.buildIndex(),this.version+=1,this.stale=!0,this.uriCount=new w(this.nodes)}},{key:"updateClassNode",value:function(e,t){var n=this.nodeId2Index[e],i=this.nodes[n];if("class_node"!==i.nodetype)throw new Error("Invalid node type. Expected class node but get ".concat(i.nodetype));Object.assign(i,t),this.version+=1,this.stale=!0,void 0!==t.uri&&(this.uriCount=new w(this.nodes))}},{key:"updateLiteralNode",value:function(e,t){var n=this.nodeId2Index[e],i=this.nodes[n];if("literal_node"!==i.nodetype)throw new Error("Invalid node type. Expected literal node but get ".concat(i.nodetype));Object.assign(i,t),this.version+=1,this.stale=!0}},{key:"updateDataNode",value:function(e,t){var n=this.nodeId2Index[e],i=this.nodes[n];if("data_node"!==i.nodetype)throw new Error("Invalid node type. Expected data node but get ".concat(i.nodetype));Object.assign(i,t),this.version+=1,this.stale=!0}},{key:"addEdge",value:function(e){if(this.hasEdge(e.source,e.target))throw new Error("Cannot have more than one edge between two nodes");this.edges.push(e),this.version+=1,this.stale=!0}},{key:"removeEdge",value:function(e,t){var n=this.nodes.length;this._removeEdge(e,t),this.nodes=this.nodes.filter((function(e){return void 0!==e})),this.nodes.length!==n&&(this.buildIndex(),this.uriCount=new w(this.nodes)),this.version+=1,this.stale=!0}},{key:"updateEdge",value:function(e,t,n){for(var i=0;i<this.edges.length;i++){var r=this.edges[i];r.source===e&&r.target===t&&(this.edges[i]=Object(y.a)(Object(y.a)({},this.edges[i]),n))}this.version=(this.version||0)+1,this.stale=!0}}]),e}(),k=function(){function e(t,n,i,r,a,o){Object(l.a)(this,e),this.id=void 0,this.name=void 0,this.description=void 0,this.version=void 0,this.graph=void 0,this.table=void 0,this.id=t,this.name=n,this.description=i,this.version=r,this.graph=a,this.table=o}return Object(s.a)(e,[{key:"markSaved",value:function(){this.graph.onSave()}},{key:"toModel",value:function(){return this}}]),e}();k.isDraft=function(e){return void 0!==e.draftID};var S=function(e){Object(c.a)(n,e);var t=Object(d.a)(n);function n(e,i,r,a,o,s){var c;return Object(l.a)(this,n),(c=t.call(this,-1,i,r,a,o,s)).draftID=void 0,c.draftID=e,c}return Object(s.a)(n,null,[{key:"getDefaultDraftSemanticModel",value:function(e,t,i){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",a=new I(e,i.columns.map((function(e,t){return{id:"col-".concat(t),label:e,columnIndex:t,nodetype:"data_node"}})),[]);return a.stale=!0,new n(e,t,r,0,a,i.id)}}]),n}(k),C=function(e){Object(c.a)(n,e);var t=Object(d.a)(n);function n(){var e;return Object(l.a)(this,n),(e=t.call(this,"".concat(h,"/api/semanticmodel"),void 0,!1,[new a.m("table")])).getNewDraftId=function(t){for(var n=0;;){var i="draft-".concat(n,":").concat(t.id);if(void 0===e.getCreateDraft(i))return i;n++}},e.deserialize=function(e){var t=e.data.nodes.map((function(e){var t=e.type;return delete e.type,e.nodetype=t,"data_node"===t?(e.columnIndex=e.column_index,delete e.column_index):"literal_node"===t&&(e.isInContext=e.is_in_context,delete e.is_in_context),e})),n=e.data.edges,i=new I(e.id.toString(),t,n);return new k(e.id,e.name,e.description,e.version,i,e.table)},e}return Object(s.a)(n,[{key:"tableIndex",get:function(){return this.indices[0]}},{key:"getNewSemanticModelName",value:function(e){var t,n=this.findByTable(e.id),i=this.getDraftsByTable(e),r=-1,a=Object(m.a)(n.concat(i));try{for(a.s();!(t=a.n()).done;){var o=t.value,s=/sm-(\d+)/.exec(o.name);null!==s&&(parseInt(s[1])>=r&&(r=Math.max(r,parseInt(s[1]))))}}catch(c){a.e(c)}finally{a.f()}return"sm-".concat(r+1)}},{key:"getDraftsByTable",value:function(e){for(var t=[],n=0;;){var i="draft-".concat(n,":").concat(e.id),r=this.getCreateDraft(i);if(void 0===r)break;t.push(r),n++}return t}},{key:"findByTable",value:function(e){var t=this;return Array.from(this.tableIndex.index.get(e)||[]).map((function(e){return t.records.get(e)}))}},{key:"deindex",value:function(e){var t,n=Object(m.a)(this.indices);try{for(n.s();!(t=n.n()).done;){t.value.remove(e)}}catch(i){n.e(i)}finally{n.f()}}},{key:"hasByTable",value:function(e){return this.tableIndex.index.has(e)}},{key:"serializeUpdateDraft",value:function(e){return e.version+=1,{table:e.table,name:e.name,description:e.description,version:e.version,data:{nodes:e.graph.nodes.map((function(e){switch(e.nodetype){case"class_node":return{id:e.id,uri:e.uri,approximation:e.approximation,label:e.label,type:e.nodetype};case"data_node":return{id:e.id,label:e.label,column_index:e.columnIndex,type:e.nodetype};case"literal_node":return{id:e.id,value:e.value,label:e.label,is_in_context:e.isInContext,type:e.nodetype}}})),edges:e.graph.edges.map((function(e){return{source:e.source,target:e.target,uri:e.uri,approximation:e.approximation,label:e.label}}))}}}},{key:"serializeCreateDraft",value:function(e){return this.serializeUpdateDraft(e)}}]),n}(a.b),P=function e(t,n,i,r,a,o,s){Object(l.a)(this,e),this.id=void 0,this.uri=void 0,this.label=void 0,this.readableLabel=void 0,this.aliases=void 0,this.description=void 0,this.properties=void 0,this.id=t,this.uri=n,this.label=i,this.readableLabel=r,this.aliases=a,this.description=o,this.properties=s,Object(u.o)(this,{id:u.p,label:u.p,aliases:u.p,description:u.p,properties:u.p})};P.id2uri=function(e){switch(e[0]){case"Q":return"https://www.wikidata.org/wiki/".concat(e);case"P":return"https://www.wikidata.org/wiki/Property:".concat(e);case"L":return"https://www.wikidata.org/wiki/Lexeme:".concat(e);default:return e}},P.uri2id=function(e){return e.startsWith("https://www.wikidata.org/wiki/Property:")?e.slice("https://www.wikidata.org/wiki/Property:".length):e.startsWith("https://www.wikidata.org/wiki/Lexeme:")?e.slice("https://www.wikidata.org/wiki/Lexeme:".length):e.startsWith("https://www.wikidata.org/wiki/")?e.slice("https://www.wikidata.org/wiki/".length):e};var E=n(172),L=function(){function e(){var t=this;Object(l.a)(this,e),this._showedPropsInFullView=new Set,this._showedPropsInPopoverView=new Set,this.setShowedPropsInFullView=function(e){t._showedPropsInFullView=e},this.setShowedPropsInPopoverView=function(e){t._showedPropsInPopoverView=e},this.addShowedPropsInFullView=function(e){t._showedPropsInFullView.add(e)},this.addShowedPropsInPopoverView=function(e){t._showedPropsInPopoverView.add(e)},this.removeShowedPropsInFullView=function(e){t._showedPropsInFullView.delete(e)},this.removeShowedPropsInPopoverView=function(e){t._showedPropsInPopoverView.delete(e)},this._showedPropsInPopoverView.add("P31"),Object(u.o)(this,{_showedPropsInFullView:u.p,_showedPropsInPopoverView:u.p,showedPropsInFullView:u.g,showedPropsInPopoverView:u.g,setShowedPropsInFullView:u.f,setShowedPropsInPopoverView:u.f,addShowedPropsInFullView:u.f,addShowedPropsInPopoverView:u.f,removeShowedPropsInFullView:u.f,removeShowedPropsInPopoverView:u.f})}return Object(s.a)(e,[{key:"showedPropsInFullView",get:function(){return Array.from(this._showedPropsInFullView)}},{key:"showedPropsInPopoverView",get:function(){return Array.from(this._showedPropsInPopoverView)}}]),e}(),N=function(e){Object(c.a)(n,e);var t=Object(d.a)(n);function n(){var e;return Object(l.a)(this,n),(e=t.call(this,"".concat(h,"/api/entities"),void 0,!1)).settings=void 0,e.deserialize=function(e){e.readableLabel=e.readable_label,delete e.readable_label;for(var t=0,n=Object.values(e.properties);t<n.length;t++){var i,r=n[t],a=Object(m.a)(r);try{for(a.s();!(i=a.n()).done;){var o=i.value;o.qualifiersOrder=o.qualifiers_order,delete o.qualifiers_order}}catch(s){a.e(s)}finally{a.f()}}return e},e.settings=new L,Object(u.o)(Object(E.a)(e),{settings:u.p}),e}return n}(a.l),_=function(e){Object(c.a)(n,e);var t=Object(d.a)(n);function n(){var e;return Object(l.a)(this,n),(e=t.call(this,"".concat(h,"/api/properties"),{readableLabel:"readable_label"},!1,[new a.n("uri")])).getPropertyByURI=function(t){var n=e.uriIndex.index.get(t);return void 0!==n?e.get(n):void 0},e}return Object(s.a)(n,[{key:"uriIndex",get:function(){return this.indices[0]}}]),n}(a.l),D=function(e){Object(c.a)(n,e);var t=Object(d.a)(n);function n(){var e;return Object(l.a)(this,n),(e=t.call(this,"".concat(h,"/api/classes"),{readableLabel:"readable_label"},!1,[new a.n("uri")])).getClassByURI=function(t){var n=e.uriIndex.index.get(t);return void 0!==n?e.get(n):void 0},e}return Object(s.a)(n,[{key:"uriIndex",get:function(){return this.indices[0]}}]),n}(a.l),T={projectStore:new b,tableStore:new x,tableRowStore:new g,semanticModelStore:new C,entityStore:new N,propertyStore:new _,classStore:new D};window._stores=T;var z=Object(f.createContext)(T);function B(){return v.a.useContext(z)}var F=n(197),R=n(119),A=n(549),M=n(926),H=n(355),V=n(70),W=n(9),U=Object(V.a)((function(){var e=B().projectStore;return Object(f.useEffect)((function(){e.fetch({limit:100,offset:0})}),[e]),Object(W.jsx)(v.a.Fragment,{children:Object(W.jsx)(F.a,{gutter:16,children:Object(W.jsxs)(R.a,{className:"gutter-row",span:24,children:[Object(W.jsx)(A.a.Title,{level:3,children:"Projects"}),Object(W.jsx)(M.b,{size:"small",bordered:!0,itemLayout:"horizontal",dataSource:e.list,renderItem:function(e,t){return Object(W.jsx)(M.b.Item,{children:Object(W.jsx)(M.b.Item.Meta,{avatar:Object(W.jsx)(H.a,{shape:"square",size:"large",style:{marginTop:4,backgroundColor:["#f56a00","#7265e6","#1890ff","#00a2ae"][e.name.charCodeAt(0)%4]},children:e.name[0].toUpperCase()}),title:Object(W.jsx)(a.d,{path:Qt.project,urlArgs:{projectId:e.id},queryArgs:{},children:e.name}),description:e.description})})}})]})})})})),q=n(14),K=n.n(q),J=n(173),Q=n(244),Y=n(923),G=n(210),$=n.n(G),X=Object(Y.a)({table:{"& div.ant-table-container":{border:"1px solid #bbb",borderRadius:4,borderLeft:"1px solid #bbb !important"},"& div.ant-card-body":{paddingLeft:0,paddingRight:0},"& th":{fontWeight:600}}})(Object(V.a)((function(e){var t=e.classes,n=Qt.project.useURLParams().projectId,i=B(),r=i.projectStore,o=i.tableStore;Object(f.useEffect)((function(){r.fetchById(n)}),[r,n]);var s=r.get(n);if(void 0===s)return Object(W.jsx)(a.f,{});if(null===s)return Object(W.jsx)(a.i,{});var c=[{dataIndex:"id",title:"id"},{dataIndex:"name",title:"name",renderText:function(e,t){return Object(W.jsx)(a.d,{path:Qt.table,urlArgs:{tableId:t.id},queryArgs:{query:o.encodeWhereQuery({project:n})},children:t.name})}},{dataIndex:"description",title:"description"}];return Object(W.jsxs)(v.a.Fragment,{children:[Object(W.jsxs)(A.a.Title,{level:3,children:["Project: ",$.a.upperFirst(s.name)]}),Object(W.jsx)(Q.a,{className:t.table,defaultSize:"small",bordered:!0,request:function(){var e=Object(J.a)(K.a.mark((function e(t,i,r){var a;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.fetch({limit:t.pageSize,offset:(t.current-1)*t.pageSize,conditions:{project:n}});case 2:return a=e.sent,e.abrupt("return",{data:a.records.map(Z),success:!0,total:a.total});case 4:case"end":return e.stop()}}),e)})));return function(t,n,i){return e.apply(this,arguments)}}(),options:{search:!0},headerTitle:Object(W.jsx)(A.a.Title,{level:4,children:"Tables"}),search:!1,pagination:{pageSize:500,pageSizeOptions:["10","20","50","100","200","500","1000"]},rowKey:"id",columns:c})]})})));function Z(e){return{id:e.id,name:e.name,description:e.description}}var ee=n(72),te=n(60),ne=n(924),ie=n(271),re=n(925),ae=n(160);function oe(e){var t=Object(f.useMemo)((function(){for(var t=new Set,n=0,i=Object.entries(e.properties);n<i.length;n++){var r=Object(O.a)(i[n],2),a=r[0],o=r[1];t.add(a);var s,c=Object(m.a)(o);try{for(c.s();!(s=c.n()).done;)for(var d=s.value,l=0,u=Object.keys(d.qualifiers);l<u.length;l++){var h=u[l];t.add(h)}}catch(p){c.e(p)}finally{c.f()}}return Array.from(t)}),[e.id]),n=B().propertyStore;return Object(f.useEffect)((function(){n.batch.fetchByIds(t)}),[e.id]),Object.fromEntries(t.map((function(e){var t=n.get(e);return t?[e,t]:[e,{id:e,doesNotExist:null===t}]})))}var se=["entity","nolink","onCtrlClick"],ce=function(e){var t=e.entity,n=e.nolink,i=void 0!==n&&n,r=e.onCtrlClick,o=Object(ae.a)(e,se);return i?Object(W.jsx)("span",Object(y.a)(Object(y.a)({},o),{},{children:t.readableLabel})):Object(W.jsx)(a.c,Object(y.a)(Object(y.a)({href:P.id2uri(t.id),openInNewPage:!0,onCtrlClick:r},o),{},{children:t.readableLabel}))},de=n(540),le=n.n(de),ue=n(184),he=n(550),pe=n(551),be=Object(V.a)((function(e){var t=e.entityId,n=e.render,i=e.renderLoading,r=e.renderNotFound,o=e.forceWaiting,s=void 0!==o&&o,c=B().entityStore;Object(f.useEffect)((function(){c.batch.fetchById(t)}),[c,t]);var d=c.get(t);return void 0===d?s?void 0!==i?i():Object(W.jsx)(a.f,{}):Object(W.jsx)("span",{children:t}):null===d?void 0!==r?r():Object(W.jsx)(pe.a,{status:"404",title:"404",subTitle:"Entity ".concat(t," does not exist")}):n(d,c.settings)})),fe=["property","nolink","showId"],ve=function(e){var t=e.property,n=e.nolink,i=void 0!==n&&n,r=e.showId,o=void 0!==r&&r,s=Object(ae.a)(e,fe);if(void 0!==t.doesNotExist)return t.doesNotExist?Object(W.jsx)("span",Object(y.a)(Object(y.a)({},s),{},{children:Object(W.jsxs)("i",{children:["Property ",t.id," doesn't exist"]})})):i?Object(W.jsxs)("span",Object(y.a)(Object(y.a)({},s),{},{children:["(",t.id,")"]})):Object(W.jsxs)(a.c,Object(y.a)(Object(y.a)({href:"",openInNewPage:!0},s),{},{children:["(",t.id,")"]}));if(i)return Object(W.jsxs)("span",Object(y.a)(Object(y.a)({},s),{},{children:[t.label," (",t.id,")"]}));var c=o?"".concat(t.label," (").concat(t.id,")"):t.label;return Object(W.jsx)(a.c,Object(y.a)(Object(y.a)({href:t.uri,openInNewPage:!0},s),{},{children:c}))},je=n(555),ge=n(361),xe=Object(Y.a)({hide:{display:"none"}})((function(e){var t=Object(f.useState)(!1),n=Object(O.a)(t,2),i=n[0],r=n[1],a=function(){r(!i)},o=i?Object(W.jsx)(je.a,{onClick:a}):Object(W.jsx)(ge.a,{onClick:a});return Object(W.jsxs)("div",{children:[Object(W.jsxs)(te.b,{size:4,children:[e.children,o]}),Object(W.jsx)("div",{className:i?"":e.classes.hide,children:e.collapsible})]})})),Oe=Object(Y.a)({})((function(e){var t=e.value;return"entityid"===t.type?Object(W.jsx)(be,{entityId:t.value,render:function(e){return Object(W.jsx)(ce,{entity:e})}}):"time"===t.type?Object(W.jsx)(xe,{collapsible:Object(W.jsxs)("ul",{children:[Object(W.jsxs)("li",{children:[Object(W.jsx)("b",{children:"Timezone:"})," ",t.value.timezone]}),Object(W.jsxs)("li",{children:[Object(W.jsx)("b",{children:"From:"})," ",t.value.before," - ",t.value.after]}),Object(W.jsxs)("li",{children:[Object(W.jsx)("b",{children:"Precision:"})," ",t.value.precision]}),Object(W.jsxs)("li",{children:[Object(W.jsx)("b",{children:"Calendar Model:"})," ",Object(W.jsx)(a.c,{href:t.value.calendarmodel,openInNewPage:!0,children:t.value.calendarmodel})]})]}),children:t.value.time}):"quantity"===t.type?Object(W.jsx)(xe,{collapsible:Object(W.jsxs)("ul",{children:[Object(W.jsxs)("li",{children:[Object(W.jsx)("b",{children:"Bound:"})," ",t.value.lowerBound," -"," ",t.value.upperBound]}),Object(W.jsxs)("li",{children:[Object(W.jsx)("b",{children:"Unit:"})," ",t.value.unit]})]}),children:t.value.amount}):"monolingualtext"===t.type?Object(W.jsxs)("span",{children:[t.value.text," ",Object(W.jsxs)("i",{children:["@",t.value.language]})]}):"globecoordinate"===t.type?Object(W.jsx)(xe,{collapsible:Object(W.jsxs)("ul",{children:[Object(W.jsxs)("li",{children:[Object(W.jsx)("b",{children:"Precision:"})," ",t.value.precision]}),Object(W.jsxs)("li",{children:[Object(W.jsx)("b",{children:"Globe:"})," ",Object(W.jsx)(a.c,{href:t.value.globe,openInNewPage:!0,children:t.value.globe})]})]}),children:Object(W.jsxs)(a.c,{href:"http://maps.google.com/maps?q=".concat(t.value.latitude,",").concat(t.value.longitude),openInNewPage:!0,children:[t.value.latitude," N,",t.value.longitude," W"]})}):"object"===typeof t.value?Object(W.jsx)("span",{children:JSON.stringify(t.value)}):Object(W.jsx)("span",{children:t.value})})),ye=["stmt","classes","id2prop"],me=Object(Y.a)({qualifiers:{marginLeft:24}})((function(e){var t,n=e.stmt,i=e.classes,r=e.id2prop,a=Object(ae.a)(e,ye),o=[],s=Object(m.a)(n.qualifiersOrder);try{for(s.s();!(t=s.n()).done;){var c=t.value,d=void 0;d=0===n.qualifiers[c].length?Object(W.jsx)(A.a.Text,{type:"secondary",italic:!0,children:"no value"}):n.qualifiers[c].map((function(e,t){return Object(W.jsx)("div",{children:Object(W.jsx)(Oe,{value:e})},t)})),o.push(Object(W.jsxs)(F.a,{gutter:8,children:[Object(W.jsx)(R.a,{span:6,children:Object(W.jsx)(ve,{property:r[c]})}),Object(W.jsx)(R.a,{span:18,children:d})]},c))}}catch(l){s.e(l)}finally{s.f()}return Object(W.jsxs)("div",Object(y.a)(Object(y.a)({},a),{},{children:[Object(W.jsx)("div",{children:Object(W.jsx)(Oe,{value:n.value})}),Object(W.jsx)("div",{className:i.qualifiers,children:o})]}))})),we=Object(Y.a)({propDivider:{height:1,border:"none",color:"#ddd",backgroundColor:"#ddd"}})(Object(V.a)((function(e){var t=e.entity,n=e.id2prop,i=e.filteredProps,r=e.showId,a=void 0!==r&&r,o=e.classes;0===i.length&&(i=Object.keys(t.properties));var s,c=[],d=Object(m.a)(i);try{for(d.s();!(s=d.n()).done;){var l=s.value;if(void 0!==t.properties[l]){var u=t.properties[l];c.length>0&&c.push(Object(W.jsx)("hr",{className:o.propDivider},"divider-".concat(l))),c.push(Object(W.jsxs)(F.a,{gutter:8,children:[Object(W.jsx)(R.a,{span:6,children:Object(W.jsx)(A.a.Text,{strong:!0,children:Object(W.jsx)(ve,{property:n[l],showId:a})})}),Object(W.jsx)(R.a,{span:18,children:Object(W.jsx)(te.b,{direction:"vertical",style:{width:"100%"},children:u.map((function(e,t){return Object(W.jsx)(me,{stmt:e,id2prop:n},t)}))})})]},l))}}}catch(h){d.e(h)}finally{d.f()}return Object(W.jsx)(te.b,{direction:"vertical",style:{width:"100%"},size:2,children:c})}))),Ie=n(162),ke=n(149),Se=Object(Y.a)({root:{width:240}})(Object(V.a)((function(e){var t=e.entity,n=e.enable,i=e.setEnable,r=e.id2prop,a=e.filteredProps,o=e.addFilteredProp,s=e.removeFilteredProp,c=e.classes,d=Object(f.useMemo)((function(){return Object.keys(t.properties).map((function(e){return{label:"".concat(r[e].label," (").concat(e,")"),value:e}}))}),[r,t.id]);return Object(W.jsxs)("div",{children:[Object(W.jsx)(Ie.a,{onChange:function(){return i(!n)},checked:n,children:"Enable Filtering"}),Object(W.jsx)(ke.a,{mode:"multiple",allowClear:!0,options:d,optionFilterProp:"label",className:c.root,value:a,onSelect:o,onDeselect:s})]})}))),Ce=Object(Y.a)({root:{"& > h2, p, span":{margin:0},minWidth:360}})(Object(V.a)((function(e){var t=e.entity,n=e.settings,i=oe(t),r=Object(f.useState)(!0),o=Object(O.a)(r,2),s=o[0],c=o[1];return Object(W.jsxs)("div",{children:[Object(W.jsx)(te.b,{style:{float:"right"},children:Object(W.jsx)(Se,{enable:s,setEnable:c,entity:t,id2prop:i,filteredProps:n.showedPropsInFullView,addFilteredProp:n.addShowedPropsInFullView,removeFilteredProp:n.removeShowedPropsInFullView})}),Object(W.jsxs)("h2",{children:[Object(W.jsx)(a.c,{href:P.id2uri(t.id),openInNewPage:!0,children:t.label.lang2value[t.label.lang]}),"\xa0",Object(W.jsxs)(A.a.Text,{italic:!0,strong:!1,style:{fontSize:14,fontWeight:400},copyable:{text:t.id},children:["(",t.id,")"]})]}),Object(W.jsx)(A.a.Text,{type:"secondary",children:t.aliases.lang2values[t.aliases.lang].join(" | ")}),Object(W.jsx)("p",{children:t.description.lang2value[t.description.lang]}),Object(W.jsx)("hr",{}),Object(W.jsx)(we,{entity:t,id2prop:i,showId:!0,filteredProps:s?n.showedPropsInFullView:[]})]})})));function Pe(e,t){var n;n="string"!==typeof e?Object(W.jsx)(Ce,{entity:e.entity,settings:e.settings}):Object(W.jsx)(be,{entityId:e,render:function(e,t){return Object(W.jsx)(Ce,{entity:e,settings:t})}}),he.a.info({icon:null,content:n,bodyStyle:{margin:-8,marginTop:-16},okButtonProps:{style:{display:"none"}},maskClosable:!0,mask:!0,zIndex:t,width:"calc(100% - 128px)",style:{top:64}})}var Ee=["entity","children","classes","zIndex","settings"],Le=Object(Y.a)({root:{"& > h2, p, span":{margin:0},minWidth:600}})((function(e){var t=e.entity,n=e.children,i=e.classes,r=e.zIndex,o=e.settings,s=Object(ae.a)(e,Ee),c=oe(t),d=Object(W.jsxs)("div",Object(y.a)(Object(y.a)({},s),{},{className:"".concat(i.root," ").concat(s.className),children:[Object(W.jsxs)("h2",{children:[Object(W.jsx)(a.c,{href:P.id2uri(t.id),openInNewPage:!0,children:t.label.lang2value[t.label.lang]}),"\xa0",Object(W.jsxs)(A.a.Text,{italic:!0,strong:!1,style:{fontSize:14,fontWeight:400},copyable:{text:t.id},children:["(",t.id,")"]}),Object(W.jsx)(le.a,{style:{marginBottom:-2,paddingTop:4,cursor:"pointer"},onClick:function(){Pe({entity:t,settings:o},void 0!==r?r+1:void 0)}})]}),Object(W.jsx)(A.a.Text,{type:"secondary",children:t.aliases.lang2values[t.aliases.lang].join(" | ")}),Object(W.jsx)("p",{children:t.description.lang2value[t.description.lang]}),Object(W.jsx)("hr",{}),Object(W.jsx)(we,{id2prop:c,entity:t,filteredProps:o.showedPropsInPopoverView})]}));return Object(W.jsx)(ue.a,{content:d,zIndex:r,children:n})})),Ne=n(57),_e=n(273),De=["value","fractionDigits"],Te=function(e){var t=e.value,n=e.fractionDigits,i=Object(ae.a)(e,De);return Object(W.jsx)("span",Object(y.a)(Object(y.a)({title:t.toString()},i),{},{children:t.toFixed(n)}))},ze=n(541),Be=Object(Y.a)({checkboxIcon:{padding:1,border:"1px solid",borderRadius:2}})((function(e){var t=e.icon,n=e.classes,i=e.selected,r=e.onChange,a=e.colorSelected,o=void 0===a?Ne.a[5]:a,s=e.colorUnselected,c=void 0===s?Ne.e[5]:s,d=Object(f.useState)(!1),l=Object(O.a)(d,2),u=l[0],h=l[1],p=void 0===i?u:i;return Object(W.jsx)(ze.a,{icon:t,color:p?o:c,className:n.checkboxIcon,onClick:function(){if(void 0!==i&&void 0!==r)return r(!i);h(!u)}})})),Fe={correctCandidateEntity:{color:Ne.a[5]},candidateEntity:{color:Ne.e[5],"&:hover":{color:"".concat(Ne.e[5]," !important")}},candidateEntitySeeMore:{color:Ne.e[5],cursor:"pointer"}},Re=Object(Y.a)(Fe)((function(e){var t=e.record,n=e.index,i=e.classes,r=e.topK,a=void 0===r?3:r,o=Object(f.useState)(!1),s=Object(O.a)(o,2),c=s[0],d=s[1],l=t.links[n]||[],u=[];if(l.length>0){var h,p=Object(m.a)(l[0].candidateEntities.slice(0,a));try{var b=function(){var e=h.value,t=e.entityId===l[0].entityId?i.correctCandidateEntity:i.candidateEntity;u.push(Object(W.jsx)("div",{children:Object(W.jsxs)(te.b,{size:4,children:[Object(W.jsx)(Be,{icon:_e.a}),Object(W.jsx)(Be,{icon:_e.b}),Object(W.jsx)(be,{entityId:e.entityId,render:function(e,n){return Object(W.jsx)(Le,{entity:e,settings:n,children:Object(W.jsx)(ce,{nolink:!0,entity:e,className:t})})}}),Object(W.jsxs)("span",{className:t,children:["(",Object(W.jsx)(Te,{value:e.probability,fractionDigits:3}),")"]})]})},e.entityId))};for(p.s();!(h=p.n()).done;)b()}catch(y){p.e(y)}finally{p.f()}var j=l[0].candidateEntities.findIndex((function(e){return e.entityId===l[0].entityId}));if(-1!==j&&j>=a){var g=l[0].candidateEntities[j];u.push(Object(W.jsx)("div",{children:Object(W.jsxs)(te.b,{size:4,children:[Object(W.jsx)(Be,{icon:_e.a}),Object(W.jsx)(Be,{icon:_e.b}),Object(W.jsx)(be,{entityId:g.entityId,render:function(e,t){return Object(W.jsxs)("span",{className:i.correctCandidateEntity,children:["(",j,")\xa0",Object(W.jsx)(Le,{entity:e,settings:t,children:Object(W.jsx)(ce,{nolink:!0,entity:e})})]})}}),Object(W.jsxs)("span",{className:i.correctCandidateEntity,children:["(",Object(W.jsx)(Te,{value:g.probability,fractionDigits:3}),")"]})]})},g.entityId))}l[0].candidateEntities.length>a&&u.push(Object(W.jsx)("div",{children:Object(W.jsx)(A.a.Text,{className:i.candidateEntitySeeMore,onClick:function(){return d(!c)},children:"See more"})},"see-more"))}var x=[{dataIndex:"id",title:"Entity",render:function(e){return Object(W.jsx)(be,{entityId:e,render:function(e,t){return Object(W.jsx)(Le,{entity:e,settings:t,children:Object(W.jsx)(ce,{nolink:!0,entity:e})})}})}},{dataIndex:"score",title:"Score",render:function(e){return Object(W.jsx)(Te,{value:e,fractionDigits:5})}},{title:"action",render:function(){return Object(W.jsx)(te.b,{size:4,children:Object(W.jsx)(ee.a,{children:"Select"})})}}];return Object(W.jsxs)(v.a.Fragment,{children:[u,Object(W.jsx)(he.a,{title:"Candidate Entities",visible:c,style:{top:20},bodyStyle:{padding:0},width:"60%",onOk:function(){return d(!1)},onCancel:function(){return d(!1)},children:Object(W.jsx)(Q.a,{defaultSize:"small",bordered:!0,search:!1,pagination:{pageSize:20,pageSizeOptions:["20","50","100","200","500","1000"]},rowKey:"id",columns:x,request:function(){var e=Object(J.a)(K.a.mark((function e(t,n,i){return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.resolve({total:l.length>0?l[0].candidateEntities.length:0,success:!0,data:0===l.length?[]:l[0].candidateEntities.slice((t.current-1)*t.pageSize,t.current*t.pageSize).map((function(e,t){return{id:e.entityId,score:e.probability}}))}));case 1:case"end":return e.stop()}}),e)})));return function(t,n,i){return e.apply(this,arguments)}}()})})]})})),Ae={link:{textDecoration:"underline","&:hover":{textDecoration:"underline"}},noEntityLink:{color:Ne.e[5],"&:hover":{color:Ne.e[5]}}},Me=Object(Y.a)(Ae)((function(e){var t=e.cell,n=e.record,i=e.index,r=e.classes,o=e.topK,s=void 0===o?3:o,c=n.links[i]||[],d=c.flatMap((function(e,n){var i=0===n?t.substring(0,e.start):t.substring(c[n-1].end,e.start),o=t.substring(e.start,e.end),s=void 0;void 0!==e.entityId&&(s=function(){Pe(e.entityId)});var d=Object(W.jsx)(a.c,{href:e.url,openInNewPage:!0,dangerouslySetInnerHTML:{__html:""===o.trim()?"&blank;":o},className:r.link+(void 0===e.entityId?" "+r.noEntityLink:""),style:null===e.entityId?{color:"#aaa"}:{},onCtrlClick:s},n);return void 0===e.entityId?[i,d]:[i,Object(W.jsx)(be,{entityId:e.entityId,render:function(e,t){return Object(W.jsx)(Le,{entity:e,zIndex:500,settings:t,children:d})},renderNotFound:function(){return Object(W.jsx)("span",{className:r.noEntityLink,children:d})}},n)]}));return 0===c.length?d.push(t):d.push(t.substring(c[c.length-1].end)),Object(W.jsxs)("div",{children:[d,Object(W.jsx)(Re,{record:n,index:i,topK:s})]})})),He={table:{width:"100%","& div.ant-table-container":{border:"1px solid #bbb",borderRadius:4,borderLeft:"1px solid #bbb !important"},"& div.ant-card-body":{paddingLeft:0,paddingRight:0},"& th":{fontWeight:600},"& .ant-table-cell":{verticalAlign:"top"}}},Ve=Object(Y.a)(He)((function(e){var t=e.table,n=e.query,i=e.classes,r=e.toolBarRender,o=e.showRowIndex,s=void 0!==o&&o,c=t.columns.map((function(e,t){return{dataIndex:["row",t,"value"],title:e,render:function(e,n){return Object(W.jsx)(Me,{cell:e,record:n,index:t})}}}));return s&&c.splice(0,0,{title:Object(W.jsx)(A.a.Text,{type:"secondary",disabled:!0,children:"#"}),dataIndex:"index"}),Object(W.jsxs)(v.a.Fragment,{children:[Object(W.jsx)(Q.a,{className:i.table,defaultSize:"small",bordered:!0,request:function(){var e=Object(J.a)(K.a.mark((function e(i,r,a){var o;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n(i.pageSize,(i.current-1)*i.pageSize);case 2:return o=e.sent,e.abrupt("return",{data:o,success:!0,total:t.size});case 4:case"end":return e.stop()}}),e)})));return function(t,n,i){return e.apply(this,arguments)}}(),search:!1,pagination:{pageSize:5,pageSizeOptions:["5","10","20","50","100","200","500","1000"]},headerTitle:void 0!==t.context.webpage?Object(W.jsx)(a.c,{href:t.context.webpage,openInNewPage:!0,children:t.name}):t.name,toolBarRender:r,rowKey:"index",columns:c}),Object(W.jsx)(We,{table:t})]})})),We=function(e){var t=e.table,n=[["Description",t.description]];void 0!==t.context.webpage?n.push(["From website",Object(W.jsx)(a.c,{href:t.context.webpage,openInNewPage:!0,children:t.context.title})]):n.push(["From website","N/A"]),n.push(["Associated Entity",void 0!==t.context.entityId?Object(W.jsx)(be,{entityId:t.context.entityId,render:function(e,t){return Object(W.jsx)(Le,{entity:e,zIndex:500,settings:t,children:Object(W.jsx)(ce,{entity:e,onCtrlClick:function(){Pe({entity:e,settings:t})}})})},renderNotFound:function(){return Object(W.jsxs)("span",{children:["`Entity $",t.context.entityId," does not exist`"]})}}):"N/A"]);var i=(t.context.contentHierarchy||[]).flatMap((function(e,t){return 0===e.level&&0===e.heading.trim().length&&e.contentBefore.every(j)&&0===e.contentAfter.length?[]:[Object(W.jsx)("p",{children:Object(W.jsxs)("b",{children:["#".repeat(e.level)," ",e.heading]})},"".concat(t,"-head"))].concat(Ue("".concat(t,"-before"),e.contentBefore)).concat(Ue("".concat(t,"-after"),e.contentAfter))}));return n.push(["Content Hierarchy",i.length>0?Object(W.jsx)("div",{children:i}):"N/A"]),Object(W.jsx)(re.b,{title:"Table Info",size:"small",children:n.map((function(e){var t=Object(O.a)(e,2),n=t[0],i=t[1];return Object(W.jsx)(re.b.Item,{label:n,children:i},n)}))})},Ue=function(e,t){var n,i=[[]],r=Object(m.a)(t);try{for(r.s();!(n=r.n()).done;){var a=n.value;j(a)?i.push([]):i[i.length-1].push(a.value)}}catch(o){r.e(o)}finally{r.f()}return i.filter((function(e){return e.length>0})).map((function(t,n){return Object(W.jsx)("p",{children:t},"".concat(e,"-").concat(n))}))},qe=function(){function e(){Object(l.a)(this,e),this.timer=0}return Object(s.a)(e,[{key:"exec",value:function(e){var t=this;this.timer+=1;var n=this.timer;return e().then((function(e){if(!(n<t.timer))return e}))}}]),e}(),Ke={selection:{width:"100%"}},Je=Object(Y.a)(Ke)(Object(V.a)((function(e){return Ge("propertyStore",e)}))),Qe=Object(Y.a)(Ke)(Object(V.a)((function(e){return Ge("classStore",e)}))),Ye=Object(Y.a)(Ke)(Object(V.a)((function(e){return Ge("entityStore",e)})));function Ge(e,t){var n=B()[e],i=new qe;Object(f.useEffect)((function(){void 0!==t.value&&(Array.isArray(t.value)?n.refetch?n.fetchByIds(t.value.filter((function(e){return!n.records.has(e)}))):n.fetchByIds(t.value):void 0===n.get(t.value)&&n.fetchById(t.value))}),[t.value]);var r=Object(f.useMemo)((function(){var e,t=[],i=Object(m.a)(n.iter());try{for(i.s();!(e=i.n()).done;){var r=e.value;t.push({value:r.id,label:r.readableLabel})}}catch(a){i.e(a)}finally{i.f()}return t}),[n.records.size]);return Object(W.jsx)(ke.a,{mode:t.mode,allowClear:!0,options:r,optionFilterProp:"label",className:t.classes.selection,showSearch:!0,onSearch:function(e){""!==e&&i.exec((function(){return n.fetchById(e).then((function(){return 1}))}))},value:t.value,onSelect:t.onSelect,onDeselect:t.onDeselect})}var $e=Object(Y.a)({})(Object(V.a)((function(e){e.classes;var t=B().entityStore;return Object(W.jsxs)(re.b,{title:"Entity Settings",size:"small",column:1,children:[Object(W.jsx)(re.b.Item,{label:"Properties (full view)",children:Object(W.jsx)(Je,{mode:"multiple",value:t.settings.showedPropsInFullView,onSelect:t.settings.addShowedPropsInFullView,onDeselect:t.settings.removeShowedPropsInFullView})}),Object(W.jsx)(re.b.Item,{label:"Properties (popover view)",children:Object(W.jsx)(Je,{mode:"multiple",value:t.settings.showedPropsInPopoverView,onSelect:t.settings.addShowedPropsInPopoverView,onDeselect:t.settings.removeShowedPropsInPopoverView})})]})}))),Xe=n(347),Ze=n(535),et=n(928),tt=n(929),nt=n(191),it=n(547),rt=n.n(it),at=n(548),ot=n.n(at),st=n(62),ct=n(156),dt=n(107),lt=n(105),ut=n(195);function ht(e,t,n,i){var r=i.xoffset,a=i.yoffset,o=i.cfg,s=i.stroke;return r=void 0===r?0:r,a=void 0===a?0:a,void 0!==s&&n.map((function(n){var i=n.text,c=n.x,d=n.y;e.addShape("text",{attrs:Object(y.a)(Object(y.a)({text:i,x:c+r,y:d+a,fontFamily:t.fontFamily},o),{},{fill:s.color,stroke:s.color,lineWidth:s.width}),name:"bg-text",draggable:!0})})),n.map((function(n){var i=n.text,s=n.x,c=n.y;return e.addShape("text",{attrs:Object(y.a)({text:i,fill:"black",x:s+r,y:c+a,fontFamily:t.fontFamily},o),name:"text",draggable:!0})}))}function pt(e){var t=e.getApproximateWidth(4);return ut.a.registerNode("circle-wrap",{draw:function(n,i){return function(n,i){n.style.padding;var r,a,o=(null===(r=n.labelCfg)||void 0===r?void 0:r.offset)||0,s=e.wrapText(n.label,t,"center"),c=s.units,d=s.width,l=i.addShape("circle",{attrs:Object(y.a)({r:10},n.style),name:"circle"});return ht(i,e,c,{xoffset:-d/2,yoffset:10+o,cfg:null===n||void 0===n||null===(a=n.labelCfg)||void 0===a?void 0:a.style,stroke:{color:"white",width:4}}),l}(n,i)}},"single-node"),e}var bt=n(545),ft=n.n(bt),vt=n(546),jt=n.n(vt),gt=function(e,t){return function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];var a=i.join(":");return void 0===t[a]&&(t[a]=e.apply(void 0,i)),t[a]}},xt=function e(t){var n=this;Object(l.a)(this,e),this.paragraph=void 0,this.getDesiredLineLength=void 0,this.cacheLineLengths={},this.cacheLineDemerits={},this.cacheParagraphDemerits={},this.cacheParagraphBreakpoints={},this.optimize=function(){return n.optimizeParagraph(0,n.paragraph.length-1,0)},this.optimizeParagraph=gt((function(e,t,i){var r=n.computeLineAdjustment(e,t,i);if(void 0!==r&&r>=0)return{breakpoints:[],demerits:n.computeLineDemerits(e,t,i)};for(var a={caret:-1,demerits:1/0,breakpoints:[]},o=t-1;o>e;o--)if("box"!==n.paragraph[o].type){var s=n.optimizeParagraph(e,o,i),c=n.optimizeParagraph(o+1,t,i+(s.breakpoints.length>0?s.breakpoints.length+1:0));s.demerits+c.demerits<a.demerits&&(a.caret=o,a.demerits=s.demerits+c.demerits,a.breakpoints=s.breakpoints.slice(),a.breakpoints.push(o),a.breakpoints=a.breakpoints.concat(c.breakpoints))}return{breakpoints:a.breakpoints,demerits:a.demerits}}),this.cacheParagraphBreakpoints),this.computeLineLength=gt((function(e,t){for(var i=0,r=e;r<t;r++)"penalty"!==n.paragraph[r].type&&(i+=n.paragraph[r].width);return"penalty"===n.paragraph[t].type&&(i+=n.paragraph[t].width),i}),this.cacheLineLengths),this.computeLineElastic=function(e,t){for(var i=0,r=0,a=e;a<=t;a++){var o=n.paragraph[a];"glue"===o.type&&(i+=o.stretch,r+=o.shrink)}return{stretchability:i,shrinkability:r}},this.computeLineAdjustment=function(e,t,i){var r=n.computeLineLength(e,t),a=n.getDesiredLineLength(i);if(r===a)return 0;var o=n.computeLineElastic(e,t);if(r<a){if(o.stretchability<0)return;return 0===o.stretchability?(a-r)/.1:(a-r)/o.stretchability}return o.shrinkability<=0?void 0:(a-r)/o.shrinkability},this.computeLineBadness=function(e,t,i){var r=n.computeLineAdjustment(e,t,i);return void 0===r||r<-1?-1/0:Math.pow(r,3)},this.computeLineDemerits=gt((function(e,t,i){var r=n.paragraph[t],a="penalty"===r.type?r.cost:0,o=n.computeLineBadness(e,t,i);return a>=0?Math.pow(1+o+a,2)+0:a===-1/0?Math.pow(1+o,2)+0:Math.pow(1+o,2)-Math.pow(a,2)+0}),this.cacheLineDemerits),this.computeParagraphDemerits=function(e,t,i,r){for(var a=e,o=0,s=0;s<i.length;s++)o+=n.computeLineDemerits(a,i[s],r+s),a=i[s]+1;return o+=n.computeLineDemerits(a,t,r+(i.length>0?i.length+1:0))},this.paragraph=t.units.map((function(e){return(e=Object.assign({},e)).width=e.width/16,"glue"===e.type&&(e.stretch=e.stretch/16,e.shrink=e.shrink/16),e})),this.getDesiredLineLength=function(e){return t.getLineLength(e)/16}},Ot=function(){function e(t,n){var i=this;Object(l.a)(this,e),this.spaceWidth=void 0,this.units=void 0,this.lineLengths=void 0,this.getLineLength=void 0,this.groupByLine=function(e){var t=[],n=0;(e=e.slice()).push(i.units.length-1);var r,a=Object(m.a)(e);try{for(a.s();!(r=a.n()).done;){var o,s=r.value,c=i.units.slice(n,s),d=[],l=Object(m.a)(c);try{for(l.s();!(o=l.n()).done;){var u=o.value;"penalty"!==u.type&&("box"===u.type&&d.length>0&&"box"===d[d.length-1].type?(d[d.length-1].text+=u.text,d[d.length-1].width+=u.width):d.push(Object.assign({},u)))}}catch(h){l.e(h)}finally{l.f()}"penalty"===i.units[s].type&&i.units[s].text.length>0&&d.push(i.units[s]),n=s+1,t.push(d)}}catch(h){a.e(h)}finally{a.f()}return t},this.layout=function(e,t){var n=t.lineHeight,r=t.cssLineHeight,a=t.fontSize,o=t.align,s=(t.verticalAlign,t.autoLength),c=[],d=e.map((function(e){return e.reduce((function(e,t){return e+t.width}),0)})),l=e.map((function(e,t){return i.getLineLength(t)}));if(s)for(var u=Math.max.apply(Math,Object(lt.a)(d)),h=0;h<l.length;h++)l[h]>u&&(l[h]=u);for(var p=0;p<e.length;p++){var b=e[p],f=d[p],v=l[p],j=b.filter((function(e){return"glue"===e.type})).length,g=f<v&&"justify"!==o?i.spaceWidth:Math.abs(v-f)/j+i.spaceWidth,x=(p+1)*n-a*(r-1)/2,O=0;if("center"===o?O+=(v-f)/2:"right"===o&&(O+=v-f),g===i.spaceWidth){var y=Object.assign({x:O,y:x,renderedWidth:f,lineNumber:p},b[0]);y.text=b.map((function(e){return e.text})).join(""),c.push(y)}else{var w,I=Object(m.a)(b);try{for(I.s();!(w=I.n()).done;){var k=w.value,S="glue"===k.type?g:k.width,C=Object.assign({x:O,y:x,renderedWidth:S,lineNumber:p},k);O+=S,c.push(C)}}catch(P){I.e(P)}finally{I.f()}}}return{units:c,lineLengths:d}},this.units=t,this.lineLengths=n,Array.isArray(n)?this.getLineLength=function(e){return e<n.length?n[e]:n[n.length-1]}:this.getLineLength=function(e){return n},this.spaceWidth=0;var r,a=Object(m.a)(t);try{for(a.s();!(r=a.n()).done;){var o=r.value;if("glue"===o.type){this.spaceWidth=o.width;break}}}catch(s){a.e(s)}finally{a.f()}}return Object(s.a)(e,null,[{key:"getUnitsFromText",value:function(e,t,n,i){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1e3,a=[],o=e.split(/(\s+)/).filter((function(e){return e.length>0}));if(void 0!==i&&i.length>0){var s=new RegExp(".*?[".concat(i.join(""),"]|.+"),"g");o=o.flatMap((function(e){return e.match(s)}))}var c=t(" "),d=t("-"),l=function(e){return/\s/.test(e.charAt(0))},u=c/2,h=c/3;return o.forEach((function(e){if(l(e)){var i={type:"glue",width:c,shrink:h,stretch:u,text:e};a.push(i)}else if(a.length>0&&"box"===a[a.length-1].type&&a.push({type:"penalty",width:0,cost:1,flagged:!1,text:""}),n){var o=n(e);o.forEach((function(e,n){var i={type:"box",width:t(e),text:e};if(a.push(i),n<o.length-1){var s={type:"penalty",text:"-",width:d,cost:r,flagged:!0};a.push(s)}}))}else{var s={type:"box",width:t(e),text:e};a.push(s)}})),a.push({type:"glue",width:0,stretch:1e4,shrink:0,text:""}),a}}]),e}(),yt=function e(t,n){var i=this;Object(l.a)(this,e),this.measureCtx=void 0,this.circleLayout=void 0,this.hypher=void 0,this.font=void 0,this.fontFamily=void 0,this.fontSize=void 0,this.cssLineHeight=1.428,this.lineHeight=void 0,this.spaceWidth=void 0,this.separable=["{","}",":",",","'",'"',".","/"],this.wrapText=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"justify",r=new Ot(Ot.getUnitsFromText(e,i.measureText,i.hyphenate,i.separable),t),a=new xt(r).optimize().breakpoints,o=r.layout(r.groupByLine(a),{align:n,cssLineHeight:i.cssLineHeight,fontSize:i.fontSize,lineHeight:i.lineHeight,verticalAlign:"middle",autoLength:!0}),s=o.units,c=o.lineLengths,d=Math.max.apply(Math,Object(lt.a)(c)),l=(a.length+1)*i.lineHeight;return{units:s,width:d,height:l}},this.wrapTextCircle=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,a=i.circleLayout.findRadius(i.measureText(e),n,r)+12,o=i.circleLayout.getLayout(a),s=o.lines,c=i.wrapText(e,s.slice(0,3),"center"),d=c.units,l=c.width,u=Math.max.apply(Math,Object(lt.a)(d.map((function(e){return e.lineNumber}))))+1,h=-(a=l/2),p=-(u%2===1?(u-1)/2:u/2)*i.lineHeight-i.lineHeight/2,b=Object(m.a)(d);try{for(b.s();!(t=b.n()).done;){var f=t.value;f.x+=h,f.y+=p}}catch(v){b.e(v)}finally{b.f()}return{units:d,radius:a}},this.hyphenate=function(e){return e.length>4?i.hypher.hyphenate(e):[e]},this.getApproximateWidth=function(e){return e*i.measureText("abcij ")},this.measureText=function(e){return i.measureCtx.measureText(e).width};var r=document.createElement("canvas");this.measureCtx=r.getContext("2d"),this.spaceWidth=this.measureText(" "),this.font=t.font||"".concat(t.fontSize,"px ").concat(t.fontFamily),this.fontFamily=t.fontFamily,this.fontSize=t.fontSize,this.measureCtx.font=this.font,this.hypher=new jt.a(ft.a),void 0!==n&&(void 0!==n.lineHeight&&(this.cssLineHeight=n.lineHeight),void 0!==n.separable&&(this.separable=n.separable)),this.lineHeight=this.fontSize*this.cssLineHeight,this.circleLayout=new mt(this)};yt.getCssFont=function(e){var t=getComputedStyle(e),n=t.fontStyle,i=t.fontVariant,r=t.fontWeight,a=t.fontSize,o=t.fontFamily;return{font:"".concat(n," ").concat(i," ").concat(r," ").concat(a," ").concat(o),fontSize:parseFloat(a),fontFamily:o}};var mt=function e(t){var n=this;Object(l.a)(this,e),this.lineBreak=void 0,this.lineHeight=void 0,this.radius2layout=void 0,this.findRadius=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,r=0,a=t,o=void 0,s=0;s<t;s++){if(a-r===1){o=a;break}var c=Math.ceil((r+a)/2),d=n.getLayout(c).totalLength;if(d<e)r=c;else{if(!(d-e>i)){o=c;break}a=c}}if(void 0===o)throw new Error("The text of ".concat(e," is too long to render in a circle that has the maximum radius: ").concat(t," - ").concat(n.getLayout(t).totalLength));return o},this.getLayout=function(e){if(void 0===n.radius2layout[e]){for(var t=n.computeHalfNumberOfLines(e),i=[],r=[],a=t;a>0;a--)i.push(n.computeLineLength(a,e)),r.push(e-n.lineHeight*(a+.5));i.push(n.computeCentralLineLength(e)),r.push(e-n.lineHeight/2);for(var o=t-1;o>=0;o--)i.push(i[o]),r.push(e+n.lineHeight*(o-.5));n.radius2layout[e]={lines:i,linesY:r,centralLine:i[t],totalLength:i.reduce((function(e,t){return e+t}))}}return n.radius2layout[e]},this.computeHalfNumberOfLines=function(e){return Math.floor((e-n.lineHeight/2)/n.lineHeight)},this.computeLineLength=function(e,t){return 2*Math.sqrt(Math.pow(t,2)-Math.pow(n.lineHeight*e,2))},this.computeCentralLineLength=function(e){return 2*Math.sqrt(Math.pow(e,2)-Math.pow(n.lineHeight/2,2))},this.lineBreak=t,this.lineHeight=t.lineHeight,this.radius2layout={}},wt=function(){function e(t,n){var i=this;Object(l.a)(this,e),this.version=void 0,this.container=void 0,this.graph=void 0,this.data=void 0,this.props=void 0,this.wordwrap=void 0,this.hotswapProps=function(e){return!!$.a.isEqual(i.props.layout,e.layout)&&(i.props.enableActivateRelations===e.enableActivateRelations&&(i.props=e,!0))},this.destroy=function(){i.graph.destroy()},this.fitCenter=function(){i.graph.fitCenter()},this.setDataAndRender=function(e,t){i.version>0&&i.graph.clear(),i.data=e,i.graph.data({nodes:e.nodes,edges:e.edges}),i.graph.render(),i.version+=1,void 0!==t&&t()},this.updateLayout=function(e){i.graph.updateLayout(e),i.graph.layout()},this.updateContainerSize=function(e){var t=e.center,n=e.height,r=i.graph.get("group");r.resetMatrix();var a=r.getCanvasBBox();if(0!==a.width&&0!==a.height){var o,s=i.container.clientWidth;switch(n.type){case"fit-graph":o=a.height+n.extraHeight;break;case"fit-remaining-window":var c=i.container.getBoundingClientRect().top,d=window.scrollY;o=document.documentElement.clientHeight-(c+d)-n.offsetHeight;break;case"keep-as-is":o=i.props.initHeight}i.graph.changeSize(s,o),!0===t?i.graph.moveTo(s/2-a.width/2,o/2-a.height/2):i.graph.moveTo(i.props.leftOffset||0,i.props.topOffset||0)}return a},this.untilLayoutStable=function(e,t,n,r,a,o,s){if(e<=0)return n.apply(void 0,Object(lt.a)(r)),void(void 0!==a&&a());var c=i.graph.get("group").getCanvasBBox();if(o=o||10,void 0!==s){if(Math.abs(s.width-c.width)<o&&Math.abs(s.height-c.height)<o)return void setTimeout((function(){var s=i.graph.get("group").getCanvasBBox();Math.abs(c.width-s.width)>=o||Math.abs(c.height-s.height)>=o?i.untilLayoutStable(e-1,t,n,r,a,o,s):(n.apply(void 0,Object(lt.a)(r)),void 0!==a&&a())}),t);setTimeout((function(){i.untilLayoutStable(e-1,t,n,r,a,o,c)}),t)}else setTimeout((function(){i.untilLayoutStable(e,t,n,r,a,o,c)}),t)},this.version=0,this.props=n,this.container=t,this.data={nodes:[],edges:[]};this.wordwrap=new yt({fontFamily:"-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, 'Noto Sans', sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji'",fontSize:12}),function(e){var t=e.getApproximateWidth(4),n=function(n,i){var r,a=n.style.paddingWidth||0,o=n.style.paddingHeight||0,s=e.wrapText(n.label,n.size||t,"center"),c=s.units,d=s.width,l=s.height,u=i.addShape("rect",{attrs:Object(y.a)({width:d+2*a,height:l+2*o},n.style),name:"rect"});return ht(i,e,c,{xoffset:a,yoffset:o,cfg:null===(r=n.labelCfg)||void 0===r?void 0:r.style}),u};ut.a.registerNode("rect-wrap",{draw:function(e,t){return n(e,t)},setState:function(e,t,i){for(var r,a=i._cfg,o=a.model,s=a.states,c={},d=Object(y.a)({},null===(r=o.labelCfg)||void 0===r?void 0:r.style),l=0,u=Object.entries(o.style);l<u.length;l++){var h=Object(O.a)(u[l],2),p=h[0],b=h[1];"object"!==typeof b&&(c[p]=b)}var f,v=Object(m.a)(s);try{for(v.s();!(f=v.n()).done;)for(var j=f.value,g=0,x=Object.entries(a.styles[j]);g<x.length;g++){var w=Object(O.a)(x[g],2),I=w[0],k=w[1];"label"===I?Object.assign(d,k):c[I]=k}}catch(C){v.e(C)}finally{v.f()}var S=a.group;S.clear(),n({label:o.label,size:o.size,style:c,labelCfg:{style:d}},S)}},"single-node")}(this.wordwrap),pt(this.wordwrap);var r=["drag-canvas","drag-node"];n.enableActivateRelations&&r.push({type:"activate-relations",resetSelected:!0}),this.graph=new ut.a.Graph({container:t,width:t.scrollWidth,height:n.initHeight,layout:n.layout||{type:"force",preventOverlap:!0,linkDistance:50,nodeSpacing:50},defaultEdge:{type:"quadratic",style:{stroke:"black",endArrow:{fill:"black",path:ut.a.Arrow.triangle(6,8)}},labelCfg:{style:{fill:"black",background:{fill:"#ffffff",stroke:"#9EC9FF",padding:[2,2,2,2],radius:2}}}},modes:{default:r,edit:["click-select"]},nodeStateStyles:{active:{opacity:1,label:{opacity:1}},inactive:{opacity:.2,label:{opacity:.2}}},edgeStateStyles:{active:{stroke:"black",opacity:1},inactive:{opacity:.2,text:{opacity:.2}}}}),void 0!==n.onNodeClick&&this.graph.on("node:click",(function(e){i.props.onNodeClick(e.item._cfg.model.id)})),void 0!==n.onEdgeClick&&this.graph.on("edge:click",(function(e){i.props.onEdgeClick(e.item._cfg.model)}))}return Object(s.a)(e,null,[{key:"transformData",value:function(e,t){var n=e.map((function(e,t){var n;n=e.label.trim().length>0&&("rect"===e.shape||"circle"===e.shape)?e.shape+"-wrap":e.shape;var i={id:e.id,label:e.label,type:n,style:Object(y.a)(Object(y.a)({},e.style),{},{radius:4,paddingHeight:2,paddingWidth:4}),labelCfg:{style:e.labelStyle}};return"rect"===e.shape&&(i.style.radius=4),i}));$.a.uniq(t.map((function(e){return e.id}))).length!==t.length&&console.error("Edges must have unique ids. However, we get:",t.map((function(e){return e.id})));var i,r=t.map((function(e){return{id:e.id,source:e.source,target:e.target,label:e.label}})),a=new Set,o=!1,s=Object(m.a)(t);try{for(s.s();!(i=s.n()).done;){var c=i.value,d="".concat(c.source,"-").concat(c.target);if(a.has(d)){o=!0;break}a.add(d)}}catch(l){s.e(l)}finally{s.f()}return o&&ut.a.Util.processParallelEdges(r),{nodes:n,edges:r}}}]),e}(),It={hide:{display:"none"},graph:{position:"relative",width:"100%"},toolbar:{position:"absolute",top:8,left:8,"& button.text":{borderRadius:4,paddingLeft:8,paddingRight:8},"& button.icon":{borderRadius:4,padding:4,"& svg":{fontSize:22}}},bordered:{border:"1px solid #bbb",borderRadius:4},container:{width:"100%","& canvas":{display:"block"}}},kt={Force:{type:"force",preventOverlap:!0,linkDistance:50,nodeSpacing:50},Dagre:{type:"dagre",rankdir:"TB",nodesep:70,ranksep:30}},St=Object(Y.a)(It)(Object(f.forwardRef)((function(e,t){var n=e.id,i=e.version,r=e.nodes,a=e.edges,o=e.classes,s=e.props,c=e.className,d=e.renderingAdjustedHeight,l=void 0===d?{type:"fit-graph",extraHeight:8}:d,u=e.toolbar,h=void 0!==u&&u,p=e.bordered,b=void 0===p||p,v=e.layouts,j=void 0===v?kt:v,g=Object(f.useRef)(null),x=Object(f.useRef)(void 0);Object(f.useImperativeHandle)(t,(function(){return{graph:function(){return x.current},recenter:function(){return void 0!==x.current&&(x.current.updateContainerSize({center:!0,height:l}),!0)}}})),Object(f.useEffect)((function(){if(null!==g.current){void 0===x.current&&(x.current=new wt(g.current,s||{initHeight:500}));var e=x.current;if(void 0!==s)e.hotswapProps(s)||(e.destroy(),x.current=new wt(g.current,s||{initHeight:500}),e=x.current);e.setDataAndRender(wt.transformData(r,a),(function(){window.g=e,e.untilLayoutStable(20,50,e.updateContainerSize,[{center:!0,height:l}],(function(){}))}))}}),[n,i,r,a,s,l]);var O=!1===h?null:Object(W.jsx)(Ct,{autoHide:"auto-hide"===h,graph:x,layouts:j});return Object(W.jsxs)("div",{className:c,children:[Object(W.jsx)("div",{className:o.hide,children:i}),Object(W.jsxs)("div",{className:o.graph,children:[O,Object(W.jsx)("div",{ref:g,className:o.container+(b?" "+o.bordered:"")})]})]})}))),Ct=Object(Y.a)(It)((function(e){var t=e.autoHide,n=void 0!==t&&t,i=e.graph,r=e.classes,a=e.layouts,o=Object(f.useState)(!1),s=Object(O.a)(o,2),c=s[0],d=s[1],l=Object(f.useState)("Force"),u=Object(O.a)(l,2),h=u[0],p=u[1],b=function(){n&&d(!0)},v=function(){n&&d(!1)};if(n&&!c)return Object(W.jsx)("div",{className:r.toolbar,onMouseEnter:b,onMouseLeave:v,children:Object(W.jsx)(ee.a,{className:"icon",children:Object(W.jsx)(rt.a,{})})});var j=function(){var e;null===(e=i.current)||void 0===e||e.graph.fitCenter()},g=function(e){var t,n;p(e),null===(t=i.current)||void 0===t||t.updateLayout(a[e]),null===(n=i.current)||void 0===n||n.untilLayoutStable(20,50,j,[],(function(){}))};return Object(W.jsx)("div",{className:r.toolbar,onMouseEnter:b,onMouseLeave:v,children:Object(W.jsxs)(te.b,{size:4,align:"start",children:[Object(W.jsx)(st.a,{title:"Center the graph",children:Object(W.jsx)(ee.a,{className:"icon",onClick:j,children:Object(W.jsx)(ot.a,{})})}),Object(W.jsx)(st.a,{title:"Make the graph full screen",children:Object(W.jsx)(ee.a,{className:"icon",children:Object(W.jsx)(et.a,{})})}),Object(W.jsx)(st.a,{title:"Change graph layout",children:Object(W.jsx)(ct.a,{overlay:Object(W.jsx)(dt.a,{onClick:function(e){g(e.key)},children:Object.keys(kt).map((function(e){return Object(W.jsx)(dt.a.Item,{children:e},e)}))}),children:Object(W.jsxs)(ee.a,{className:"text",icon:Object(W.jsx)(tt.a,{}),onClick:function(){"Force"===h&&g("Dagre"),"Dagre"===h&&g("Force")},children:[h," ",Object(W.jsx)(nt.a,{})]})})})]})})})),Pt=n(75),Et=n(553),Lt={selection:{width:"100%"},class_node:{backgroundColor:Ne.d[2],"&:hover":{backgroundColor:Ne.d[8],color:"white"}},literal_node:{backgroundColor:Ne.g[2],"&:hover":{backgroundColor:Ne.g[8],color:"white"}},data_node:{backgroundColor:Ne.c[2],"&:hover":{backgroundColor:Ne.c[8],color:"white"}}},Nt=Object(Y.a)(Lt)(Object(V.a)((function(e){var t=e.sm,n=e.value,i=e.onDeselect,r=e.onSelect,a=e.classes,o=B().classStore,s=new qe,c=Object(f.useMemo)((function(){var e,n=[],i=Object(m.a)(o.iter());try{for(i.s();!(e=i.n()).done;){var r=e.value;n.push({type:"class",id:r.id,value:"class:".concat(r.id),label:t.graph.uriCount.nextLabel(r.uri,r.readableLabel)})}}catch(l){i.e(l)}finally{i.f()}var s,c=Object(m.a)(t.graph.nodes);try{for(c.s();!(s=c.n()).done;){var d=s.value;n.push({type:d.nodetype,id:d.id,value:"".concat(d.nodetype,":").concat(d.id),label:t.graph.uriCount.label(d),className:a[d.nodetype]})}}catch(l){c.e(l)}finally{c.f()}return n}),[o.records.size]);return Object(W.jsx)(ke.a,{allowClear:!0,options:c,optionFilterProp:"label",className:a.selection,showSearch:!0,onSearch:function(e){""!==e&&s.exec((function(){return o.fetchById(e).then((function(){return 1}))}))},value:void 0===n?void 0:"".concat(n.type,":").concat(n.id),onSelect:function(e,t){r({type:t.type,id:t.id})},onDeselect:function(e,t){i({type:t.type,id:t.id})}})}))),_t={table:{width:"100%",textAlign:"left",borderSpacing:0,borderRadius:"2px 2px 0 0","& tr":{verticalAlign:"middle"},"& th, td":{padding:"0 4px"}},selection:{width:"100%"}},Dt=(Object(Y.a)(_t)(Object(V.a)((function(e){var t=e.sm,n=e.classes,i=e.value,r=e.onSelect,a=e.onDeselect,o=Object(f.useMemo)((function(){return t.graph.nodes.map((function(e){return{value:e.id,label:e.label}}))}),[t]);return Object(W.jsx)(ke.a,{showSearch:!0,allowClear:!0,options:o,optionFilterProp:"label",className:n.selection,value:i,onSelect:r,onDeselect:a})}))),Object(Y.a)(_t)(Object(V.a)((function(e){var t,n,i=e.sm,r=e.edge,a=(e.classes,B()),o=a.classStore,s=a.propertyStore,c=Object(f.useState)(void 0!==r?{type:i.graph.node(r.source).nodetype,id:r.source}:void 0),d=Object(O.a)(c,2),l=d[0],u=d[1],h=Object(f.useState)(void 0!==r?{type:i.graph.node(r.target).nodetype,id:r.target}:void 0),p=Object(O.a)(h,2),b=p[0],v=p[1],j=Object(f.useState)(null===r||void 0===r?void 0:r.uri),g=Object(O.a)(j,2),x=g[0],y=g[1],m=Object(f.useState)(!1),w=Object(O.a)(m,2),I=w[0],k=w[1],S=Object(f.useMemo)((function(){return void 0!==l&&"class"!==l.type&&(void 0!==b&&"class"!==b.type&&(i.graph.hasEdge(l.id,b.id)&&(void 0===r||l.id!==r.source||b.id!==r.target)))}),[i.graph.version,null===l||void 0===l?void 0:l.id,null===b||void 0===b?void 0:b.id]);Object(f.useEffect)((function(){void 0!==r&&void 0===s.getPropertyByURI(r.uri)&&s.fetchOne({conditions:{uri:r.uri}})}),[s,r,x]);return Object(W.jsxs)(Pt.a,{labelCol:{span:6},wrapperCol:{span:18},labelWrap:!0,layout:"horizontal",children:[Object(W.jsx)(Pt.a.Item,{label:Object(W.jsx)(A.a.Text,{copyable:void 0!==l?{text:l.id}:void 0,children:"Source"}),validateStatus:S?"error":void 0,help:S?"Cannot have more than one edge between two nodes":void 0,children:Object(W.jsx)(Nt,{sm:i,value:l,onSelect:u,onDeselect:function(){return u(void 0)}})}),Object(W.jsx)(Pt.a.Item,{label:Object(W.jsx)(A.a.Text,{copyable:void 0!==b?{text:b.id}:void 0,children:"Target"}),children:Object(W.jsx)(Nt,{sm:i,value:b,onSelect:v,onDeselect:function(){return v(void 0)}})}),Object(W.jsx)(Pt.a.Item,{label:Object(W.jsx)(A.a.Text,{copyable:void 0!==x?{text:null===(t=s.getPropertyByURI(x))||void 0===t?void 0:t.id}:void 0,children:"Predicate"}),children:Object(W.jsx)(Je,{value:void 0!==x?null===(n=s.getPropertyByURI(x))||void 0===n?void 0:n.id:void 0,onSelect:function(e){var t;return y(null===(t=s.get(e))||void 0===t?void 0:t.uri)},onDeselect:function(e){return y(void 0)}})}),Object(W.jsx)(Pt.a.Item,{label:"Approximation",children:Object(W.jsx)(Et.a,{checked:I,onChange:function(e){return k(e)}})}),Object(W.jsx)(Pt.a.Item,{label:"Button",children:Object(W.jsxs)(te.b,{children:[Object(W.jsx)(ee.a,{type:"primary",onClick:function(){if(void 0!==x&&void 0!==l&&void 0!==b&&!S){var e,t,n=s.getPropertyByURI(x);if("class"===l.type){var a=o.get(l.id);e=i.graph.nextNodeId(),i.graph.addClassNode({id:e,uri:a.uri,label:a.readableLabel,approximation:!1,nodetype:"class_node"})}else e=l.id;if("class"===b.type){var c=o.get(b.id);t=i.graph.nextNodeId(),i.graph.addClassNode({id:t,uri:c.uri,label:c.readableLabel,approximation:!1,nodetype:"class_node"})}else t=b.id;var d={source:e,target:t,uri:n.uri,approximation:I,label:n.readableLabel};void 0!==r?r.source===e&&r.target===t?i.graph.updateEdge(r.source,r.target,d):(i.graph.removeEdge(r.source,r.target),i.graph.addEdge(d)):i.graph.addEdge(d),he.a.destroyAll()}},disabled:void 0===l||void 0===b||void 0===x||!(void 0===r||(null===l||void 0===l?void 0:l.id)!==r.source||(null===b||void 0===b?void 0:b.id)!==r.target||x!==r.uri||I!==r.approximation)||S,children:"Save"}),void 0!==r?Object(W.jsx)(ee.a,{type:"primary",danger:!0,onClick:function(){void 0!==r&&(i.graph.removeEdge(r.source,r.target),he.a.destroyAll())},children:"delete"}):null]})})]})})))),Tt=n(196),zt=Object(V.a)((function(e){var t,n,i,r,a,o=B().classStore,s=Object(f.useState)(null===(t=e.node)||void 0===t?void 0:t.uri),c=Object(O.a)(s,2),d=c[0],l=c[1],u=Object(f.useState)((null===(n=e.node)||void 0===n?void 0:n.approximation)||!1),h=Object(O.a)(u,2),p=h[0],b=h[1];Object(f.useEffect)((function(){void 0!==e.node&&void 0===o.getClassByURI(e.node.uri)&&o.fetchOne({conditions:{uri:e.node.uri}})}),[null===(i=e.node)||void 0===i?void 0:i.uri]);return Object(W.jsxs)(v.a.Fragment,{children:[Object(W.jsx)(Pt.a.Item,{label:Object(W.jsx)(A.a.Text,{copyable:void 0!==d?{text:null===(r=o.getClassByURI(d))||void 0===r?void 0:r.id}:void 0,children:"Class"}),children:Object(W.jsx)(Qe,{value:void 0!==d?null===(a=o.getClassByURI(d))||void 0===a?void 0:a.id:void 0,onSelect:function(e){var t;return l(null===(t=o.get(e))||void 0===t?void 0:t.uri)},onDeselect:function(){return l(void 0)}})}),Object(W.jsx)(Pt.a.Item,{label:"Approximation",children:Object(W.jsx)(Et.a,{checked:p,onChange:function(e){return b(e)}})}),Object(W.jsx)(Pt.a.Item,{label:"Button",children:Object(W.jsxs)(te.b,{children:[Object(W.jsx)(ee.a,{type:"primary",onClick:function(){void 0!==d&&(void 0===e.node?e.sm.graph.addClassNode({id:e.sm.graph.nextNodeId(),uri:d,label:o.getClassByURI(d).readableLabel,nodetype:"class_node",approximation:p}):e.sm.graph.updateClassNode(e.node.id,{uri:d,label:o.getClassByURI(d).readableLabel,approximation:p}),e.onDone())},disabled:void 0===d||!(void 0===e.node||e.node.uri!==d||e.node.approximation!==p),children:"Save"}),void 0!==e.node?Object(W.jsx)(ee.a,{type:"primary",danger:!0,onClick:function(){e.sm.graph.removeNode(e.node.id),e.onDone()},children:"delete"}):null]})})]})})),Bt=Object(V.a)((function(e){var t,n,i=B().entityStore,r=Object(f.useState)("entity-id"===(null===(t=e.node)||void 0===t||null===(n=t.value)||void 0===n?void 0:n.type)?e.node.value.id:void 0),a=Object(O.a)(r,2),o=a[0],s=a[1],c=Object(f.useState)(void 0!==e.node&&"literal_node"===e.node.nodetype&&e.node.isInContext),d=Object(O.a)(c,2),l=d[0],u=d[1],h=Object(f.useMemo)((function(){var t;return void 0!==o&&(void 0===e.node&&void 0!==e.sm.graph.nodeByEntityId(o)||void 0!==e.node&&(null===(t=e.sm.graph.nodeByEntityId(o))||void 0===t?void 0:t.id)!==e.node.id)}),[e.sm.graph.version,o]);if(void 0!==e.node&&"string"===e.node.value.type)return Object(W.jsx)("div",{children:"Not Implemented Yet"});return Object(W.jsxs)(v.a.Fragment,{children:[Object(W.jsx)(Pt.a.Item,{label:Object(W.jsx)(A.a.Text,{copyable:void 0!==o?{text:o}:void 0,children:"Entity"}),validateStatus:h?"error":void 0,help:h?"Entity's already in the graph":void 0,children:Object(W.jsx)(Ye,{value:o,onSelect:s,onDeselect:function(){return s(void 0)}})}),Object(W.jsx)(Pt.a.Item,{label:"Is In Context?",children:Object(W.jsx)(Et.a,{checked:l,onChange:function(e){return u(e)}})}),Object(W.jsx)(Pt.a.Item,{label:"Button",children:Object(W.jsxs)(te.b,{children:[Object(W.jsx)(ee.a,{type:"primary",onClick:function(){if(void 0!==o&&!h){var t=i.get(o);void 0===e.node?e.sm.graph.addLiteralNode({id:e.sm.graph.nextNodeId(),value:{type:"entity-id",id:o,uri:t.uri},label:t.readableLabel,nodetype:"literal_node",isInContext:l}):e.sm.graph.updateLiteralNode(e.node.id,{value:{type:"entity-id",id:o,uri:t.uri},label:t.readableLabel,nodetype:"literal_node",isInContext:l}),e.onDone()}},disabled:void 0===o||h||!(void 0===e.node||e.node.isInContext!==l||"entity-id"===e.node.value.type&&e.node.value.id!==o),children:"Save"}),void 0!==e.node?Object(W.jsx)(ee.a,{type:"primary",danger:!0,onClick:function(){e.sm.graph.removeNode(e.node.id),e.onDone()},children:"delete"}):null]})})]})})),Ft=Object(Y.a)({})(Object(V.a)((function(e){var t=e.sm,n=e.node,i=(e.classes,Object(f.useState)((null===n||void 0===n?void 0:n.nodetype)||"class_node")),r=Object(O.a)(i,2),a=r[0],o=r[1],s=function(){return he.a.destroyAll()};return Object(W.jsxs)(Pt.a,{labelCol:{span:6},wrapperCol:{span:18},labelWrap:!0,layout:"horizontal",children:[void 0===n?Object(W.jsx)(Pt.a.Item,{label:"Node Type",children:Object(W.jsxs)(Tt.a.Group,{value:a,onChange:function(e){return o(e.target.value)},buttonStyle:"solid",children:[Object(W.jsx)(Tt.a.Button,{value:"class_node",children:"Class Node"}),Object(W.jsx)(Tt.a.Button,{value:"literal_node",children:"Literal Node"})]})}):null,"class_node"===a?Object(W.jsx)(zt,{sm:t,node:"class_node"===(null===n||void 0===n?void 0:n.nodetype)?n:void 0,onDone:s}):Object(W.jsx)(Bt,{sm:t,node:"literal_node"===(null===n||void 0===n?void 0:n.nodetype)?n:void 0,onDone:s})]})})));function Rt(e,t){var n,i;switch(e.type){case"edge":i=Object(W.jsx)(Dt,Object(y.a)({},e)),n=void 0===e.edge?"Add Edge":"Update Edge";break;case"node":i=Object(W.jsx)(Ft,Object(y.a)({},e)),n=void 0===e.node?"Add Node":"Update Node"}he.a.info({title:Object(W.jsx)("span",{style:{marginBottom:16,display:"inline-block"},children:n}),content:i,bodyStyle:{margin:-8},okButtonProps:{style:{display:"none"}},maskClosable:!0,mask:!0,zIndex:t,width:"calc(100% - 128px)",style:{top:64}})}var At={hide:{display:"none"},graphContainer:{marginTop:8},draft:{border:"1px dashed ".concat(Ne.h[7]," !important"),"&:hover":{color:"".concat(Ne.c[5]," !important")}},selectedDraft:{backgroundColor:"".concat(Ne.c[5]," !important")}},Mt=Object(Y.a)(At)(Object(V.a)((function(e){var t=e.classes,n=e.table,i=Object(f.useRef)(void 0),r=Object(f.useState)(0),a=Object(O.a)(r,2),o=a[0],s=a[1],c=B().semanticModelStore,d=c.findByTable(n.id),l=c.getDraftsByTable(n);if(o>=d.length+l.length){var u=c.getNewDraftId(n),h=S.getDefaultDraftSemanticModel(u,"sm-".concat(d.length),n);c.setCreateDraft(h),l.push(h)}var p=o<d.length?d[o]:l[o-d.length],b=Object(f.useMemo)((function(){return[p.graph.nodes.map((function(e){var t,n;switch(e.nodetype){case"class_node":t="circle",n={fill:Ne.d[2],stroke:Ne.d[8]};break;case"data_node":t="rect",n={fill:Ne.c[3],stroke:Ne.c[8]};break;case"literal_node":t="entity-id"===e.value.type?"circle":"rect",n=e.isInContext?{fill:"#C6E5FF",stroke:"#5B8FF9"}:{fill:Ne.g[2],stroke:"#c41d7f"};break;default:throw new Error("Unreachable!")}return{id:e.id,label:Ht(p,e),style:n,shape:t}})),p.graph.edges.map((function(e){return{id:"".concat(e.source,"-").concat(e.target,"-").concat(e.uri),source:e.source,target:e.target,label:e.label}}))]}),[k.isDraft(p)?p.draftID:null,p.id,p.graph.version]),j=Object(O.a)(b,2),g=j[0],x=j[1],y=function(){void 0!==i.current&&i.current.recenter()};Object(ie.a)("c",y,[p.id,void 0!==i]);for(var m=[],w=function(e){var n=e<d.length?d[e]:l[e-d.length],i=e===o;m.push(Object(W.jsx)(ee.a,{size:"small",type:i?"primary":"default",onClick:function(){return s(e)},className:n.graph.stale||k.isDraft(n)?t.draft+(i?" ".concat(t.selectedDraft):""):"",children:n.name},n.id))},I=0;I<d.length+l.length;I++)w(I);var C;return C=Object(W.jsxs)(te.b,{style:{float:"right"},children:[1!==m.length||l.length>0||d[0].graph.stale?Object(W.jsxs)(v.a.Fragment,{children:[Object(W.jsx)("span",{children:"Semantic Models:"}),m,Object(W.jsx)(Xe.a,{type:"vertical"})]}):null,d.length+l.length>1?Object(W.jsx)(Ze.a,{title:"Are you sure to delete this model?",onConfirm:function(){k.isDraft(p)?c.deleteCreateDraft(p.draftID):c.delete(p.id),s(0)},okText:"Yes",cancelText:"No",children:Object(W.jsx)(ee.a,{size:"small",danger:!0,children:"Delete model"})}):null,k.isDraft(p)||p.graph.stale?Object(W.jsx)(ee.a,{size:"small",onClick:function(){return k.isDraft(p)?c.create(p):c.update(p)},children:"Save model"}):null,Object(W.jsx)(ee.a,{size:"small",onClick:function(){var e=c.getNewDraftId(n),t=d.length+l.length,i=S.getDefaultDraftSemanticModel(e,c.getNewSemanticModelName(n),n);i.graph=p.graph.clone(),i.graph.id=e,c.setCreateDraft(i),s(t)},children:"Add model"}),Object(W.jsx)(ee.a,{size:"small",type:"primary",disabled:!0,children:"Import"}),Object(W.jsx)(ee.a,{size:"small",type:"primary",style:{background:Ne.d[6],borderColor:Ne.d[6]},onClick:function(){Qt.tableExport.path({tableId:n.id}).mouseClickNavigationHandler(void 0,!0)},children:"Export"})]}),Object(W.jsxs)("div",{children:[C,Object(W.jsxs)(te.b,{children:[Object(W.jsx)(ee.a,{size:"small",onClick:y,children:"Center graph (C)"}),Object(W.jsx)(ee.a,{size:"small",onClick:function(){return Rt({type:"node",sm:p})},children:"Add node"}),Object(W.jsx)(ee.a,{size:"small",onClick:function(){return Rt({type:"edge",sm:p})},children:"Add edge"})]}),Object(W.jsx)(St,{ref:i,className:t.graphContainer,id:p.id,version:p.graph.version,nodes:g,edges:x,toolbar:!1,renderingAdjustedHeight:{type:"fit-graph",extraHeight:20},props:{initHeight:300,layout:{type:"dagre",rankdir:"TB",nodesep:50,ranksep:15},onNodeClick:function(e){Rt({type:"node",sm:p,node:p.graph.node(e)})},onEdgeClick:function(e){Rt({type:"edge",sm:p,edge:p.graph.edge(e.source,e.target)})}}})]})}))),Ht=function(e,t){switch(t.nodetype){case"data_node":case"literal_node":return t.label;case"class_node":return e.graph.uriCount.label(t)}},Vt=Object(Y.a)({table:{marginTop:8,"& div.ant-table-container":{border:"1px solid #bbb",borderRadius:4,borderLeft:"1px solid #bbb !important"}},container:{marginLeft:24,marginRight:24}})(Object(V.a)((function(e){var t=e.classes,n=B(),i=n.projectStore,r=n.tableStore,o=n.tableRowStore,s=n.semanticModelStore,c=Qt.table.useURLParams().tableId,d=function(e,t){var n=50,i=Qt.table.useQueryParams(),r=null===i?"":i.query,a=Object(f.useMemo)((function(){return""!==r?e.decodeWhereQuery(r):{}}),[e,r]),o=Object(f.useState)({tableId:-1,tableIndex:-1,query:"",records:[],leftOffset:0,total:0,hasPrev:!1,hasNext:!1,allLeft:!1,allRight:!1,version:0}),s=Object(O.a)(o,2),c=s[0],d=s[1];Object(f.useEffect)((function(){var i=function(){var i=Object(J.a)(K.a.mark((function i(){var o,s,l,u,h,p,b,f,v;return K.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(o=$.a.sortedIndex(c.records,t),!(c.query!==r||c.records[o]!==t)){i.next=13;break}return i.next=5,Promise.all([e.query({limit:n,offset:0,fields:["id"],conditions:Object(y.a)(Object(y.a)({},a),{},{id:{op:"gte",value:t}})}),e.query({limit:n,offset:0,fields:["id"],conditions:Object(y.a)(Object(y.a)({},a),{},{id:{op:"lt",value:t}})})]);case 5:l=i.sent,u=Object(O.a)(l,2),h=u[0],p=u[1],b=p.records.map((function(e){return e.id})).concat(h.records.map((function(e){return e.id}))),s={tableIndex:p.records.length,records:b,total:p.total+h.total,leftOffset:p.total-p.records.length,allLeft:p.total<=n,allRight:h.total<=n,hasPrev:p.records.length>0,hasNext:h.records.length>1},i.next=28;break;case 13:if(0!==o||c.allLeft){i.next=20;break}return i.next=16,e.query({limit:n,offset:0,fields:["id"],conditions:Object(y.a)(Object(y.a)({},a),{},{id:{op:"lt",value:t}})});case 16:f=i.sent,s={tableIndex:f.records.length,leftOffset:f.total-f.records.length,records:f.records.map((function(e){return e.id})).concat(c.records),allLeft:f.total<=n,hasPrev:f.records.length>0},i.next=28;break;case 20:if(o!==c.records.length-1||c.allRight){i.next=27;break}return i.next=23,e.query({limit:n,offset:0,fields:["id"],conditions:Object(y.a)(Object(y.a)({},a),{},{id:{op:"gt",value:t}})});case 23:v=i.sent,s={tableIndex:o,records:c.records.concat(v.records.map((function(e){return e.id}))),allRight:v.total<=n,hasNext:v.records.length>0},i.next=28;break;case 27:s={tableIndex:o,hasNext:o<c.records.length-1,hasPrev:o>0};case 28:d(Object(y.a)(Object(y.a)(Object(y.a)({},c),s),{},{version:c.version+1,query:r,tableId:t}));case 29:case"end":return i.stop()}}),i)})));return function(){return i.apply(this,arguments)}}();i()}),[t,r]);var l=function(e){if(t===c.tableId){var n=c.records[c.tableIndex+e];void 0!==n&&Qt.table.path({tableId:n},{query:r}).open()}};return{toPreviousTable:function(){l(-1)},toNextTable:function(){l(1)},navState:c}}(r,c),l=d.navState,u=d.toNextTable,h=d.toPreviousTable;Object(f.useEffect)((function(){r.fetchById(c).then((function(e){void 0!==e&&i.fetchById(e.project)})),s.hasByTable(c)||s.fetch({limit:1e3,offset:0,conditions:{table:c}})}),[r,i,s,c]),Object(ie.a)("b",h,[l.version]),Object(ie.a)("n",u,[l.version]);var p=r.get(c),b=Object(f.useMemo)((function(){var e,t,n,i=r.get(c);if(void 0!==i&&null!==i)return{name:i.name,description:i.description,columns:i.columns,size:i.size,context:{webpage:null===(e=i.contextPage)||void 0===e?void 0:e.url,title:null===(t=i.contextPage)||void 0===t?void 0:t.title,entityId:null===(n=i.contextPage)||void 0===n?void 0:n.entityId,contentHierarchy:i.contextTree}}}),[c,void 0!==p]);if(null===p)return Object(W.jsx)(a.i,{});if(void 0===p)return Object(W.jsx)(a.f,{});var j=null;j=s.hasByTable(c)?Object(W.jsx)(Mt,{table:p},c):Object(W.jsx)(a.f,{bordered:!0});var g=function(){var e=Object(J.a)(K.a.mark((function e(t,n){var i;return K.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o.fetch({limit:t,offset:n,conditions:{table:p.id}});case 2:return i=e.sent,e.abrupt("return",i.records.map((function(e){return{index:e.index,row:e.row.map((function(e){return{value:e}})),links:e.links}})));case 4:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();return Object(W.jsxs)(v.a.Fragment,{children:[Object(W.jsx)(Wt,{project:i.get(p.project),table:p,btns:[Object(W.jsx)(ee.a,{onClick:h,disabled:!l.hasPrev,children:"Previous Table (B)"},"prev"),Object(W.jsx)(ee.a,{onClick:u,disabled:!l.hasNext,children:"Next Table (N)"},"next")],extraSubTitle:Object(W.jsxs)("span",{className:"ml-2",children:["Position:"," ",Object(W.jsxs)("b",{children:[" ",l.leftOffset+l.tableIndex+1,"/",l.total]})]})}),Object(W.jsx)("div",{className:t.container,children:Object(W.jsxs)(te.b,{direction:"vertical",size:8,children:[j,Object(W.jsx)(Ve,{toolBarRender:!1,table:b,query:g,showRowIndex:!0},c),Object(W.jsx)($e,{})]})})]})})));var Wt=function(e){var t=e.project||new p(0,"","");return Object(W.jsx)(ne.a,{onBack:function(){return a.p.push(Qt.project.getURL({projectId:e.table.project}))},title:Object(W.jsxs)(te.b,{children:[Object(W.jsx)("span",{style:{fontWeight:500},children:"Table "}),Object(W.jsx)("span",{style:{color:"#237804",textDecoration:"underline"},children:e.table.name})]}),subTitle:Object(W.jsxs)(te.b,{children:[Object(W.jsxs)("span",{children:["(Project ",Object(W.jsx)("b",{children:t.name}),")"]}),e.extraSubTitle]}),extra:e.btns})},Ut=n.p+"static/media/logo.e35779db.png",qt=n(930),Kt=n(931),Jt=n(927),Qt={project:new a.h({component:X,urlSchema:{projectId:"number"},pathDef:"/projects/:projectId"}),table:new a.k({component:Vt,urlSchema:{tableId:"number"},querySchema:{query:"string"},pathDef:"/tables/:tableId"}),tableExport:new a.h({component:function(){return Object(W.jsx)("h1",{children:"Not supposed to see this page"})},urlSchema:{tableId:"number"},pathDef:"/api/table/:tableId/export?attachment=true"}),settings:new a.g({component:function(){return Object(W.jsx)(F.a,{gutter:16,children:Object(W.jsx)(R.a,{className:"gutter-row",span:24})})},pathDef:"/settings",exact:!0}),upload:new a.g({component:U,pathDef:"/upload",exact:!0}),projects:new a.g({component:U,pathDef:"/projects",exact:!0}),home:new a.g({component:U,pathDef:"/",exact:!0})};window._routes=Qt,Object(a.o)(Qt,(function(e){return function(t){var n=v.a.createElement(e,t);return Object(W.jsxs)(te.b,{direction:"vertical",style:{width:"100%"},children:[Object(W.jsx)(a.e,{menus:{home:Object(W.jsx)("img",{src:Ut,alt:"logo"}),projects:{icon:Object(W.jsx)(qt.a,{}),children:"Projects"},upload:{icon:Object(W.jsx)(Kt.a,{}),children:"Upload"},settings:{icon:Object(W.jsx)(Jt.a,{}),children:"Settings"}},routes:Qt,isFirstItemLogo:!0}),Object(W.jsx)("div",{className:"wide-container",children:n})]})}}),["table"]),r.a.render(Object(W.jsx)(z.Provider,{value:T,children:Object(W.jsx)(a.a,{enUSLocale:!0,routes:Qt})}),document.getElementById("root")),o()}},[[903,1,2]]]);
//# sourceMappingURL=main.800ad317.chunk.js.map