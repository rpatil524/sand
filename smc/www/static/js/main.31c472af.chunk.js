(this.webpackJsonpsmc=this.webpackJsonpsmc||[]).push([[0],{527:function(e,t,n){},829:function(e,t,n){"use strict";n.r(t);var r=n(71),i=n.n(r),a=(n(527),n(221)),o=n(5),s=n(30),c=n(16),l=n(15),d=n(11),u=n.n(d),h=n(70),p=n.n(h),f=n(14),b=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))},v=function(){function e(){Object(c.a)(this,e),this._value="updated",this.forbiddenStates=new Set,Object(f.o)(this,{_value:f.p,value:f.g})}return Object(l.a)(e,[{key:"value",get:function(){return this._value},set:function(e){this.forbiddenStates.has(e)||(this._value=e)}}]),e}(),j=function(){function e(t,n,r,i){var a=this;Object(c.a)(this,e),this.state=new v,this.records=new Map,this.refetch=!0,this.indices=[],this.fetch=Object(f.j)(u.a.mark((function e(t){var n,r,i,a,o=this;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,this.state.value="updating",e.next=4,this.query(t);case 4:n=e.sent,r=Object(s.a)(n.records);try{for(r.s();!(i=r.n()).done;)a=i.value,this.records.set(a.id,a),this.index(a)}catch(c){r.e(c)}finally{r.f()}return this.state.value="updated",n.records=n.records.map((function(e){return o.records.get(e.id)})),e.abrupt("return",n);case 12:throw e.prev=12,e.t0=e.catch(0),this.state.value="error",e.t0;case 16:case"end":return e.stop()}}),e,this,[[0,12]])}))),this.queryByName=function(e){return b(a,void 0,void 0,u.a.mark((function t(){var n;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,p.a.get("".concat(this.remoteURL),{params:{q:e}});case 3:n=t.sent,t.next=9;break;case 6:throw t.prev=6,t.t0=t.catch(0),t.t0;case 9:return t.abrupt("return",{records:n.data.map(this.deserialize.bind(this)),total:n.data.total});case 10:case"end":return t.stop()}}),t,this,[[0,6]])})))},this.remoteURL=t,this.field2name=n||{},this.nameAndField=Object.entries(this.field2name).map((function(e){var t=Object(o.a)(e,2),n=t[0];return[t[1],n]})),this.name2field=Object.fromEntries(this.nameAndField),void 0!==r&&(this.refetch=r),this.indices=i||[],this.batch=new g(this,50),Object(f.o)(this,{state:f.p,records:f.p,fetch:f.f,fetchOne:f.f,fetchById:f.f,fetchByIds:f.f,set:f.f,list:f.g})}return Object(l.a)(e,[{key:"remoteSize",value:function(){return b(this,void 0,void 0,u.a.mark((function e(){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.query({limit:1});case 2:return e.abrupt("return",e.sent.total);case 3:case"end":return e.stop()}}),e,this)})))}},{key:"fetchOne",value:function(e){return b(this,void 0,void 0,u.a.mark((function t(){var n,r,i=this;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,this.state.value="updating",e.limit=1,t.next=5,this.query(e);case 5:if(0!==(n=t.sent).records.length){t.next=9;break}return Object(f.r)((function(){i.state.value="updated"})),t.abrupt("return",void 0);case 9:return r=n.records[0],t.abrupt("return",Object(f.r)((function(){return i.records.set(r.id,r),i.index(r),i.state.value="updated",i.records.get(r.id)})));case 13:if(t.prev=13,t.t0=t.catch(0),!t.t0.response||404!==t.t0.response.status){t.next=18;break}return Object(f.r)((function(){i.state.value="updated"})),t.abrupt("return",void 0);case 18:throw Object(f.r)((function(){i.state.value="error"})),t.t0;case 20:case"end":return t.stop()}}),t,this,[[0,13]])})))}},{key:"fetchById",value:function(e){return b(this,void 0,void 0,u.a.mark((function t(){var n,r,i=this;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.refetch||!this.has(e)){t.next=5;break}if(null!==(n=this.records.get(e))){t.next=4;break}return t.abrupt("return",Promise.resolve(void 0));case 4:return t.abrupt("return",Promise.resolve(n));case 5:return t.prev=5,this.state.value="updating",t.next=9,p.a.get("".concat(this.remoteURL,"/").concat(e));case 9:return r=t.sent,t.abrupt("return",Object(f.r)((function(){var e=i.deserialize(r.data);return i.records.set(e.id,e),i.index(e),i.state.value="updated",i.records.get(e.id)})));case 13:if(t.prev=13,t.t0=t.catch(5),!t.t0.response||404!==t.t0.response.status){t.next=18;break}return Object(f.r)((function(){i.records.set(e,null),i.state.value="updated"})),t.abrupt("return",void 0);case 18:throw Object(f.r)((function(){i.state.value="error"})),t.t0;case 20:case"end":return t.stop()}}),t,this,[[5,13]])})))}},{key:"fetchByIds",value:function(e){return b(this,void 0,void 0,u.a.mark((function t(){var n,r,i,a,o,c,l,d=this;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e,this.refetch){t.next=8;break}if(n=n.filter((function(e){return!d.has(e)})),0!==n.length){t.next=8;break}r={},i=Object(s.a)(e);try{for(i.s();!(a=i.n()).done;)o=a.value,null!==(c=this.records.get(o))&&void 0!==c&&(r[o]=c)}catch(u){i.e(u)}finally{i.f()}return t.abrupt("return",Promise.resolve(r));case 8:return t.prev=8,this.state.value="updating",t.next=12,p.a.post("".concat(this.remoteURL,"/find_by_ids"),{ids:n});case 12:return l=t.sent,t.abrupt("return",Object(f.r)((function(){for(var t=0,n=Object.values(l.data.items);t<n.length;t++){var r=n[t],i=d.deserialize(r);d.records.set(i.id,i),d.index(i)}var a,o={},c=Object(s.a)(e);try{for(c.s();!(a=c.n()).done;){var h=a.value,p=d.records.get(h);void 0===p?d.records.set(h,null):null!==p&&(o[h]=p)}}catch(u){c.e(u)}finally{c.f()}return d.state.value="updated",o})));case 16:throw t.prev=16,t.t0=t.catch(8),Object(f.r)((function(){d.state.value="error"})),t.t0;case 20:case"end":return t.stop()}}),t,this,[[8,16]])})))}},{key:"query",value:function(e){return b(this,void 0,void 0,u.a.mark((function t(){var n,r,i,a,s,c,l,d,h=this;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n={limit:e.limit,offset:e.offset,unique:e.unique},void 0!==e.fields&&(n.fields=e.fields.map((function(e){return h.field2name[e]||e})).join(",")),void 0!==e.conditions)for(r=0,i=Object.entries(e.conditions);r<i.length;r++)a=Object(o.a)(i[r],2),s=a[0],c=a[1],s=this.field2name[s]||s,"object"===typeof c?"max"===c.op?n["".concat(s,"[").concat(c.op,"]")]=c.value.join(","):n["".concat(s,"[").concat(c.op,"]")]=Array.isArray(c.value)?c.value.join(","):c.value:n["".concat(s)]=c;return Array.isArray(e.sortedBy)?n.sorted_by=e.sortedBy.map((function(e){var t=h.field2name[e.field]||e.field;return"asc"===e.order?t:"-".concat(t)})).join(","):"object"===typeof e.sortedBy?(l=this.field2name[e.sortedBy.field]||e.sortedBy.field,n.sorted_by="asc"===e.sortedBy.order?l:"-".concat(l)):n.sorted_by=this.field2name[e.sortedBy]||e.sortedBy,void 0!==e.groupBy&&(n.group_by=e.groupBy.map((function(e){return h.field2name[e]||e})).join(",")),t.prev=5,t.next=8,p.a.get("".concat(this.remoteURL),{params:n});case 8:d=t.sent,t.next=14;break;case 11:throw t.prev=11,t.t0=t.catch(5),t.t0;case 14:return t.abrupt("return",{records:d.data.items.map(this.deserialize.bind(this)),total:d.data.total});case 15:case"end":return t.stop()}}),t,this,[[5,11]])})))}},{key:"has",value:function(e){return this.records.has(e)}},{key:"get",value:function(e){return this.records.get(e)}},{key:"set",value:function(e){this.records.set(e.id,e),this.index(e)}},{key:"iter",value:u.a.mark((function e(){var t,n,r;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=Object(s.a)(this.records.values()),e.prev=1,t.s();case 3:if((n=t.n()).done){e.next=10;break}if(null===(r=n.value)){e.next=8;break}return e.next=8,r;case 8:e.next=3;break;case 10:e.next=15;break;case 12:e.prev=12,e.t0=e.catch(1),t.e(e.t0);case 15:return e.prev=15,t.f(),e.finish(15);case 18:case"end":return e.stop()}}),e,this,[[1,12,15,18]])}))},{key:"list",get:function(){return Array.from(this.iter())}},{key:"filter",value:function(e){var t,n=[],r=Object(s.a)(this.records.values());try{for(r.s();!(t=r.n()).done;){var i=t.value;null!==i&&e(i)&&n.push(i)}}catch(a){r.e(a)}finally{r.f()}return n}},{key:"groupBy",value:function(e,t){var n,r={},i=Object(s.a)(t);try{var a=function(){var t=n.value,i=e.map((function(e){return t[e]})).join("$");void 0===r[i]?r[i]=[t]:r[i].push(t)};for(i.s();!(n=i.n()).done;)a()}catch(o){i.e(o)}finally{i.f()}return Object.values(r)}},{key:"deserialize",value:function(e){if(this.nameAndField.length>0){var t,n=Object(s.a)(this.nameAndField);try{for(n.s();!(t=n.n()).done;){var r=Object(o.a)(t.value,2),i=r[0];e[r[1]]=e[i],delete e[i]}}catch(a){n.e(a)}finally{n.f()}}return e}},{key:"index",value:function(e){var t,n=Object(s.a)(this.indices);try{for(n.s();!(t=n.n()).done;){var r=t.value;r.add(e)}}catch(i){n.e(i)}finally{n.f()}}},{key:"encodeWhereQuery",value:function(e){return btoa(JSON.stringify(e))}},{key:"decodeWhereQuery",value:function(e){return JSON.parse(atob(e))}}]),e}(),g=function(){function e(t,n){Object(c.a)(this,e),this.store=t,this.window=n,this.requests=new Set,this.executingRequests=new Map}return Object(l.a)(e,[{key:"fetchById",value:function(e){var t=this;return this.requests.add(e),void 0!==this.callback&&clearTimeout(this.callback),new Promise((function(n,r){t.callback=setTimeout((function(){var i=t.exec();i.catch(r),i.then((function(){var r=t.executingRequests.get(e);if(void 0!==r)r.then((function(){var r=t.store.records.get(e);n(null===r?void 0:r)}));else{var i=t.store.records.get(e);n(null===i?void 0:i)}}))}),t.window)}))}},{key:"fetchByIds",value:function(e){var t,n=this,r=Object(s.a)(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;this.requests.add(i)}}catch(a){r.e(a)}finally{r.f()}return void 0!==this.callback&&clearTimeout(this.callback),new Promise((function(t,r){n.callback=setTimeout((function(){var i=n.exec();i.catch(r),i.then((function(){var r,i={},c=[],l=Object(s.a)(e);try{for(l.s();!(r=l.n()).done;){var d=r.value,u=n.executingRequests.get(d);if(void 0!==u)c.push([u,d]);else{var h=n.store.records.get(d);null!==h&&void 0!==h&&(i[d]=h)}}}catch(a){l.e(a)}finally{l.f()}c.length>0?Promise.all(c.map((function(e){return e[0]}))).then((function(){var e,r=Object(s.a)(c);try{for(r.s();!(e=r.n()).done;){var l=Object(o.a)(e.value,2),d=(l[0],l[1]),u=n.store.records.get(d);null!==u&&void 0!==u&&(i[d]=u)}}catch(a){r.e(a)}finally{r.f()}t(i)})):t(i)}))}),n.window)}))}},{key:"exec",value:function(){var e=this;this.callback=void 0;var t=Array.from(this.requests).filter((function(t){return!e.executingRequests.has(t)}));this.requests=new Set;var n,r=this.store.fetchByIds(t),i=Object(s.a)(t);try{for(i.s();!(n=i.n()).done;){var a=n.value;this.executingRequests.set(a,r)}}catch(o){i.e(o)}finally{i.f()}return r.then((function(n){var r,i=Object(s.a)(t);try{for(i.s();!(r=i.n()).done;){var a=r.value;e.executingRequests.delete(a)}}catch(o){i.e(o)}finally{i.f()}return n}))}}]),e}(),y=n(103),O=n(85),x=n(46),m=n(20),w=n(21),k=function(e,t,n,r){return new(n||(n=Promise))((function(i,a){function o(e){try{c(r.next(e))}catch(t){a(t)}}function s(e){try{c(r.throw(e))}catch(t){a(t)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,s)}c((r=r.apply(e,t||[])).next())}))},I=function(e){Object(m.a)(n,e);var t=Object(w.a)(n);function n(e,r,i,a){var o;return Object(c.a)(this,n),(o=t.call(this,e,r,i,a)).createDrafts=new Map,o.updateDrafts=new Map,o.createAJAXParams={URL:void 0,config:{}},o.onDeleteListeners=[],Object(f.o)(Object(x.a)(o),{createDrafts:f.p,updateDrafts:f.p,create:f.f,update:f.f,delete:f.f,truncate:f.f,setCreateDraft:f.f,deleteCreateDraft:f.f,setUpdateDraft:f.f,deleteUpdateDraft:f.f}),o}return Object(l.a)(n,[{key:"addOnDeleteListener",value:function(e){this.onDeleteListeners.push(e)}},{key:"create",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return k(this,void 0,void 0,u.a.mark((function n(){var r,i=this;return u.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,this.state.value="updating",n.next=4,p.a.post(this.createAJAXParams.URL||this.remoteURL,this.serializeCreateDraft(e),this.createAJAXParams.config);case 4:return r=n.sent,n.abrupt("return",Object(f.r)((function(){var n=i.deserialize(r.data);return i.records.set(n.id,n),i.index(n),t&&i.createDrafts.delete(e.draftID),i.state.value="updated",i.records.get(n.id)})));case 8:throw n.prev=8,n.t0=n.catch(0),Object(f.r)((function(){i.state.value="error"})),n.t0;case 12:case"end":return n.stop()}}),n,this,[[0,8]])})))}},{key:"update",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return k(this,void 0,void 0,u.a.mark((function n(){var r,i=this;return u.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,this.state.value="updating",n.next=4,p.a.put("".concat(this.remoteURL,"/").concat(e.id),this.serializeUpdateDraft(e));case 4:return r=n.sent,n.abrupt("return",Object(f.r)((function(){var n=e.toModel()||i.deserialize(r.data);e.markSaved();var a=i.records.get(e.id);return void 0!==a&&null!==a&&i.deindex(a),i.records.set(n.id,n),i.index(n),t&&i.updateDrafts.has(e.id)&&i.updateDrafts.delete(e.id),i.state.value="updated",i.records.get(n.id)})));case 8:throw n.prev=8,n.t0=n.catch(0),Object(f.r)((function(){i.state.value="error"})),n.t0;case 12:case"end":return n.stop()}}),n,this,[[0,8]])})))}},{key:"delete",value:function(e){return k(this,void 0,void 0,u.a.mark((function t(){var n,r,i,a=this;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(void 0!==(n=this.records.get(e))){t.next=3;break}return t.abrupt("return");case 3:if(t.prev=3,this.state.value="updating",this.records.delete(e),null===n){t.next=12;break}this.deindex(n),r=Object(s.a)(this.onDeleteListeners);try{for(r.s();!(i=r.n()).done;)(0,i.value)(n)}catch(o){r.e(o)}finally{r.f()}return t.next=12,p.a.delete("".concat(this.remoteURL,"/").concat(e));case 12:Object(f.r)((function(){a.state.value="updated"})),t.next=19;break;case 15:throw t.prev=15,t.t0=t.catch(3),Object(f.r)((function(){a.state.value="error"})),t.t0;case 19:case"end":return t.stop()}}),t,this,[[3,15]])})))}},{key:"truncate",value:function(){return k(this,void 0,void 0,u.a.mark((function e(){var t=this;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,this.state.value="updating",e.next=4,p.a.delete("".concat(this.remoteURL));case 4:Object(f.r)((function(){var e,n=Object(s.a)(t.records.values());try{for(n.s();!(e=n.n()).done;){var r=e.value;if(null!==r){t.deindex(r);var i,a=Object(s.a)(t.onDeleteListeners);try{for(a.s();!(i=a.n()).done;){(0,i.value)(r)}}catch(o){a.e(o)}finally{a.f()}}}}catch(o){n.e(o)}finally{n.f()}t.records.clear(),t.state.value="updated"})),e.next=11;break;case 7:throw e.prev=7,e.t0=e.catch(0),Object(f.r)((function(){t.state.value="error"})),e.t0;case 11:case"end":return e.stop()}}),e,this,[[0,7]])})))}},{key:"getCreateDraft",value:function(e){return this.createDrafts.get(e)}},{key:"setCreateDraft",value:function(e){this.createDrafts.set(e.draftID,e)}},{key:"deleteCreateDraft",value:function(e){this.createDrafts.delete(e)}},{key:"getUpdateDraft",value:function(e){return this.updateDrafts.get(e)}},{key:"setUpdateDraft",value:function(e){this.updateDrafts.set(e.id,e)}},{key:"deleteUpdateDraft",value:function(e){this.updateDrafts.delete(e)}},{key:"deindex",value:function(e){var t,n=Object(s.a)(this.indices);try{for(n.s();!(t=n.n()).done;){t.value.remove(e)}}catch(r){n.e(r)}finally{n.f()}}},{key:"serializeUpdateDraft",value:function(e){return this.serializeRecord(e)}},{key:"serializeCreateDraft",value:function(e){return this.serializeRecord(e)}},{key:"serializeRecord",value:function(e){for(var t={},n=0,r=Object.entries(e);n<r.length;n++){var i=Object(o.a)(r[n],2),a=i[0],s=i[1];this.field2name.hasOwnProperty(a)?t[this.field2name[a]]=s:t[a]=s}return t}}]),n}(j),S=function(e){Object(m.a)(n,e);var t=Object(w.a)(n);function n(e,r,i,a){var o;return Object(c.a)(this,n),o=t.call(this,e,r,i,a),Object(f.o)(Object(x.a)(o),{create:f.q,update:f.q}),o}return Object(l.a)(n,[{key:"create",value:function(e){var t=this,r=Object.create(null,{create:{get:function(){return Object(y.a)(Object(O.a)(n.prototype),"create",t)}}});return k(this,void 0,void 0,u.a.mark((function t(){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",r.create.call(this,Object.assign({draftID:""},e),!0));case 1:case"end":return t.stop()}}),t,this)})))}},{key:"update",value:function(e){var t=this,r=Object.create(null,{update:{get:function(){return Object(y.a)(Object(O.a)(n.prototype),"update",t)}}});return k(this,void 0,void 0,u.a.mark((function t(){return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",r.update.call(this,Object.assign({markSaved:function(){},toModel:function(){}},e),!0));case 1:case"end":return t.stop()}}),t,this)})))}}]),n}(I),C=(n(3),function(){function e(t,n){Object(c.a)(this,e),this.index=new Map,this.fkField=t,this.idField=n||"id",Object(f.o)(this,{index:f.p,add:f.f,remove:f.f})}return Object(l.a)(e,[{key:"add",value:function(e){var t=e[this.fkField];this.index.set(t,e[this.idField])}},{key:"remove",value:function(e){var t=e[this.fkField];this.index.delete(t)}}]),e}()),E=function(){function e(t,n){Object(c.a)(this,e),this.index=new Map,this.fkField=t,this.idField=n||"id",Object(f.o)(this,{index:f.p,add:f.f,remove:f.f})}return Object(l.a)(e,[{key:"add",value:function(e){var t=e[this.fkField];this.index.has(t)||this.index.set(t,new Set),this.index.get(t).add(e[this.idField])}},{key:"remove",value:function(e){var t,n=e[this.fkField];null===(t=this.index.get(n))||void 0===t||t.delete(e[this.idField])}}]),e}(),L=function(){function e(t,n,r){Object(c.a)(this,e),this.index=new Map,this.fkField1=t,this.fkField2=n,this.idField=r||"id",Object(f.o)(this,{index:f.p,add:f.f,remove:f.f})}return Object(l.a)(e,[{key:"add",value:function(e){var t=e[this.fkField1],n=e[this.fkField2];this.index.has(t)||this.index.set(t,new Map),this.index.get(t).set(n,e[this.idField])}},{key:"remove",value:function(e){var t=e[this.fkField1],n=e[this.fkField2];this.index.has(t)&&this.index.get(t).delete(n)}}]),e}(),T=n(6),N=n(851),P=n(95),_=Object(N.a)({root:{paddingTop:12,paddingBottom:4,textAlign:"center"},bordered:{border:"1px solid #ddd",borderRadius:4}})((function(e){var t=e.classes,n=e.size,r=void 0===n?"default":n,i=e.bordered,a=void 0!==i&&i,o=t.root;return a&&(o+=" ".concat(t.bordered)),Object(T.jsx)("div",Object.assign({className:o},{children:Object(T.jsx)(P.a,{tip:"Loading...",size:r},void 0)}),void 0)})),D=n(500),R=n(63),F=n(66),A=n(217),B="native"===Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_PLATFORM?"native":"web",z=("native"===Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_PLATFORM&&Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_API_SERVER,n(138)),M=n(499),U=n(0),H=n.n(U);function q(e,t){M.a.confirm({title:e,okText:"Leave",okType:"primary",okButtonProps:{danger:!0},cancelText:"Stay",onOk:function(){t(!0)},onCancel:function(){t(!1)}})}var V="native"===B?Object(z.c)({getUserConfirmation:q}):Object(z.a)({getUserConfirmation:q}),W=function(){function e(t){var n=t.urlSchema,r=void 0===n?{}:n,i=t.querySchema,a=void 0===i?{}:i,o=t.component,s=t.pathDef,l=t.exact,d=void 0!==l&&l,u=t.strict,h=void 0!==u&&u;Object(c.a)(this,e),this.urlSchema=r,this.querySchema=a,this.pathDef=s,this.exact=d,this.strict=h,this.routeDef={path:s,exact:d,strict:h,component:o},this.component=o}return Object(l.a)(e,[{key:"getURL",value:function(e,t){var n=this.pathDef;if(null!==e)for(var r in e)n=n.replace(":".concat(r),e[r]);var i=new URLSearchParams(t).toString();return i.length>0&&(n="".concat(n,"?").concat(i)),n}},{key:"location",value:function(e,t){var n=this.pathDef;for(var r in e)n=n.replace(":".concat(r),e[r]);var i=new URLSearchParams(t).toString();return{pathname:n,search:i=i.length>0?"?".concat(i):i,hash:"",state:void 0}}},{key:"path",value:function(e,t){return new J(this,e,t)}},{key:"useURLParams",value:function(){var e=this,t=Object(A.e)();return Object(U.useMemo)((function(){return e.getURLArgs(t)}),[t.pathname])}},{key:"useQueryParams",value:function(){var e=this,t=Object(A.e)();return Object(U.useMemo)((function(){return e.getQueryArgs(t)}),[t.search])}},{key:"useParams",value:function(){return{url:this.useURLParams(),query:this.useQueryParams()}}},{key:"getURLArgs",value:function(e){var t=Object(A.d)(e.pathname,this.routeDef);return null===t?null:this.parse(t.params,this.urlSchema)}},{key:"getQueryArgs",value:function(e){var t=new URLSearchParams(e.search),n=this.parse(Object.fromEntries(t.entries()),this.querySchema);return null!==n&&Object.values(n).every((function(e){return void 0===e}))?null:n}},{key:"parse",value:function(e,t){for(var n={},r=0,i=Object.entries(t);r<i.length;r++){var a=Object(o.a)(i[r],2),s=a[0],c=a[1],l=e[s];switch(c){case"number":if(void 0===l)return null;if(n[s]=parseFloat(l),!Number.isFinite(n[s]))return null;break;case"boolean":if(void 0===l||"true"!==l||"false"!==l)return null;n[s]="true"===l;break;case"string":if(void 0===l)return null;n[s]=l;break;case"optionalnumber":if(void 0===l)continue;if(n[s]=parseFloat(l),!Number.isFinite(n[s]))return null;break;case"optionalboolean":if(void 0===l)continue;if("true"!==l||"false"!==l)return null;n[s]="true"===l;break;case"optionalstring":if(void 0===l)continue;n[s]=l}}return n}}]),e}(),K=function(e){Object(m.a)(n,e);var t=Object(w.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"getURL",value:function(){return Object(y.a)(Object(O.a)(n.prototype),"getURL",this).call(this,{},{})}},{key:"location",value:function(){return Object(y.a)(Object(O.a)(n.prototype),"location",this).call(this,{},{})}},{key:"path",value:function(){return Object(y.a)(Object(O.a)(n.prototype),"path",this).call(this,{},{})}}]),n}(W),Y=function(e){Object(m.a)(n,e);var t=Object(w.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"getURL",value:function(e){return Object(y.a)(Object(O.a)(n.prototype),"getURL",this).call(this,e,{})}},{key:"location",value:function(e){return Object(y.a)(Object(O.a)(n.prototype),"location",this).call(this,e,{})}},{key:"path",value:function(e){return Object(y.a)(Object(O.a)(n.prototype),"path",this).call(this,e,{})}}]),n}(W),J=function(){function e(t,n,r){var i=this;Object(c.a)(this,e),this.mouseClickNavigationHandler=function(e,t){void 0!==e&&e.preventDefault(),t||void 0!==e&&(e.ctrlKey||e.metaKey)?(window.open(i.pathDef.getURL(i.urlArgs,i.queryArgs),"_blank"),window.focus()):V.push(i.pathDef.location(i.urlArgs,i.queryArgs))},this.pathDef=t,this.urlArgs=n,this.queryArgs=r}return Object(l.a)(e,[{key:"open",value:function(){V.push(this.pathDef.location(this.urlArgs,this.queryArgs))}}]),e}(),Q={internalHTMLLinkClickFnId:"window._routeAPIs.internalHTMLLinkClick",history:V,internalHTMLLinkClick:function(e){e.preventDefault();var t=e.target.getAttribute("href");e.ctrlKey||e.metaKey?(window.open(t,"_blank"),window.focus()):V.push(t)},goBack:function(){return V.goBack()},goForward:function(){return V.goForward()},openInternalLink:function(e){V.push(e)}};window._routeAPIs=Q;var G=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n},X=function(e){var t=e.path,n=e.urlArgs,r=e.queryArgs,i=e.children,a=G(e,["path","urlArgs","queryArgs","children"]);return Object(T.jsx)("a",Object.assign({href:t.getURL(n,r),onClick:function(e){t.path(n,r).mouseClickNavigationHandler(e)}},a,{children:i}),void 0)},$=function(e){var t=e.href,n=e.openInNewPage,r=void 0!==n&&n,i=e.children,a=e.onCtrlClick,o=G(e,["href","openInNewPage","children","onCtrlClick"]);return void 0!==a&&(o.onClick=function(e){(e.ctrlKey||e.metaKey)&&a&&(e.preventDefault(),a())}),Object(T.jsx)("a",Object.assign({href:t,target:r?"_blank":void 0,rel:"noopener noreferrer"},o,{children:i}),void 0)};function Z(e,t){for(var n=0,r=Object.entries(t);n<r.length;n++){var i=Object(o.a)(r[n],2),a=i[0],s=i[1];if(null!==Object(A.d)(e.pathname,s.routeDef))return a}}var ee=new K({component:function(){return null},pathDef:"/"}).path().mouseClickNavigationHandler,te=function(){return Object(T.jsx)(D.a,{status:"404",title:"404",subTitle:"Sorry, the page you visited does not exist.",extra:Object(T.jsxs)(R.b,{children:[Object(T.jsx)(F.a,Object.assign({onClick:Q.goBack},{children:"Back"}),void 0),Object(T.jsx)(F.a,Object.assign({type:"primary",onClick:ee},{children:"Home"}),void 0)]},void 0)},void 0)},ne=n(101),re=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n},ie={centerNavBar:{justifyContent:"center",boxShadow:"0 2px 8px #f0f1f2"},leftNavBar:{"& .logo::after":{borderBottom:"none !important",transition:"none !important"},"& .logo:hover::after":{borderBottom:"none !important",transition:"none !important"},"& .logo img":{height:24,borderRadius:4,marginTop:-2},paddingLeft:24,paddingRight:24,boxShadow:"0 2px 8px #f0f1f2"}},ae=(Object(N.a)(ie)((function(e){var t=e.classes,n=e.menus,r=e.routes,i=e.className,a=e.style,o=e.isFirstItemLogo,s=Object(A.e)(),c=Object.keys(n).map((function(e,t){return oe(e,!0===o&&0===t?"logo":"",n[e])})),l=Z(s,r);return Object(T.jsx)(ne.a,Object.assign({mode:"horizontal",className:t.centerNavBar+(void 0!==i?" "+i:""),style:a,onClick:function(e){r[e.key].path({},{}).open()},selectedKeys:void 0!==l?[l]:void 0},{children:c}),void 0)})),Object(N.a)(ie)((function(e){var t=e.classes,n=e.menus,r=e.routes,i=e.className,a=e.style,o=e.isFirstItemLogo,s=Object(A.e)(),c=Object.keys(n).map((function(e,t){return oe(e,!0===o&&0===t?"logo":"",n[e])})),l=Z(s,r);return Object(T.jsx)(ne.a,Object.assign({mode:"horizontal",className:t.leftNavBar+(void 0!==i?" "+i:""),style:a,onClick:function(e){r[e.key].path({},{}).open()},selectedKeys:void 0!==l?[l]:void 0},{children:c}),void 0)})));function oe(e,t,n){var r,i;if("string"===typeof n)r=n;else if(H.a.isValidElement(n))r=n;else{var a=n;r=a.children,i=re(a,["children"])}return Object(T.jsx)(ne.a.Item,Object.assign({className:t},i,{children:r}),e)}var se=n(483),ce=n.n(se),le=n(19);function de(e){var t=e.enUSLocale,n=e.routes;return Object(T.jsx)(le.b,Object.assign({locale:!0===t?ce.a:void 0},{children:Object(T.jsx)(A.b,Object.assign({history:V},{children:Object(T.jsx)("div",Object.assign({className:"app-body"},{children:Object(T.jsxs)(A.c,{children:[Object.entries(n).map((function(e){var t=Object(o.a)(e,2),n=t[0],r=t[1];return Object(T.jsx)(A.a,Object.assign({},r.routeDef),n)})),Object(T.jsx)(A.a,{component:te},void 0)]},void 0)}),void 0)}),void 0)}),void 0)}var ue=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,866)).then((function(t){var n=t.getCLS,r=t.getFID,i=t.getFCP,a=t.getLCP,o=t.getTTFB;n(e),r(e),i(e),a(e),o(e)}))},he=n(36),pe=(Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_PLATFORM,"native"===Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_PLATFORM?Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_API_SERVER:""),fe=n(1),be=Object(l.a)((function e(){var t=this;Object(c.a)(this,e),this.NIL_ENTITY="",this.SEM_MODEL_IDENTS=new Set,this.SEM_MODEL_STATEMENTS=new Set,this.instanceofMapping={},this.instanceofProps=new Set,this.instanceofIndex=new ve(0,0),this.instanceof=function(e){return t.instanceofIndex.get(e)},this.setInstanceOf=function(e){t.instanceofMapping=e,t.instanceofProps=new Set(Object.values(e)),t.instanceofIndex=ve.fromMapping(t.instanceofMapping)}})),ve=function(){function e(t,n){var r=this;Object(c.a)(this,e),this.index={},this.start=0,this.end=0,this.get=function(e){var t=e.substring(r.start,r.end),n=r.index[t];if(void 0!==n)return n.internalNode?n.value.get(e):n.value},this.start=t,this.end=n}return Object(l.a)(e,null,[{key:"fromMapping",value:function(t){var n=Object.keys(t).sort().reverse();if(0===n.length)throw new Error("Empty mapping");return function n(r,i){var a,c=r[r.length-1],l=new e(i,c.length),d={},u=Object(s.a)(r);try{for(u.s();!(a=u.n()).done;){var h=a.value,p=h.substring(l.start,c.length);void 0===d[p]&&(d[p]=[]),d[p].push(h)}}catch(y){u.e(y)}finally{u.f()}for(var f=0,b=Object.entries(d);f<b.length;f++){var v=Object(o.a)(b[f],2),j=v[0],g=v[1];1===g.length?l.index[j]={internalNode:!1,value:t[g[0]]}:l.index[j]={internalNode:!0,value:n(g,l.end)}}return l}(n,0)}}]),e}(),je=function(){function e(){var t=this;Object(c.a)(this,e),this._showedPropsInFullView=new Set,this._showedPropsInPopoverView=new Set,this.instanceofProps={},this.nilEntityId="",this.setNilEntityId=function(e){t.nilEntityId=e},this.setInstanceOfProps=function(e){t.instanceofProps=e},this.setShowedPropsInFullView=function(e){t._showedPropsInFullView=e},this.setShowedPropsInPopoverView=function(e){t._showedPropsInPopoverView=e},this.addShowedPropsInFullView=function(e){t._showedPropsInFullView.add(e)},this.addShowedPropsInPopoverView=function(e){t._showedPropsInPopoverView.add(e)},this.removeShowedPropsInFullView=function(e){t._showedPropsInFullView.delete(e)},this.removeShowedPropsInPopoverView=function(e){t._showedPropsInPopoverView.delete(e)},this.getInstanceOfProp=function(e){for(var n in t.instanceofProps)if(e.startsWith(t.instanceofProps[n]))return t.instanceofProps[e]},Object(f.o)(this,{_showedPropsInFullView:f.p,_showedPropsInPopoverView:f.p,instanceofProps:f.p,nilEntityId:f.p,setNilEntityId:f.f,setInstanceOfProps:f.f,showedPropsInFullView:f.g,showedPropsInPopoverView:f.g,setShowedPropsInFullView:f.f,setShowedPropsInPopoverView:f.f,addShowedPropsInFullView:f.f,addShowedPropsInPopoverView:f.f,removeShowedPropsInFullView:f.f,removeShowedPropsInPopoverView:f.f,getInstanceOfProp:f.f})}return Object(l.a)(e,[{key:"showedPropsInFullView",get:function(){return Array.from(this._showedPropsInFullView)}},{key:"showedPropsInPopoverView",get:function(){return Array.from(this._showedPropsInPopoverView)}}]),e}(),ge=Object(l.a)((function e(){var t=this;Object(c.a)(this,e),this.pageSize=5,this.showEntityLinkingEditor=!1,this.setPageSize=function(e){t.pageSize=e},this.toggleEntityLinkingEditor=function(){t.showEntityLinkingEditor=!t.showEntityLinkingEditor},this.enableEntityLinkingEditor=function(){t.showEntityLinkingEditor=!0},Object(f.o)(this,{pageSize:f.p,showEntityLinkingEditor:f.p,setPageSize:f.f,toggleEntityLinkingEditor:f.f,enableEntityLinkingEditor:f.f})})),ye=new be,Oe=function(){function e(){Object(c.a)(this,e),this.entity=void 0,this.table=void 0,this.entity=new je,this.table=new ge,Object(f.o)(this,{entity:f.p,table:f.p,fetchSettings:f.f})}return Object(l.a)(e,[{key:"fetchSettings",value:function(){var e=Object(he.a)(u.a.mark((function e(){var t,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.a.get("/api/settings");case 2:t=e.sent,ye.setInstanceOf(t.data.entity.instanceof),ye.NIL_ENTITY=t.data.entity.nil,ye.SEM_MODEL_IDENTS=new Set(t.data.semantic_model.identifiers),ye.SEM_MODEL_STATEMENTS=new Set(t.data.semantic_model.statements),(n=Object.values(t.data.entity.instanceof)).length>0&&this.entity.addShowedPropsInPopoverView(n[0]);case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}(),xe=Object(l.a)((function e(t){var n=this;Object(c.a)(this,e),this.counter={},this.id2num={},this.label=function(e){return void 0===n.id2num[e.id]||1===n.id2num[e.id]?e.label:"".concat(e.label," ").concat(n.id2num[e.id])},this.nextLabel=function(e,t){return void 0===n.counter[e]?t:"".concat(t," ").concat(n.counter[e])},this.add=function(e){void 0===n.counter[e.uri]&&(n.counter[e.uri]=1),n.id2num[e.id]=n.counter[e.uri],n.counter[e.uri]+=1},this.getNum=function(e){return n.id2num[e.id]};var r,i=Object(s.a)(t||[]);try{for(i.s();!(r=i.n()).done;){var a=r.value;"class_node"===a.nodetype&&(void 0===this.counter[a.uri]&&(this.counter[a.uri]=1),this.id2num[a.id]=this.counter[a.uri],this.counter[a.uri]+=1)}}catch(o){i.e(o)}finally{i.f()}})),me=function(){function e(t,n,r){var i=this;Object(c.a)(this,e),this.id=void 0,this.version=void 0,this.nodes=void 0,this.edges=void 0,this.stale=void 0,this.nodeId2Index={},this.column2nodeIndex={},this.uriCount=void 0,this.isEmpty=function(){return 0==i.edges.length&&i.nodes.every((function(e){return"data_node"===e.nodetype}))},this.clone=function(){var t=i.toJS();return new e(i.id,t.nodes,t.edges)},this.onSave=function(){i.stale=!1},this.node=function(e){return i.nodes[i.nodeId2Index[e]]},this.hasNode=function(e){return void 0!==i.nodeId2Index[e]},this.nodesByURI=function(e){return i.nodes.filter((function(t){return"class_node"===t.nodetype&&t.uri===e}))},this.nodeByColumnIndex=function(e){return i.nodes[i.column2nodeIndex[e]]},this.nodeByEntityId=function(e){return i.nodes.filter((function(t){return"literal_node"===t.nodetype&&"entity-id"===t.value.type&&t.value.id===e}))[0]},this.edge=function(e,t){return i.edges.filter((function(n){return n.source===e&&n.target===t}))[0]},this.hasEdge=function(e,t){return i.edges.filter((function(n){return n.source===e&&n.target===t})).length>0},this.incomingEdges=function(e){return i.edges.filter((function(t){return t.target===e}))},this.outgoingEdges=function(e){return i.edges.filter((function(t){return t.source===e}))},this.nextNodeId=function(){for(var e=0;e<100*i.nodes.length;e++){var t="c-".concat(e);if(void 0===i.nodeId2Index[t])return t}throw new Error("Cannot find new id for a node")},this.findPathMax2hops=function(e,t){var n,r=[],a=i.outgoingEdges(e),o=Object(s.a)(a);try{for(o.s();!(n=o.n()).done;){var c=n.value;if(c.target!==t){var l,d=Object(s.a)(i.outgoingEdges(c.target));try{for(d.s();!(l=d.n()).done;){var u=l.value;u.target===t&&r.push([c,u])}}catch(h){d.e(h)}finally{d.f()}}else r.push([c,void 0])}}catch(h){o.e(h)}finally{o.f()}return r},this.getClassIdOfColumnIndex=function(e){var t,n=i.incomingEdges(i.nodeByColumnIndex(e).id),r=Object(s.a)(n);try{for(r.s();!(t=r.n()).done;){var a=t.value;if(ye.SEM_MODEL_IDENTS.has(a.uri)){if(n.length>1)throw new Error("Invalid semantic model. An entity column has two incoming edges");return a.source}}}catch(o){r.e(o)}finally{r.f()}},this.getOutgoingProperties=function(e){var t,n=[],r=Object(s.a)(i.outgoingEdges(e));try{for(r.s();!(t=r.n()).done;){var a=t.value,o=i.node(a.target);if("class_node"===o.nodetype&&ye.SEM_MODEL_STATEMENTS.has(o.uri)){var c,l=Object(s.a)(i.outgoingEdges(a.target));try{for(l.s();!(c=l.n()).done;){var d=c.value;n.push([a,d])}}catch(u){l.e(u)}finally{l.f()}}else n.push([a,void 0])}}catch(u){r.e(u)}finally{r.f()}return n},this._removeNode=function(e){if(void 0!==i.nodeId2Index[e]&&void 0!==i.nodes[i.nodeId2Index[e]]){var t=i.nodeId2Index[e],n=i.nodes[t];if(!("data_node"===n.nodetype||"literal_node"===n.nodetype&&n.isInContext)){i.nodes[t]=void 0;var r,a=i.edges.filter((function(t){return t.source===e||t.target===e})),o=Object(s.a)(a);try{for(o.s();!(r=o.n()).done;){var c=r.value;i._removeEdge(c.source,c.target)}}catch(l){o.e(l)}finally{o.f()}}}},this._removeEdge=function(e,t){for(var n=void 0,r=0,a=0,o=0;o<i.edges.length;o++){var s=i.edges[o];s.source===e&&s.target===t&&(n=o),s.source!==e&&s.target!==e||(r+=1),s.source!==t&&s.target!==t||(a+=1)}void 0!==n&&(i.edges.splice(n,1),1===r&&i._removeNode(e),1===a&&i._removeNode(t))},this.buildIndex=function(){i.nodeId2Index={},i.column2nodeIndex={};for(var e=0;e<i.nodes.length;e++){var t=i.nodes[e];i.nodeId2Index[t.id]=e,"data_node"===t.nodetype&&null!==t.columnIndex&&(i.column2nodeIndex[t.columnIndex]=e)}},this.id=t,this.version=0,this.nodes=n,this.edges=r,this.stale=!1,this.buildIndex(),this.uriCount=new xe(this.nodes),Object(f.o)(this,{version:f.p,nodes:f.p,edges:f.p,stale:f.p,nodeId2Index:f.p,column2nodeIndex:f.p,uriCount:f.p,addColumnRelationship:f.f,upsertColumnType:f.f,upsertRelationship:f.f,addClassNode:f.f,addLiteralNode:f.f,removeNode:f.f,updateClassNode:f.f,updateDataNode:f.f,updateLiteralNode:f.f,addEdge:f.f,removeEdge:f.f,updateEdge:f.f})}return Object(l.a)(e,[{key:"toJS",value:function(){return{nodes:Object(f.s)(this.nodes),edges:Object(f.s)(this.edges),nodeId2Index:Object(f.s)(this.nodeId2Index)}}},{key:"addColumnRelationship",value:function(e,t,n){var r=this.nodeByColumnIndex(e),i=this.nodeByColumnIndex(t),a=this.incomingEdges(r.id);if(0===a.length)throw new Error("Cannot add link from a data node to another node");if(1!==a.length)throw new Error("The source column connects to multiple class nodes! Don't know the exact class node to choose");var o=this.incomingEdges(i.id);if(o.length>1)throw new Error("The target column connects to multiple class nodes! Don't know the exact class node to choose");var s=a[0].source,c=0===o.length?i.id:o[0].source;this.addEdge(Object(fe.a)(Object(fe.a)({},n),{},{source:s,target:c}))}},{key:"upsertColumnType",value:function(e,t){var n=this.nodeByColumnIndex(e),r=this.incomingEdges(n.id);if(r.length>1)throw new Error("The column connects to multiple class nodes! Don't know the exact class node to choose");if(0===r.length){var i=this.nextNodeId();this.addClassNode(Object(fe.a)(Object(fe.a)({},t),{},{id:i})),this.addEdge({source:i,target:n.id,uri:"http://www.w3.org/2000/01/rdf-schema#label",label:"rdfs:label",approximation:!1})}else{var a=r[0];this.updateClassNode(a.source,t),"http://www.w3.org/2000/01/rdf-schema#label"!==a.uri&&this.updateEdge(a.source,a.target,{uri:"http://www.w3.org/2000/01/rdf-schema#label",label:"rdfs:label",approximation:a.approximation})}}},{key:"upsertRelationship",value:function(e,t,n,r){var i=this.findPathMax2hops(e,t);if(0!==i.length){if(i.length>1)throw new Error("There are more one path between two nodes. Don't know which path to update it");var a=Object(o.a)(i[0],2),s=a[0],c=a[1];this.updateEdge(s.source,s.target,{uri:n.uri,label:n.label,approximation:!1}),void 0!==c&&this.updateEdge(c.source,c.target,{uri:r.uri,label:r.label,approximation:!1})}else if(n.uri===r.uri)this.addEdge({source:e,target:t,uri:n.uri,label:n.label,approximation:!1});else{var l=this.nextNodeId();this.addClassNode({id:l,uri:"http://wikiba.se/ontology#Statement",label:"wikibase:Statement",approximation:!1,nodetype:"class_node"}),this.addEdge({source:e,target:l,uri:n.uri,label:n.label,approximation:!1}),this.addEdge({source:l,target:t,uri:r.uri,label:r.label,approximation:!1})}}},{key:"addClassNode",value:function(e){if(void 0!==this.nodeId2Index[e.id])throw new Error("Duplicated id");this.nodeId2Index[e.id]=this.nodes.length,this.nodes.push(e),this.uriCount.add(e),this.version+=1,this.stale=!0}},{key:"addLiteralNode",value:function(e){if(void 0!==this.nodeId2Index[e.id])throw new Error("Duplicated id");this.nodeId2Index[e.id]=this.nodes.length,this.nodes.push(e),this.version+=1,this.stale=!0}},{key:"removeNode",value:function(e){this._removeNode(e),this.nodes=this.nodes.filter((function(e){return void 0!==e})),this.buildIndex(),this.version+=1,this.stale=!0,this.uriCount=new xe(this.nodes)}},{key:"updateClassNode",value:function(e,t){var n=this.nodeId2Index[e],r=this.nodes[n];if("class_node"!==r.nodetype)throw new Error("Invalid node type. Expected class node but get ".concat(r.nodetype));Object.assign(r,t),this.version+=1,this.stale=!0,void 0!==t.uri&&(this.uriCount=new xe(this.nodes))}},{key:"updateLiteralNode",value:function(e,t){var n=this.nodeId2Index[e],r=this.nodes[n];if("literal_node"!==r.nodetype)throw new Error("Invalid node type. Expected literal node but get ".concat(r.nodetype));Object.assign(r,t),this.version+=1,this.stale=!0}},{key:"updateDataNode",value:function(e,t){var n=this.nodeId2Index[e],r=this.nodes[n];if("data_node"!==r.nodetype)throw new Error("Invalid node type. Expected data node but get ".concat(r.nodetype));Object.assign(r,t),this.version+=1,this.stale=!0}},{key:"addEdge",value:function(e){if(this.hasEdge(e.source,e.target))throw new Error("Cannot have more than one edge between two nodes");this.edges.push(e),this.version+=1,this.stale=!0}},{key:"removeEdge",value:function(e,t){var n=this.nodes.length;this._removeEdge(e,t),this.nodes=this.nodes.filter((function(e){return void 0!==e})),this.nodes.length!==n&&(this.buildIndex(),this.uriCount=new xe(this.nodes)),this.version+=1,this.stale=!0}},{key:"updateEdge",value:function(e,t,n){for(var r=0;r<this.edges.length;r++){var i=this.edges[r];i.source===e&&i.target===t&&(this.edges[r]=Object(fe.a)(Object(fe.a)({},this.edges[r]),n))}this.version=(this.version||0)+1,this.stale=!0}}]),e}(),we=function(){function e(t,n,r,i,a,o){Object(c.a)(this,e),this.id=void 0,this.name=void 0,this.description=void 0,this.version=void 0,this.graph=void 0,this.table=void 0,this.id=t,this.name=n,this.description=r,this.version=i,this.graph=a,this.table=o}return Object(l.a)(e,[{key:"markSaved",value:function(){this.graph.onSave()}},{key:"toModel",value:function(){return this}}]),e}();we.isDraft=function(e){return void 0!==e.draftID};var ke=function(e){Object(m.a)(n,e);var t=Object(w.a)(n);function n(e,r,i,a,o,s){var l;return Object(c.a)(this,n),(l=t.call(this,-1,r,i,a,o,s)).draftID=void 0,l.draftID=e,l}return Object(l.a)(n,null,[{key:"getDefaultDraftSemanticModel",value:function(e,t,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"",a=new me(e,r.columns.map((function(e,t){return{id:"col-".concat(t),label:e,columnIndex:t,nodetype:"data_node"}})),[]);return a.stale=!0,new n(e,t,i,0,a,r.id)}}]),n}(we),Ie=function(e){Object(m.a)(n,e);var t=Object(w.a)(n);function n(){var e;return Object(c.a)(this,n),(e=t.call(this,"".concat(pe,"/api/semanticmodel"),void 0,!1,[new E("table")])).getNewCreateDraftId=function(t){for(var n=0;;){var r="draft-".concat(n,":").concat(t.id);if(void 0===e.getCreateDraft(r))return r;n++}},e}return Object(l.a)(n,[{key:"tableIndex",get:function(){return this.indices[0]}},{key:"getNewSemanticModelName",value:function(e){var t,n=this.findByTable(e.id),r=this.getCreateDraftsByTable(e),i=-1,a=Object(s.a)(n.concat(r));try{for(a.s();!(t=a.n()).done;){var o=t.value,c=/sm-(\d+)/.exec(o.name);null!==c&&(parseInt(c[1])>=i&&(i=Math.max(i,parseInt(c[1]))))}}catch(l){a.e(l)}finally{a.f()}return"sm-".concat(i+1)}},{key:"getCreateDraftsByTable",value:function(e){var t,n=[],r=Object(s.a)(this.createDrafts.values());try{for(r.s();!(t=r.n()).done;){var i=t.value;i.table==e.id&&n.push(i)}}catch(a){r.e(a)}finally{r.f()}return n}},{key:"findByTable",value:function(e){var t=this;return Array.from(this.tableIndex.index.get(e)||[]).map((function(e){return t.records.get(e)}))}},{key:"deindex",value:function(e){var t,n=Object(s.a)(this.indices);try{for(n.s();!(t=n.n()).done;){t.value.remove(e)}}catch(r){n.e(r)}finally{n.f()}}},{key:"hasByTable",value:function(e){return this.tableIndex.index.has(e)}},{key:"deserialize",value:function(e){var t=e.data.nodes.map((function(e){var t=e.type;return delete e.type,e.nodetype=t,"data_node"===t?(e.columnIndex=e.column_index,delete e.column_index):"literal_node"===t&&(e.isInContext=e.is_in_context,delete e.is_in_context),e})),n=e.data.edges,r=new me(e.id.toString(),t,n);return new we(e.id,e.name,e.description,e.version,r,e.table)}},{key:"serializeUpdateDraft",value:function(e){return e.version+=1,{table:e.table,name:e.name,description:e.description,version:e.version,data:{nodes:e.graph.nodes.map((function(e){switch(e.nodetype){case"class_node":return{id:e.id,uri:e.uri,approximation:e.approximation,label:e.label,type:e.nodetype};case"data_node":return{id:e.id,label:e.label,column_index:e.columnIndex,type:e.nodetype};case"literal_node":return{id:e.id,value:e.value,label:e.label,is_in_context:e.isInContext,type:e.nodetype}}})),edges:e.graph.edges.map((function(e){return{source:e.source,target:e.target,uri:e.uri,approximation:e.approximation,label:e.label}}))}}}},{key:"serializeCreateDraft",value:function(e){return this.serializeUpdateDraft(e)}}]),n}(I),Se=function(e){Object(m.a)(n,e);var t=Object(w.a)(n);function n(e,r,i,a,o){var l;return Object(c.a)(this,n),(l=t.call(this,"".concat(pe,"/api/assistant"),void 0,!1,[])).tables=void 0,l.rows=void 0,l.smStore=void 0,l.entityStore=void 0,l.classStore=void 0,l.predict=Object(f.j)(u.a.mark((function e(t){var n,r,i,a,o,c,l,d,h,f,b;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.a.get("".concat(this.remoteURL,"/predict/").concat(t.id),{params:{algorithm:"mtab"}});case 2:n=e.sent,r=n.data.mtab.sm,i=n.data.mtab.rows,a=this.smStore.getNewCreateDraftId(t),o=this.smStore.deserialize({data:r,id:""}).graph,1===(c=this.smStore.getCreateDraftsByTable(t)).length&&c[0].graph.isEmpty()&&this.smStore.deleteCreateDraft(c[0].draftID),l=this.smStore.getNewSemanticModelName(t),this.smStore.setCreateDraft(new ke(a,l,"",0,o,t.id)),d=i.map(this.rows.deserialize),h=Object(s.a)(d);try{for(h.s();!(f=h.n()).done;)b=f.value,this.rows.set(b)}catch(u){h.e(u)}finally{h.f()}return e.abrupt("return");case 15:case"end":return e.stop()}}),e,this)}))),l.tables=e,l.rows=r,l.smStore=i,l.classStore=a,l.entityStore=o,Object(f.o)(Object(x.a)(l),{predict:f.f,getColumnTypes:f.f,getColumnTypesServer:f.f}),l}return Object(l.a)(n,[{key:"getColumnTypes",value:function(){var e=Object(he.a)(u.a.mark((function e(t,n,r){var i,a,o,c,l,d,h,p,f,b,v,j,g,y,O,x,m,w,k,I,S,C,E,L,T,N,P,_,D,R,F,A;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.rows.fetchByTable(t,0,t.size);case 2:i=e.sent,a=new Set,o=Object(s.a)(i);try{for(o.s();!(c=o.n()).done;){l=c.value,d=Object(s.a)(l.links[n]||[]);try{for(d.s();!(h=d.n()).done;)if(void 0!==(p=h.value).entityId&&p.entityId!==ye.NIL_ENTITY&&a.add(p.entityId),r){f=Object(s.a)(p.candidateEntities);try{for(f.s();!(b=f.n()).done;)v=b.value,a.add(v.entityId)}catch(u){f.e(u)}finally{f.f()}}}catch(u){d.e(u)}finally{d.f()}}}catch(u){o.e(u)}finally{o.f()}return e.next=8,this.entityStore.fetchByIds(Array.from(a));case 8:j=e.sent,g=new Set,y=0,O=Object.values(j);case 11:if(!(y<O.length)){e.next=21;break}if(x=O[y],void 0!==(m=ye.instanceof(x.uri))&&void 0!==x.properties[m]){e.next=16;break}return e.abrupt("continue",18);case 16:w=Object(s.a)(x.properties[m]);try{for(w.s();!(k=w.n()).done;)"entityid"===(I=k.value).value.type&&(S=I.value.value,g.add(S))}catch(u){w.e(u)}finally{w.f()}case 18:y++,e.next=11;break;case 21:return e.next=23,this.classStore.fetchByIds(Array.from(g));case 23:C=e.sent,E=this.smStore.findByTable(t.id).concat(this.smStore.getCreateDraftsByTable(t)),L=new Set,T=Object(s.a)(E);try{for(T.s();!(N=T.n()).done;)P=N.value,void 0!==(_=P.graph.getClassIdOfColumnIndex(n))&&"class_node"===(D=P.graph.node(_)).nodetype&&L.add(D.uri)}catch(u){T.e(u)}finally{T.f()}return e.t0=s.a,e.next=31,Promise.all(Array.from(L).map(this.classStore.fetchIfMissingByURI.bind(this.classStore)));case 31:e.t1=e.sent,R=(0,e.t0)(e.t1),e.prev=33,R.s();case 35:if((F=R.n()).done){e.next=42;break}if(void 0!==(A=F.value)){e.next=39;break}return e.abrupt("continue",40);case 39:C[A.id]=A;case 40:e.next=35;break;case 42:e.next=47;break;case 44:e.prev=44,e.t2=e.catch(33),R.e(e.t2);case 47:return e.prev=47,R.f(),e.finish(47);case 50:return e.abrupt("return",C);case 51:case"end":return e.stop()}}),e,this,[[33,44,47,50]])})));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"getColumnTypesServer",value:function(){var e=Object(he.a)(u.a.mark((function e(t,n){var r,i,a,o,c,l,d,h,f,b,v,j,g,y,O,x,m,w,k,I,S,C,E,L;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=p.a.post("".concat(this.remoteURL,"/column-types"),{table:t.id,column:n}),i=this.smStore.findByTable(t.id).concat(this.smStore.getCreateDraftsByTable(t)),a=new Set,o=Object(s.a)(i);try{for(o.s();!(c=o.n()).done;)l=c.value,void 0!==(d=l.graph.getClassIdOfColumnIndex(n))&&"class_node"===(h=l.graph.node(d)).nodetype&&a.add(h.uri)}catch(u){o.e(u)}finally{o.f()}return e.next=7,r;case 7:return f=e.sent,b=Object.fromEntries(Object.entries(f.data).map((function(e){return[e[0],new Set(e[1])]}))),e.t0=Object,e.next=12,this.classStore.fetchByIds(Object.keys(b));case 12:return e.t1=e.sent,v=e.t0.values.call(e.t0,e.t1),e.t2=Object,e.next=17,Promise.all(Array.from(a).map(this.classStore.fetchIfMissingByURI.bind(this.classStore)));case 17:for(e.t3=e.sent.filter((function(e){return void 0!==e})).map((function(e){return[e.id,e]})),j=e.t2.fromEntries.call(e.t2,e.t3),g=0,y=Object.values(j);g<y.length;g++)if(O=y[g],void 0===b[O.id]){b[O.id]=new Set,x=Object(s.a)(O.parents);try{for(x.s();!(m=x.n()).done;)w=m.value,void 0!==b[w]&&b[w].add(O.id)}catch(u){x.e(u)}finally{x.f()}}for(k=0,I=v;k<I.length;k++){S=I[k],C=Object(s.a)(S.parents);try{for(C.s();!(E=C.n()).done;)L=E.value,void 0!==j[L]&&b[L].add(S.id)}catch(u){C.e(u)}finally{C.f()}}return e.abrupt("return",b);case 22:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()}]),n}(j),Ce=function(e){Object(m.a)(n,e);var t=Object(w.a)(n);function n(){return Object(c.a)(this,n),t.call(this,"".concat(pe,"/api/entities"),void 0,!1)}return Object(l.a)(n,[{key:"deserialize",value:function(e){e.readableLabel=e.readable_label,delete e.readable_label;for(var t=0,n=Object.values(e.properties);t<n.length;t++){var r,i=n[t],a=Object(s.a)(i);try{for(a.s();!(r=a.n()).done;){var o=r.value;o.qualifiersOrder=o.qualifiers_order,delete o.qualifiers_order}}catch(c){a.e(c)}finally{a.f()}}return e}}]),n}(j),Ee=function(e){Object(m.a)(n,e);var t=Object(w.a)(n);function n(){var e;return Object(c.a)(this,n),(e=t.call(this,"".concat(pe,"/api/classes"),{readableLabel:"readable_label",parentsClosure:"parents_closure"},!1,[new C("uri")])).doesNotExistURIs=new Set,e.getClassByURI=function(t){var n=e.uriIndex.index.get(t);return void 0!==n?e.get(n):void 0},Object(f.o)(Object(x.a)(e),{doesNotExistURIs:f.p,fetchIfMissingByURI:f.f}),e}return Object(l.a)(n,[{key:"uriIndex",get:function(){return this.indices[0]}},{key:"fetchIfMissingByURI",value:function(){var e=Object(he.a)(u.a.mark((function e(t){var n,r,i=this;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.doesNotExistURIs.has(t)){e.next=2;break}return e.abrupt("return",void 0);case 2:if(void 0!==(n=this.uriIndex.index.get(t))){e.next=9;break}return e.next=6,this.fetchOne({conditions:{uri:t}});case 6:return void 0===(r=e.sent)&&Object(f.r)((function(){i.doesNotExistURIs.add(t)})),e.abrupt("return",r);case 9:return e.abrupt("return",this.get(n));case 10:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}()},{key:"deserialize",value:function(e){return(e=Object(y.a)(Object(O.a)(n.prototype),"deserialize",this).call(this,e)).parentsClosure=new Set(e.parentsClosure),e}}]),n}(j),Le=function(e){Object(m.a)(n,e);var t=Object(w.a)(n);function n(){var e;return Object(c.a)(this,n),(e=t.call(this,"".concat(pe,"/api/properties"),{readableLabel:"readable_label"},!1,[new C("uri")])).getPropertyByURI=function(t){var n=e.uriIndex.index.get(t);return void 0!==n?e.get(n):void 0},e}return Object(l.a)(n,[{key:"uriIndex",get:function(){return this.indices[0]}}]),n}(j),Te=Object(l.a)((function e(t,n,r){Object(c.a)(this,e),this.id=void 0,this.name=void 0,this.description=void 0,this.id=t,this.name=n,this.description=r,Object(f.o)(this,{id:f.p,name:f.p,description:f.p})})),Ne=function(e){Object(m.a)(n,e);var t=Object(w.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"markSaved",value:function(){}},{key:"toModel",value:function(){return new Te(this.id,this.name,this.description)}}],[{key:"fromProject",value:function(e){return new n(e.id,e.name,e.description)}}]),n}(Te),Pe=function(e){Object(m.a)(n,e);var t=Object(w.a)(n);function n(e){var r;return Object(c.a)(this,n),(r=t.call(this,0,"","")).draftID=void 0,r.draftID=e,r}return Object(l.a)(n)}(Te),_e=function(e){Object(m.a)(n,e);var t=Object(w.a)(n);function n(){var e;return Object(c.a)(this,n),(e=t.call(this,"".concat(pe,"/api/project"),void 0,!1)).uploadTable=function(){var e=Object(he.a)(u.a.mark((function e(t,n,r,i){var a,o;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(a=new FormData).append("file",n),void 0!==r&&a.append("parser_opts",JSON.stringify({file:r})),void 0!==i&&a.append("selected_tables",JSON.stringify(i)),e.next=6,p.a.post("".concat(pe,"/api/project/").concat(t,"/upload"),a,{headers:{"Content-Type":"multipart/form-data"}});case 6:if(void 0===(o=e.sent).data.tables){e.next=9;break}return e.abrupt("return",o.data.tables[0]);case 9:return e.abrupt("return",o.data.table_ids);case 10:case"end":return e.stop()}}),e)})));return function(t,n,r,i){return e.apply(this,arguments)}}(),e}return Object(l.a)(n,[{key:"deserialize",value:function(e){return new Te(e.id,e.name,e.description)}},{key:"serializeUpdateDraft",value:function(e){return{id:e.id,name:e.name,description:e.description}}},{key:"serializeCreateDraft",value:function(e){return{name:e.name,description:e.description}}}]),n}(I),De=["csv","json"];function Re(e){return void 0!==e.nLines}var Fe=function(e){Object(m.a)(n,e);var t=Object(w.a)(n);function n(){var e;return Object(c.a)(this,n),(e=t.call(this,"".concat(pe,"/api/tablerow"),void 0,!1,[new L("table","index")])).updateCellLinks=Object(f.j)(u.a.mark((function e(t,n,r,i){var a,o,c,l;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("number"!==typeof(a=t.row[n])){e.next=3;break}throw new Error("Can't not link a number \"".concat(a,'" to an entity'));case 3:if(void 0!==t.links[n]&&0!==t.links[n].length){e.next=7;break}if(void 0!==r){e.next=6;break}return e.abrupt("return");case 6:t.links[n]=[{start:0,end:a.length,url:void 0,entityId:r,candidateEntities:[]}];case 7:if(t.links[n][0].entityId=r,e.prev=8,o={links:t.links[n].map(this.serializeLink)},!i){c=Object(s.a)(o.links);try{for(c.s();!(l=c.n()).done;)delete l.value.candidate_entities}catch(d){c.e(d)}finally{c.f()}}return this.state.value="updating",e.next=14,p.a.put("".concat(this.remoteURL,"/").concat(t.id,"/cells/").concat(n),o);case 14:this.state.value="updated",e.next=21;break;case 17:throw e.prev=17,e.t0=e.catch(8),this.state.value="error",e.t0;case 21:case"end":return e.stop()}}),e,this,[[8,17]])}))),e.updateColumnLinks=Object(f.j)(u.a.mark((function e(t,n,r,i){var a,c,l,d,h,f;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(void 0===(a=this.tableIndex.index.get(t.id))){e.next=25;break}c=Object(s.a)(a),e.prev=3,c.s();case 5:if((l=c.n()).done){e.next=17;break}if(d=Object(o.a)(l.value,2),d[0],h=d[1],(f=this.records.get(h)).row[n]===r){e.next=10;break}return e.abrupt("continue",15);case 10:if(void 0!==f.links[n]&&0!==f.links[n].length){e.next=14;break}if(void 0!==i){e.next=13;break}return e.abrupt("continue",15);case 13:f.links[n]=[{start:0,end:r.length,url:void 0,entityId:i,candidateEntities:[]}];case 14:f.links[n][0].entityId=i;case 15:e.next=5;break;case 17:e.next=22;break;case 19:e.prev=19,e.t0=e.catch(3),c.e(e.t0);case 22:return e.prev=22,c.f(),e.finish(22);case 25:return e.prev=25,this.state.value="updating",e.next=29,p.a.put("".concat(this.remoteURL,"/update_column_links"),{table:t.id,column:n,text:r,entity_id:void 0===i?null:i});case 29:this.state.value="updated",e.next=36;break;case 32:throw e.prev=32,e.t1=e.catch(25),this.state.value="error",e.t1;case 36:case"end":return e.stop()}}),e,this,[[3,19,22,25],[25,32]])}))),e.fetchByTable=Object(f.j)(u.a.mark((function e(t,n,r){var i,a,o,s,c,l,d;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.size<n+r&&(r=t.size-n),i=!0,void 0!==(a=this.tableIndex.index.get(t.id))){e.next=8;break}return e.next=6,this.fetch({limit:r,offset:n,conditions:{table:t.id}});case 6:return o=e.sent,e.abrupt("return",o.records);case 8:s=[],c=0;case 10:if(!(c<r)){e.next=19;break}if(void 0!==(l=a.get(c+n))){e.next=15;break}return i=!1,e.abrupt("break",19);case 15:s.push(this.records.get(l));case 16:c++,e.next=10;break;case 19:if(!i){e.next=21;break}return e.abrupt("return",s);case 21:return e.next=23,this.fetch({limit:r,offset:n,conditions:{table:t.id}});case 23:return d=e.sent,e.abrupt("return",d.records);case 25:case"end":return e.stop()}}),e,this)}))),e.serializeLink=function(e){return{start:e.start,end:e.end,url:e.url||null,entity_id:e.entityId||null,candidate_entities:e.candidateEntities.map((function(e){return{entity_id:e.entityId,probability:e.probability}}))}},Object(f.o)(Object(x.a)(e),{fetchByTable:f.f,updateCellLinks:f.f,updateColumnLinks:f.f}),e}return Object(l.a)(n,[{key:"tableIndex",get:function(){return this.indices[0]}},{key:"index",value:function(e){this.tableIndex.add(e)}},{key:"deserialize",value:function(e){return Object.values(e.links).forEach((function(e){e.forEach((function(e){null!==e.entity_id&&(e.entityId=e.entity_id),null===e.url&&delete e.url,e.candidate_entities.forEach((function(e){e.entityId=e.entity_id,delete e.entity_id})),e.candidateEntities=e.candidate_entities,delete e.entity_id,delete e.candidate_entities}))})),e}},{key:"serializeRecord",value:function(e){var t=this;return{table:e.table,index:e.index,row:Array.from(e.row),links:Object.fromEntries(Object.entries(e.links).map((function(e){var n=Object(o.a)(e,2);return[n[0],n[1].map(t.serializeLink)]})))}}}]),n}(S),Ae=new(function(e){Object(m.a)(n,e);var t=Object(w.a)(n);function n(){var e;return Object(c.a)(this,n),(e=t.call(this,"".concat(pe,"/api/table"),void 0,!1,[new E("project")])).findByProject=function(t,n,r){return Array.from(e.projectIndex.index.get(t)||[]).map((function(t){return e.records.get(t)}))},e}return Object(l.a)(n,[{key:"projectIndex",get:function(){return this.indices[0]}},{key:"deserialize",value:function(e){return e.contextPage=e.context_page,null!==e.contextPage&&void 0!==e.contextPage||(e.contextPage={}),null!==e.contextPage.entity&&(e.contextPage.entityId=e.contextPage.entity,delete e.contextPage.entity),e.contextValues=e.context_values,void 0!==e.context_tree&&(e.contextTree=e.context_tree.map((function(e){return e.contentBefore=e.content_before.map((function(e){return void 0!==e.n_lines&&(e.nLines=e.n_lines,delete e.n_lines),e})),e.contentAfter=e.content_after.map((function(e){return void 0!==e.n_lines&&(e.nLines=e.n_lines,delete e.n_lines),e})),delete e.content_before,delete e.content_after,e})),delete e.context_tree),delete e.context_tree,delete e.context_values,delete e.context_page,e}},{key:"index",value:function(e){this.projectIndex.add(e)}}]),n}(S)),Be=new Ie,ze=new Fe,Me=new Ee,Ue=new Ce,He={projectStore:new _e,tableStore:Ae,tableRowStore:ze,semanticModelStore:Be,entityStore:Ue,propertyStore:new Le,classStore:Me,assistantService:new Se(Ae,ze,Be,Me,Ue),uiSettings:new Oe};window.addEventListener("unhandledrejection",(function(e){!0===e.reason.isAxiosError&&(a.b.error("Error while talking with the server.",10),console.error(e.reason))})),window._stores=He;var qe=Object(U.createContext)(He);function Ve(){return H.a.useContext(qe)}var We=n(178),Ke=n(115),Ye=n(498),Je=n(855),Qe=n(315),Ge=n(50),Xe=n(47),$e=n(82),Ze=n(89),et=Object(N.a)({})(Object(Ge.a)((function(e){e.classes;var t=Ve().projectStore,n=$e.a.useForm(),r=Object(o.a)(n,1)[0],i=Object(U.useState)({name:"",status:"success"}),a=Object(o.a)(i,2),s=a[0],c=a[1];return Object(T.jsx)(T.Fragment,{children:Object(T.jsxs)($e.a,{labelCol:{span:4},wrapperCol:{span:20},form:r,onFinish:function(){var e=new Pe("");e.name=r.getFieldValue("name"),e.description=r.getFieldValue("description"),t.create(e).then((function(){M.a.destroyAll()})).catch((function(){c({name:e.name,status:"error"})}))},children:[Object(T.jsx)($e.a.Item,{name:"name",label:"name",rules:[{required:!0}],validateStatus:s.name===r.getFieldValue("name")&&"error"===s.status?"error":void 0,children:Object(T.jsx)(Ze.a,{})}),Object(T.jsx)($e.a.Item,{name:"description",label:"description",rules:[{required:!0}],children:Object(T.jsx)(Ze.a,{})}),Object(T.jsx)($e.a.Item,{wrapperCol:{span:20,offset:4},children:Object(T.jsx)(F.a,{type:"primary",htmlType:"submit",children:"Create"})})]})})}))),tt=[Xe.m[5],Xe.n[5],Xe.a[5],Xe.e[5],Xe.j[5],Xe.o[5],Xe.h[5],Xe.f[5],Xe.b[5],Xe.c[5],Xe.l[5],Xe.i[5]],nt=Object(Ge.a)((function(){var e=Ve().projectStore;return Object(U.useEffect)((function(){e.fetch({limit:100,offset:0})}),[e]),Object(T.jsxs)(H.a.Fragment,{children:[Object(T.jsxs)(We.a,{gutter:16,children:[Object(T.jsx)(Ke.a,{className:"gutter-row",span:16,children:Object(T.jsx)(Ye.a.Title,{level:3,children:"Projects"})}),Object(T.jsx)(Ke.a,{className:"gutter-row",span:8,children:Object(T.jsx)(F.a,{style:{float:"right"},type:"primary",onClick:function(){return function(e){var t=Object(T.jsx)(et,{});M.a.info({title:Object(T.jsx)("span",{style:{marginBottom:16,display:"inline-block"},children:"New Project"}),content:t,bodyStyle:{margin:-8},okButtonProps:{style:{display:"none"}},maskClosable:!0,mask:!0,zIndex:e,width:"calc(100% - 128px)",style:{top:64}})}()},children:"New Project"})})]}),Object(T.jsx)(We.a,{gutter:16,children:Object(T.jsx)(Ke.a,{className:"gutter-row",span:24,children:Object(T.jsx)(Je.b,{size:"small",bordered:!0,itemLayout:"horizontal",dataSource:e.list,renderItem:function(e,t){return Object(T.jsx)(Je.b.Item,{children:Object(T.jsx)(Je.b.Item.Meta,{avatar:Object(T.jsx)(Qe.a,{shape:"square",size:"large",style:{marginTop:4,backgroundColor:tt[e.name.charCodeAt(0)%tt.length]},children:e.name[0].toUpperCase()}),title:Object(T.jsx)(X,{path:Cr.project,urlArgs:{projectId:e.id},queryArgs:{},children:e.name}),description:e.description})})}})})})]})})),rt=n(506),it=n(169),at=n(485),ot=n(167),st=n.n(ot),ct=Object(N.a)({})(Object(Ge.a)((function(e){var t=e.project,n=(e.classes,Ve().projectStore),r=$e.a.useForm(),i=Object(o.a)(r,1)[0],a=Object(U.useState)({name:"",status:"success"}),s=Object(o.a)(a,2),c=s[0],l=s[1];return Object(T.jsx)(T.Fragment,{children:Object(T.jsxs)($e.a,{labelCol:{span:4},wrapperCol:{span:20},form:i,onFinish:function(){var e=Ne.fromProject(t);e.name=i.getFieldValue("name"),e.description=i.getFieldValue("description"),n.update(e).then((function(){M.a.destroyAll()})).catch((function(){l({name:e.name,status:"error"})}))},children:[Object(T.jsx)($e.a.Item,{name:"name",label:"name",rules:[{required:!0}],initialValue:t.name,validateStatus:c.name===i.getFieldValue("name")&&"error"===c.status?"error":void 0,children:Object(T.jsx)(Ze.a,{})}),Object(T.jsx)($e.a.Item,{name:"description",label:"description",rules:[{required:!0}],initialValue:t.description,children:Object(T.jsx)(Ze.a,{})}),Object(T.jsx)($e.a.Item,{wrapperCol:{span:20,offset:4},children:Object(T.jsxs)(R.b,{style:{width:"100%"},children:[Object(T.jsx)(F.a,{type:"primary",htmlType:"submit",children:"Update"}),Object(T.jsx)(F.a,{type:"primary",danger:!0,onClick:function(){n.delete(t.id).then((function(){M.a.destroyAll()})).then((function(){Cr.home.path().open()}))},children:"Delete"})]})})]})})}))),lt=n(858),dt=n(852),ut=n(503),ht=n(137),pt=function(e){e.opt;var t=e.form;return Object(T.jsxs)(T.Fragment,{children:[Object(T.jsx)($e.a.Item,{name:"delimiter",label:"delimiter",rules:[{required:!0}],children:Object(T.jsx)(Ze.a,{onChange:function(e){t.setFieldsValue({delimiter:e.target.value.replace("\\t","\t").replace("\\n","\n")})},style:{width:60}})}),Object(T.jsx)($e.a.Item,{name:"first_row_is_header",label:"Is first row header",rules:[{required:!0}],valuePropName:"checked",children:Object(T.jsx)(ut.a,{})})]})},ft=function(e){switch(e){case"\t":return"\\t";case"\n":return"\\n";default:return e}},bt=function(e){var t,n=$e.a.useForm(),r=Object(o.a)(n,1)[0];return t="csv"===e.parserOpts.format?Object(T.jsx)(pt,{opt:e.parserOpts,form:r}):null,Object(T.jsxs)($e.a,{layout:"inline",initialValues:Object(fe.a)(Object(fe.a)({},e.parserOpts),{},{delimiter:"csv"===e.parserOpts.format?ft(e.parserOpts.delimiter):void 0}),children:[Object(T.jsx)($e.a.Item,{name:"format",label:"File Type",rules:[{required:!0}],children:Object(T.jsx)(ht.a,{onChange:function(e){r.setFieldsValue({format:e})},children:De.map((function(e){return Object(T.jsx)(ht.a.Option,{value:e,children:e},e)}))})}),t,Object(T.jsx)($e.a.Item,{children:Object(T.jsx)(F.a,{type:"primary",htmlType:"submit",children:"Update"})})]})},vt=Object(N.a)({table:{"& div.ant-table-container":{border:"1px solid #bbb",borderRadius:4,borderLeft:"1px solid #bbb !important"},"& div.ant-card-body":{paddingLeft:0,paddingRight:0},"& th":{fontWeight:600}}})((function(e){var t=e.table,n=e.classes;return Object(T.jsx)(it.a,{className:n.table,defaultSize:"small",bordered:!0,toolBarRender:!1,search:!1,pagination:{pageSize:5,pageSizeOptions:["5","10","20","50","100","200","500","1000"]},rowKey:"id",columns:t.header.map((function(e,t){return{dataIndex:["data",t],title:e}})),request:function(){var e=Object(he.a)(u.a.mark((function e(n,r,i){var a,o;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=(n.current-1)*n.pageSize,o=a+n.pageSize,e.abrupt("return",{data:t.rows.slice(a,o).map((function(e,t){return{data:e,id:t+a}})),success:!0,total:t.rows.length});case 3:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}()})})),jt={upload:{"& > .ant-upload":{padding:"8px 0 !important"}},carouselDot:{zIndex:2e3,backgroundColor:"black",opacity:0}},gt=Object(N.a)(jt)((function(e){var t=e.classes,n=e.projectId,r=e.setUploadTable,i=Ve().projectStore;return Object(T.jsxs)(R.b,{direction:"vertical",style:{width:"100%"},children:[Object(T.jsxs)(dt.a.Dragger,{name:"file",multiple:!1,onDrop:function(e){var t=e.dataTransfer.files[0];i.uploadTable(n,t).then((function(e){if(Array.isArray(e))throw new Error("Error");r(e,t)}))},beforeUpload:function(){return!1},className:t.upload,children:[Object(T.jsx)("p",{className:"ant-upload-drag-icon",children:Object(T.jsx)(lt.a,{})}),Object(T.jsx)("p",{className:"ant-upload-hint",children:"Click or drag file to this area to upload"})]}),Object(T.jsxs)($e.a,{layout:"inline",children:[Object(T.jsx)($e.a.Item,{name:"url",label:"URL",rules:[{required:!0}],style:{width:"calc(100% - 94px)"},children:Object(T.jsx)(Ze.a,{})}),Object(T.jsx)($e.a.Item,{style:{margin:0},children:Object(T.jsx)(F.a,{type:"primary",htmlType:"submit",children:"Submit"})})]})]})})),yt=Object(N.a)(jt)((function(e){var t,n=e.uploadingTable,r=(e.classes,e.projectId),i=e.destroy,a=e.onDone,s=Ve().projectStore,c=Object(U.useState)(n.table.tables.map((function(){return!0}))),l=Object(o.a)(c,2),d=l[0],u=l[1];t=1==n.table.tables.length?Object(T.jsx)(vt,{table:n.table.tables[0]}):n.table.tables.map((function(e,t){return Object(T.jsxs)(R.b,{direction:"vertical",style:{width:"100%"},children:[Object(T.jsxs)(Ye.a.Text,{children:["Select:\xa0",Object(T.jsx)(ut.a,{checked:d[t],onChange:function(e){var n=d.slice();n[t]=e,u(n)}})]}),Object(T.jsx)(vt,{table:e}),","]},"table-".concat(t,"-wrap"))}));return Object(T.jsxs)(R.b,{direction:"vertical",style:{width:"100%"},children:[Object(T.jsx)(bt,{parserOpts:n.table.parser_opts}),t,Object(T.jsx)(R.b,{children:Object(T.jsx)(F.a,{type:"primary",onClick:function(){var e=[];return d.forEach((function(t,n){t&&e.push(n)})),s.uploadTable(r,n.file,n.table.parser_opts,e).then((function(e){i(),a()}))},children:"Confirm"})})]})})),Ot=function(e){var t=e.project,n=e.destroy,r=e.onDone,i=(Ve().projectStore,Object(U.useState)("phase1")),a=Object(o.a)(i,2),s=a[0],c=a[1],l=Object(U.useState)(void 0),d=Object(o.a)(l,2),u=d[0],h=d[1];return"phase1"===s?Object(T.jsx)(gt,{projectId:t.id,setUploadTable:function(e,t){h({table:e,file:t}),c("phase2")}}):"phase2"===s?Object(T.jsx)(yt,{projectId:t.id,uploadingTable:u,destroy:n,onDone:r||function(){}}):Object(T.jsx)(T.Fragment,{})},xt=Object(N.a)({table:{"& div.ant-table-container":{border:"1px solid #bbb",borderRadius:4,borderLeft:"1px solid #bbb !important"},"& div.ant-card-body":{paddingLeft:0,paddingRight:0},"& th":{fontWeight:600}}})(Object(Ge.a)((function(e){var t=e.classes,n=Cr.project.useURLParams().projectId,r=M.a.useModal(),i=Object(o.a)(r,2),a=i[0],s=i[1],c=Object(U.useRef)(),l=Ve(),d=l.projectStore,h=l.tableStore;Object(U.useEffect)((function(){d.fetchById(n)}),[d,n]);var p=d.get(n);if(void 0===p)return Object(T.jsx)(_,{});if(null===p)return Object(T.jsx)(te,{});var f=[{dataIndex:"id",title:"id"},{dataIndex:"name",title:"name",renderText:function(e,t){return Object(T.jsx)(X,{path:Cr.table,urlArgs:{tableId:t.id},queryArgs:{query:h.encodeWhereQuery({project:n})},children:t.name})}},{dataIndex:"description",title:"description"},{dataIndex:"id",title:"action",renderText:function(e,t){return Object(T.jsx)(at.a,{title:"Are you sure to delete this table?",onConfirm:function(){var e;h.delete(t.id),null===(e=c.current)||void 0===e||e.reload()},okText:"Yes",cancelText:"No",children:Object(T.jsx)(F.a,{type:"primary",danger:!0,size:"small",children:"Delete"})})}}];return Object(T.jsxs)(H.a.Fragment,{children:[Object(T.jsxs)(Ye.a.Title,{level:3,children:["Project ",st.a.upperFirst(p.name),"\xa0",Object(T.jsx)("a",{style:{fontSize:"0.8em",fontWeight:400},onClick:function(){return function(e,t){var n=Object(T.jsx)(ct,{project:e});M.a.info({title:Object(T.jsxs)("span",{style:{marginBottom:16,display:"inline-block"},children:["Update Project ",e.name]}),content:n,bodyStyle:{margin:-8},okButtonProps:{style:{display:"none"}},maskClosable:!0,mask:!0,zIndex:t,width:"calc(100% - 128px)",style:{top:64}})}(p)},children:Object(T.jsx)(rt.a,{})})]}),Object(T.jsxs)(Ye.a.Text,{children:[Object(T.jsx)("b",{children:"Description:"})," ",Object(T.jsx)(Ye.a.Text,{type:"secondary",children:p.description})]}),Object(T.jsx)(it.a,{actionRef:c,className:t.table,defaultSize:"small",bordered:!0,request:function(){var e=Object(he.a)(u.a.mark((function e(t,r,i){var a;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,h.fetch({limit:t.pageSize,offset:(t.current-1)*t.pageSize,conditions:{project:n}});case 2:return a=e.sent,e.abrupt("return",{data:a.records.map(mt),success:!0,total:a.total});case 4:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),options:{search:!0},headerTitle:Object(T.jsx)(Ye.a.Title,{level:4,children:"Tables"}),toolBarRender:function(){return[Object(T.jsx)(F.a,{type:"primary",onClick:function(){return function(e,t){var n=(void 0===(null===t||void 0===t?void 0:t.modal)?M.a:t.modal).info({title:Object(T.jsx)("span",{style:{marginBottom:16,display:"inline-block"},children:"Upload Tables"}),bodyStyle:{margin:-8},okButtonProps:{style:{display:"none"}},maskClosable:!0,mask:!0,zIndex:null===t||void 0===t?void 0:t.zIndex,width:"calc(100% - 128px)",style:{top:64}});n.update({content:Object(T.jsx)(Ot,{project:e,destroy:n.destroy,onDone:null===t||void 0===t?void 0:t.onDone})})}(p,{modal:a,onDone:function(){var e;null===(e=c.current)||void 0===e||e.reload()}})},children:"Upload"},"upload")]},search:!1,pagination:{pageSize:500,pageSizeOptions:["10","20","50","100","200","500","1000"]},rowKey:"id",columns:f}),s]})})));function mt(e){return{id:e.id,name:e.name,description:e.description}}var wt=n(854),kt=function(){function e(){Object(c.a)(this,e),this.timer=0}return Object(l.a)(e,[{key:"exec",value:function(e){var t=this;this.timer+=1;var n=this.timer;return e().then((function(e){if(!(n<t.timer))return e}))}}]),e}(),It={selection:{width:"100%"}},St=Object(N.a)(It)(Object(Ge.a)((function(e){return Lt("propertyStore",e)}))),Ct=Object(N.a)(It)(Object(Ge.a)((function(e){return Lt("classStore",e)}))),Et=Object(N.a)(It)(Object(Ge.a)((function(e){return Lt("entityStore",e)})));function Lt(e,t){var n=Ve()[e],r=new kt;Object(U.useEffect)((function(){void 0!==t.value&&(Array.isArray(t.value)?n.refetch?n.fetchByIds(t.value.filter((function(e){return!n.records.has(e)}))):n.fetchByIds(t.value):void 0===n.get(t.value)&&n.fetchById(t.value))}),[t.value]);var i=Object(U.useMemo)((function(){var e,t=[],r=Object(s.a)(n.iter());try{for(r.s();!(e=r.n()).done;){var i=e.value;t.push({value:i.id,label:i.readableLabel})}}catch(a){r.e(a)}finally{r.f()}return t}),[n.records.size]);return Object(T.jsx)(ht.a,{mode:t.mode,allowClear:!0,options:i,optionFilterProp:"label",className:t.classes.selection,showSearch:!0,onSearch:function(e){""!==e&&r.exec((function(){return n.fetchById(e).then((function(){return 1}))}))},value:t.value,onSelect:t.onSelect,onDeselect:t.onDeselect})}var Tt=Object(N.a)({})(Object(Ge.a)((function(e){e.classes;var t=Ve().uiSettings;return Object(T.jsxs)(wt.b,{title:"Entity Settings",size:"small",column:1,children:[Object(T.jsx)(wt.b.Item,{label:"Properties (full view)",children:Object(T.jsx)(St,{mode:"multiple",value:t.entity.showedPropsInFullView,onSelect:t.entity.addShowedPropsInFullView,onDeselect:t.entity.removeShowedPropsInFullView})}),Object(T.jsx)(wt.b.Item,{label:"Properties (popover view)",children:Object(T.jsx)(St,{mode:"multiple",value:t.entity.showedPropsInPopoverView,onSelect:t.entity.addShowedPropsInPopoverView,onDeselect:t.entity.removeShowedPropsInPopoverView})})]})}))),Nt=n(859),Pt=n(860),_t=n(508),Dt=n(861),Rt=n(862),Ft=n(172),At=n(359),Bt=n(151),zt=n(222),Mt=n(504),Ut=n(143),Ht=n(242),qt={selection:{width:"100%"},class_node:{backgroundColor:Xe.f[2],"&:hover":{backgroundColor:Xe.f[8],color:"white"}},literal_node:{backgroundColor:Xe.l[2],"&:hover":{backgroundColor:Xe.l[8],color:"white"}},data_node:{backgroundColor:Xe.e[2],"&:hover":{backgroundColor:Xe.e[8],color:"white"}}},Vt=Object(N.a)(qt)(Object(Ge.a)((function(e){var t=e.sm,n=e.value,r=e.onDeselect,i=e.onSelect,a=e.classes,o=Ve().classStore,c=new kt,l=Object(U.useMemo)((function(){var e,n=[],r=Object(s.a)(o.iter());try{for(r.s();!(e=r.n()).done;){var i=e.value;n.push({type:"class",id:i.id,value:"class:".concat(i.id),label:t.graph.uriCount.nextLabel(i.uri,i.readableLabel)})}}catch(u){r.e(u)}finally{r.f()}var c,l=Object(s.a)(t.graph.nodes);try{for(l.s();!(c=l.n()).done;){var d=c.value;n.push({type:d.nodetype,id:d.id,value:"".concat(d.nodetype,":").concat(d.id),label:t.graph.uriCount.label(d),className:a[d.nodetype]})}}catch(u){l.e(u)}finally{l.f()}return n}),[o.records.size]);return Object(T.jsx)(ht.a,{allowClear:!0,options:l,optionFilterProp:"label",className:a.selection,showSearch:!0,onSearch:function(e){""!==e&&c.exec((function(){return o.fetchById(e).then((function(){return 1}))}))},value:void 0===n?void 0:"".concat(n.type,":").concat(n.id),onSelect:function(e,t){i({type:t.type,id:t.id})},onDeselect:function(e,t){r({type:t.type,id:t.id})}})}))),Wt={table:{width:"100%",textAlign:"left",borderSpacing:0,borderRadius:"2px 2px 0 0","& tr":{verticalAlign:"middle"},"& th, td":{padding:"0 4px"}},selection:{width:"100%"}},Kt=(Object(N.a)(Wt)(Object(Ge.a)((function(e){var t=e.sm,n=e.classes,r=e.value,i=e.onSelect,a=e.onDeselect,o=Object(U.useMemo)((function(){return t.graph.nodes.map((function(e){return{value:e.id,label:e.label}}))}),[t]);return Object(T.jsx)(ht.a,{showSearch:!0,allowClear:!0,options:o,optionFilterProp:"label",className:n.selection,value:r,onSelect:i,onDeselect:a})}))),Object(N.a)(Wt)(Object(Ge.a)((function(e){var t,n,r=e.sm,i=e.edge,a=(e.classes,Ve()),s=a.classStore,c=a.propertyStore,l=Object(U.useState)(void 0!==i?{type:r.graph.node(i.source).nodetype,id:i.source}:void 0),d=Object(o.a)(l,2),u=d[0],h=d[1],p=Object(U.useState)(void 0!==i?{type:r.graph.node(i.target).nodetype,id:i.target}:void 0),f=Object(o.a)(p,2),b=f[0],v=f[1],j=Object(U.useState)(null===i||void 0===i?void 0:i.uri),g=Object(o.a)(j,2),y=g[0],O=g[1],x=Object(U.useState)(!1),m=Object(o.a)(x,2),w=m[0],k=m[1],I=Object(U.useMemo)((function(){return void 0!==u&&"class"!==u.type&&(void 0!==b&&"class"!==b.type&&(r.graph.hasEdge(u.id,b.id)&&(void 0===i||u.id!==i.source||b.id!==i.target)))}),[r.graph.version,null===u||void 0===u?void 0:u.id,null===b||void 0===b?void 0:b.id]);Object(U.useEffect)((function(){void 0!==i&&void 0===c.getPropertyByURI(i.uri)&&c.fetchOne({conditions:{uri:i.uri}})}),[c,i,y]);return Object(T.jsxs)($e.a,{labelCol:{span:6},wrapperCol:{span:18},labelWrap:!0,layout:"horizontal",children:[Object(T.jsx)($e.a.Item,{label:Object(T.jsx)(Ye.a.Text,{copyable:void 0!==u?{text:u.id}:void 0,children:"Source"}),validateStatus:I?"error":void 0,help:I?"Cannot have more than one edge between two nodes":void 0,children:Object(T.jsx)(Vt,{sm:r,value:u,onSelect:h,onDeselect:function(){return h(void 0)}})}),Object(T.jsx)($e.a.Item,{label:Object(T.jsx)(Ye.a.Text,{copyable:void 0!==b?{text:b.id}:void 0,children:"Target"}),children:Object(T.jsx)(Vt,{sm:r,value:b,onSelect:v,onDeselect:function(){return v(void 0)}})}),Object(T.jsx)($e.a.Item,{label:Object(T.jsx)(Ye.a.Text,{copyable:void 0!==y?{text:null===(t=c.getPropertyByURI(y))||void 0===t?void 0:t.id}:void 0,children:"Predicate"}),children:Object(T.jsx)(St,{value:void 0!==y?null===(n=c.getPropertyByURI(y))||void 0===n?void 0:n.id:void 0,onSelect:function(e){var t;return O(null===(t=c.get(e))||void 0===t?void 0:t.uri)},onDeselect:function(e){return O(void 0)}})}),Object(T.jsx)($e.a.Item,{label:"Approximation",children:Object(T.jsx)(ut.a,{checked:w,onChange:function(e){return k(e)}})}),Object(T.jsx)($e.a.Item,{label:"\xa0",colon:!1,children:Object(T.jsxs)(R.b,{children:[Object(T.jsx)(F.a,{type:"primary",onClick:function(){if(void 0!==y&&void 0!==u&&void 0!==b&&!I){var e,t,n=c.getPropertyByURI(y);if("class"===u.type){var a=s.get(u.id);e=r.graph.nextNodeId(),r.graph.addClassNode({id:e,uri:a.uri,label:a.readableLabel,approximation:!1,nodetype:"class_node"})}else e=u.id;if("class"===b.type){var o=s.get(b.id);t=r.graph.nextNodeId(),r.graph.addClassNode({id:t,uri:o.uri,label:o.readableLabel,approximation:!1,nodetype:"class_node"})}else t=b.id;var l={source:e,target:t,uri:n.uri,approximation:w,label:n.readableLabel};void 0!==i?i.source===e&&i.target===t?r.graph.updateEdge(i.source,i.target,l):(r.graph.removeEdge(i.source,i.target),r.graph.addEdge(l)):r.graph.addEdge(l),M.a.destroyAll()}},disabled:void 0===u||void 0===b||void 0===y||!(void 0===i||(null===u||void 0===u?void 0:u.id)!==i.source||(null===b||void 0===b?void 0:b.id)!==i.target||y!==i.uri||w!==i.approximation)||I,children:"Save"}),void 0!==i?Object(T.jsx)(F.a,{type:"primary",danger:!0,onClick:function(){void 0!==i&&(r.graph.removeEdge(i.source,i.target),M.a.destroyAll())},children:"delete"}):null]})})]})})))),Yt=n(177),Jt=Object(Ge.a)((function(e){var t,n,r,i,a,s=Ve().classStore,c=Object(U.useState)(null===(t=e.node)||void 0===t?void 0:t.uri),l=Object(o.a)(c,2),d=l[0],u=l[1],h=Object(U.useState)((null===(n=e.node)||void 0===n?void 0:n.approximation)||!1),p=Object(o.a)(h,2),f=p[0],b=p[1];Object(U.useEffect)((function(){void 0!==e.node&&s.fetchIfMissingByURI(e.node.uri)}),[null===(r=e.node)||void 0===r?void 0:r.uri]);return Object(T.jsxs)(T.Fragment,{children:[Object(T.jsx)($e.a.Item,{label:Object(T.jsx)(Ye.a.Text,{copyable:void 0!==d?{text:null===(i=s.getClassByURI(d))||void 0===i?void 0:i.id}:void 0,children:"Class"}),children:Object(T.jsx)(Ct,{value:void 0!==d?null===(a=s.getClassByURI(d))||void 0===a?void 0:a.id:void 0,onSelect:function(e){var t;return u(null===(t=s.get(e))||void 0===t?void 0:t.uri)},onDeselect:function(){return u(void 0)}})}),Object(T.jsx)($e.a.Item,{label:"Approximation",children:Object(T.jsx)(ut.a,{checked:f,onChange:function(e){return b(e)}})}),Object(T.jsx)($e.a.Item,{label:"\xa0",colon:!1,children:Object(T.jsxs)(R.b,{children:[Object(T.jsx)(F.a,{type:"primary",onClick:function(){void 0!==d&&(void 0===e.node?e.sm.graph.addClassNode({id:e.sm.graph.nextNodeId(),uri:d,label:s.getClassByURI(d).readableLabel,nodetype:"class_node",approximation:f}):e.sm.graph.updateClassNode(e.node.id,{uri:d,label:s.getClassByURI(d).readableLabel,approximation:f}),e.onDone())},disabled:void 0===d||!(void 0===e.node||e.node.uri!==d||e.node.approximation!==f),children:"Save"}),void 0!==e.node?Object(T.jsx)(F.a,{type:"primary",danger:!0,onClick:function(){e.sm.graph.removeNode(e.node.id),e.onDone()},children:"delete"}):null]})})]})})),Qt=Object(Ge.a)((function(e){var t,n,r=Ve().entityStore,i=Object(U.useState)("entity-id"===(null===(t=e.node)||void 0===t||null===(n=t.value)||void 0===n?void 0:n.type)?e.node.value.id:void 0),a=Object(o.a)(i,2),s=a[0],c=a[1],l=Object(U.useState)(void 0!==e.node&&"literal_node"===e.node.nodetype&&e.node.isInContext),d=Object(o.a)(l,2),u=d[0],h=d[1],p=Object(U.useMemo)((function(){var t;return void 0!==s&&(void 0===e.node&&void 0!==e.sm.graph.nodeByEntityId(s)||void 0!==e.node&&(null===(t=e.sm.graph.nodeByEntityId(s))||void 0===t?void 0:t.id)!==e.node.id)}),[e.sm.graph.version,s]);if(void 0!==e.node&&"string"===e.node.value.type)return Object(T.jsx)("div",{children:"Not Implemented Yet"});return Object(T.jsxs)(T.Fragment,{children:[Object(T.jsx)($e.a.Item,{label:Object(T.jsx)(Ye.a.Text,{copyable:void 0!==s?{text:s}:void 0,children:"Entity"}),validateStatus:p?"error":void 0,help:p?"Entity's already in the graph":void 0,children:Object(T.jsx)(Et,{value:s,onSelect:c,onDeselect:function(){return c(void 0)}})}),Object(T.jsx)($e.a.Item,{label:"Is In Context?",children:Object(T.jsx)(ut.a,{checked:u,onChange:function(e){return h(e)}})}),Object(T.jsx)($e.a.Item,{label:"\xa0",colon:!1,children:Object(T.jsxs)(R.b,{children:[Object(T.jsx)(F.a,{type:"primary",onClick:function(){if(void 0!==s&&!p){var t=r.get(s);void 0===e.node?e.sm.graph.addLiteralNode({id:e.sm.graph.nextNodeId(),value:{type:"entity-id",id:s,uri:t.uri},label:t.readableLabel,nodetype:"literal_node",isInContext:u}):e.sm.graph.updateLiteralNode(e.node.id,{value:{type:"entity-id",id:s,uri:t.uri},label:t.readableLabel,nodetype:"literal_node",isInContext:u}),e.onDone()}},disabled:void 0===s||p||!(void 0===e.node||e.node.isInContext!==u||"entity-id"===e.node.value.type&&e.node.value.id!==s),children:"Save"}),void 0!==e.node?Object(T.jsx)(F.a,{type:"primary",danger:!0,onClick:function(){e.sm.graph.removeNode(e.node.id),e.onDone()},children:"delete"}):null]})})]})})),Gt=Object(Ge.a)((function(e){var t,n,r=e.sm,i=e.node,a=e.inedge,s=e.onDone,c=Ve(),l=c.classStore,d=c.propertyStore,u=Object(U.useState)(void 0!==a?{type:r.graph.node(a.source).nodetype,id:a.source}:void 0),h=Object(o.a)(u,2),p=h[0],f=h[1],b=Object(U.useState)(null===a||void 0===a?void 0:a.uri),v=Object(o.a)(b,2),j=v[0],g=v[1],y=Object(U.useState)(!1),O=Object(o.a)(y,2),x=O[0],m=O[1];return Object(T.jsxs)(T.Fragment,{children:[Object(T.jsx)($e.a.Item,{label:Object(T.jsx)(Ye.a.Text,{copyable:void 0!==p?{text:p.id}:void 0,children:"Source"}),children:Object(T.jsx)(Vt,{sm:r,value:p,onSelect:f,onDeselect:function(){return f(void 0)}})}),Object(T.jsx)($e.a.Item,{label:Object(T.jsx)(Ye.a.Text,{copyable:void 0!==j?{text:null===(t=d.getPropertyByURI(j))||void 0===t?void 0:t.id}:void 0,children:"Predicate"}),children:Object(T.jsx)(St,{value:void 0!==j?null===(n=d.getPropertyByURI(j))||void 0===n?void 0:n.id:void 0,onSelect:function(e){var t;return g(null===(t=d.get(e))||void 0===t?void 0:t.uri)},onDeselect:function(e){return g(void 0)}})}),Object(T.jsx)($e.a.Item,{label:"Target",children:Object(T.jsxs)(Ye.a.Text,{children:[i.label," (",i.columnIndex,")"]})}),Object(T.jsx)($e.a.Item,{label:"Approximation",children:Object(T.jsx)(ut.a,{checked:x,onChange:function(e){return m(e)}})}),Object(T.jsx)($e.a.Item,{label:"\xa0",colon:!1,children:Object(T.jsxs)(R.b,{children:[Object(T.jsx)(F.a,{type:"primary",onClick:function(){if(void 0!==p&&void 0!==j){var e,t=d.getPropertyByURI(j);if("class"===p.type){var n=l.get(p.id);e=r.graph.nextNodeId(),r.graph.addClassNode({id:e,uri:n.uri,label:n.readableLabel,approximation:!1,nodetype:"class_node"})}else e=p.id;var o={source:e,target:i.id,uri:t.uri,approximation:x,label:t.readableLabel};void 0!==a?a.source===e?r.graph.updateEdge(a.source,a.target,o):(r.graph.removeEdge(a.source,a.target),r.graph.addEdge(o)):r.graph.addEdge(o),s()}},disabled:void 0===p||void 0===j||!((null===p||void 0===p?void 0:p.id)!==(null===a||void 0===a?void 0:a.source)||j!==(null===a||void 0===a?void 0:a.uri)||x!==(null===a||void 0===a?void 0:a.approximation)),children:"Save"}),void 0!==a?Object(T.jsx)(F.a,{type:"primary",danger:!0,onClick:function(){void 0!==a&&(r.graph.removeEdge(a.source,a.target),s())},children:"delete"}):null]})})]})})),Xt=Object(N.a)({})(Object(Ge.a)((function(e){var t=e.sm,n=e.node,r=(e.classes,Object(U.useState)((null===n||void 0===n?void 0:n.nodetype)||"class_node")),i=Object(o.a)(r,2),a=i[0],s=i[1],c=function(){return M.a.destroyAll()};return void 0!==n&&"data_node"===n.nodetype&&t.graph.incomingEdges(n.id).length>1?Object(T.jsx)("p",{children:"This form can't be used for data node that has more than one incoming edge. Please click on individual edge and edit it there"}):Object(T.jsxs)($e.a,{labelCol:{span:6},wrapperCol:{span:18},labelWrap:!0,layout:"horizontal",children:[void 0===n?Object(T.jsx)($e.a.Item,{label:"Node Type",children:Object(T.jsxs)(Yt.a.Group,{value:a,onChange:function(e){return s(e.target.value)},buttonStyle:"solid",children:[Object(T.jsx)(Yt.a.Button,{value:"class_node",children:"Class Node"}),Object(T.jsx)(Yt.a.Button,{value:"literal_node",children:"Literal Node"})]})}):null,"class_node"===a?Object(T.jsx)(Jt,{sm:t,node:"class_node"===(null===n||void 0===n?void 0:n.nodetype)?n:void 0,onDone:c}):"literal_node"===a?Object(T.jsx)(Qt,{sm:t,node:"literal_node"===(null===n||void 0===n?void 0:n.nodetype)?n:void 0,onDone:c}):Object(T.jsx)(Gt,{sm:t,node:n,inedge:t.graph.incomingEdges(n.id)[0],onDone:c})]})})));function $t(e,t){var n,r;switch(e.type){case"edge":r=Object(T.jsx)(Kt,Object(fe.a)({},e)),n=void 0===e.edge?"Add Edge":"Update Edge";break;case"node":r=Object(T.jsx)(Xt,Object(fe.a)({},e)),n=void 0===e.node?"Add Node":"Update Node"}M.a.info({title:Object(T.jsx)("span",{style:{marginBottom:16,display:"inline-block"},children:n}),content:r,bodyStyle:{margin:-8},okButtonProps:{style:{display:"none"}},maskClosable:!0,mask:!0,zIndex:t,width:"calc(100% - 128px)",style:{top:64}})}var Zt=Object(Ge.a)((function(e){var t,n=e.tableRef,r=e.graphRef,i=e.table,a=e.semanticmodel;Object(Ht.a)("c",void 0===r.current?function(){}:r.current.recenter,[void 0!==r.current,a.sms[a.index].id]);var s=Object(U.useState)(!1),c=Object(o.a)(s,2),l=c[0],d=c[1],u=Ve(),h=(u.tableStore,u.semanticModelStore),p=u.assistantService,f=u.uiSettings,b=a.sms[a.index],v={saveModel:function(){we.isDraft(b)?h.create(b):b.graph.stale&&h.update(b)},addModel:function(){var e=h.getNewCreateDraftId(i),t=a.sms.length,n=ke.getDefaultDraftSemanticModel(e,h.getNewSemanticModelName(i),i);n.graph=b.graph.clone(),n.graph.id=e,h.setCreateDraft(n),a.setIndex(t)},deleteModel:function(){we.isDraft(b)?h.deleteCreateDraft(b.draftID):h.delete(b.id),a.setIndex(0),d(!1)},exportModel:function(){Cr.tableExportModel.path({tableId:i.id},{attachment:!1}).mouseClickNavigationHandler(void 0,!0)},exportData:function(){Cr.tableExportData.path({tableId:i.id},{attachment:!1}).mouseClickNavigationHandler(void 0,!0)},openAddNodeForm:function(){$t({type:"node",sm:b})},openAddEdgeForm:function(){return $t({type:"edge",sm:b})},predict:function(){p.predict(i).then((function(){var e;null===(e=n.current)||void 0===e||e.reload(),f.table.enableEntityLinkingEditor()}))}},j=Object(T.jsxs)(ne.a,{onClick:function(e){e.key.startsWith("manual-close")||d(!1)},children:[Object(T.jsxs)(ne.a.ItemGroup,{title:"Semantic Descriptions",children:[a.sms.length>1?Object(T.jsx)(ne.a.SubMenu,{title:"List models",icon:Object(T.jsx)(zt.a,{icon:At.a}),children:a.sms.map((function(e,t){return Object(T.jsxs)(ne.a.Item,{onClick:function(){return a.setIndex(t)},style:{fontWeight:t===a.index?"bold":void 0},children:[we.isDraft(e)?Object(T.jsx)(Mt.a,{color:"orange",children:"draft"}):e.graph.stale?Object(T.jsx)(Mt.a,{color:"orange",children:"unsaved"}):null,e.name]},"sm-".concat(e.name))}))},"list-model"):null,Object(T.jsx)(ne.a.Item,{disabled:!we.isDraft(b)&&!b.graph.stale,icon:Object(T.jsx)(Nt.a,{}),onClick:v.saveModel,children:"Save current model"},"save-model"),Object(T.jsx)(ne.a.Item,{onClick:v.addModel,icon:Object(T.jsx)(Pt.a,{}),children:"Add new model"},"add-model"),Object(T.jsx)(ne.a.Item,{danger:!0,icon:Object(T.jsx)(_t.a,{}),children:Object(T.jsx)(at.a,{title:"Are you sure to delete this semantic description?",onConfirm:v.deleteModel,onCancel:function(){return d(!1)},okText:"Yes",cancelText:"No",children:"Delete current model"})},"manual-close-0"),Object(T.jsx)(ne.a.Item,{disabled:!0,icon:Object(T.jsx)(Dt.a,{}),children:"Import models"},"import-model"),Object(T.jsx)(ne.a.Item,{onClick:v.exportModel,icon:Object(T.jsx)(Rt.a,{}),children:"Export models"},"export-model")]},"group-sm"),Object(T.jsx)(ne.a.Divider,{}),Object(T.jsx)(ne.a.Item,{icon:Object(T.jsx)(zt.a,{icon:At.b}),onClick:f.table.toggleEntityLinkingEditor,children:"Toggle Entity Linking Editor"},"enable-el-editor"),Object(T.jsx)(ne.a.Item,{icon:Object(T.jsx)(zt.a,{icon:Bt.c}),onClick:v.exportData,children:"Export data"},"export-data")]});return Object(T.jsxs)(T.Fragment,{children:[Object(T.jsxs)(R.b,{style:{float:"right"},children:[void 0===r.current?null:Object(T.jsxs)(Mt.a,{color:we.isDraft(b)||b.graph.stale?"orange":"green",style:{marginRight:0,cursor:"pointer"},onClick:v.saveModel,children:["Status:"," ",we.isDraft(b)?"Draft":b.graph.stale?"Changed":"Saved",a.sms.length>1?" (".concat(b.name,")"):""]}),f.table.showEntityLinkingEditor?Object(T.jsx)(Mt.a,{color:"geekblue",style:{marginRight:0,cursor:"pointer"},onClick:f.table.toggleEntityLinkingEditor,children:"Editing Entity Linking"}):null]},"space-1"),Object(T.jsxs)(R.b,{children:[Object(T.jsx)(F.a,{size:"small",onClick:null===(t=r.current)||void 0===t?void 0:t.recenter,children:"Center graph (C)"}),Object(T.jsx)(F.a,{size:"small",onClick:v.openAddNodeForm,children:"Add node"}),Object(T.jsx)(F.a,{size:"small",onClick:v.openAddEdgeForm,children:"Add edge"}),Object(T.jsx)(F.a,{size:"small",onClick:v.predict,children:"Predict"}),Object(T.jsx)(Ut.a,{overlay:j,onVisibleChange:d,visible:l,children:Object(T.jsxs)(F.a,{size:"small",children:["More ",Object(T.jsx)(Ft.a,{})]})})]},"space-2")]})})),en=n(857),tn=n(863),nn=n(495),rn=n.n(nn),an=n(496),on=n.n(an),sn=n(55),cn=n(12),ln=n(176);function dn(e,t,n,r){var i=r.xoffset,a=r.yoffset,o=r.cfg,s=r.stroke;return i=void 0===i?0:i,a=void 0===a?0:a,void 0!==s&&n.map((function(n){var r=n.text,c=n.x,l=n.y;e.addShape("text",{attrs:Object(fe.a)(Object(fe.a)({text:r,x:c+i,y:l+a,fontFamily:t.fontFamily},o),{},{fill:s.color,stroke:s.color,lineWidth:s.width}),name:"bg-text",draggable:!0})})),n.map((function(n){var r=n.text,s=n.x,c=n.y;return e.addShape("text",{attrs:Object(fe.a)({text:r,fill:"black",x:s+i,y:c+a,fontFamily:t.fontFamily},o),name:"text",draggable:!0})}))}function un(e){var t=e.getApproximateWidth(4);return ln.a.registerNode("circle-wrap",{draw:function(n,r){return function(n,r){n.style.padding;var i,a,o=(null===(i=n.labelCfg)||void 0===i?void 0:i.offset)||0,s=e.wrapText(n.label,t,"center"),c=s.units,l=s.width,d=r.addShape("circle",{attrs:Object(fe.a)({r:10},n.style),name:"circle"});return dn(r,e,c,{xoffset:-l/2,yoffset:10+o,cfg:null===n||void 0===n||null===(a=n.labelCfg)||void 0===a?void 0:a.style,stroke:{color:"white",width:4}}),d}(n,r)}},"single-node"),e}var hn=n(493),pn=n.n(hn),fn=n(494),bn=n.n(fn),vn=function(e,t){return function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];var a=r.join(":");return void 0===t[a]&&(t[a]=e.apply(void 0,r)),t[a]}},jn=Object(l.a)((function e(t){var n=this;Object(c.a)(this,e),this.paragraph=void 0,this.getDesiredLineLength=void 0,this.cacheLineLengths={},this.cacheLineDemerits={},this.cacheParagraphDemerits={},this.cacheParagraphBreakpoints={},this.optimize=function(){return n.optimizeParagraph(0,n.paragraph.length-1,0)},this.optimizeParagraph=vn((function(e,t,r){var i=n.computeLineAdjustment(e,t,r);if(void 0!==i&&i>=0)return{breakpoints:[],demerits:n.computeLineDemerits(e,t,r)};for(var a={caret:-1,demerits:1/0,breakpoints:[]},o=t-1;o>e;o--)if("box"!==n.paragraph[o].type){var s=n.optimizeParagraph(e,o,r),c=n.optimizeParagraph(o+1,t,r+(s.breakpoints.length>0?s.breakpoints.length+1:0));s.demerits+c.demerits<a.demerits&&(a.caret=o,a.demerits=s.demerits+c.demerits,a.breakpoints=s.breakpoints.slice(),a.breakpoints.push(o),a.breakpoints=a.breakpoints.concat(c.breakpoints))}return{breakpoints:a.breakpoints,demerits:a.demerits}}),this.cacheParagraphBreakpoints),this.computeLineLength=vn((function(e,t){for(var r=0,i=e;i<t;i++)"penalty"!==n.paragraph[i].type&&(r+=n.paragraph[i].width);return"penalty"===n.paragraph[t].type&&(r+=n.paragraph[t].width),r}),this.cacheLineLengths),this.computeLineElastic=function(e,t){for(var r=0,i=0,a=e;a<=t;a++){var o=n.paragraph[a];"glue"===o.type&&(r+=o.stretch,i+=o.shrink)}return{stretchability:r,shrinkability:i}},this.computeLineAdjustment=function(e,t,r){var i=n.computeLineLength(e,t),a=n.getDesiredLineLength(r);if(i===a)return 0;var o=n.computeLineElastic(e,t);if(i<a){if(o.stretchability<0)return;return 0===o.stretchability?(a-i)/.1:(a-i)/o.stretchability}return o.shrinkability<=0?void 0:(a-i)/o.shrinkability},this.computeLineBadness=function(e,t,r){var i=n.computeLineAdjustment(e,t,r);return void 0===i||i<-1?-1/0:Math.pow(i,3)},this.computeLineDemerits=vn((function(e,t,r){var i=n.paragraph[t],a="penalty"===i.type?i.cost:0,o=n.computeLineBadness(e,t,r);return a>=0?Math.pow(1+o+a,2)+0:a===-1/0?Math.pow(1+o,2)+0:Math.pow(1+o,2)-Math.pow(a,2)+0}),this.cacheLineDemerits),this.computeParagraphDemerits=function(e,t,r,i){for(var a=e,o=0,s=0;s<r.length;s++)o+=n.computeLineDemerits(a,r[s],i+s),a=r[s]+1;return o+=n.computeLineDemerits(a,t,i+(r.length>0?r.length+1:0))},this.paragraph=t.units.map((function(e){return(e=Object.assign({},e)).width=e.width/16,"glue"===e.type&&(e.stretch=e.stretch/16,e.shrink=e.shrink/16),e})),this.getDesiredLineLength=function(e){return t.getLineLength(e)/16}})),gn=function(){function e(t,n){var r=this;Object(c.a)(this,e),this.spaceWidth=void 0,this.units=void 0,this.lineLengths=void 0,this.getLineLength=void 0,this.groupByLine=function(e){var t=[],n=0;(e=e.slice()).push(r.units.length-1);var i,a=Object(s.a)(e);try{for(a.s();!(i=a.n()).done;){var o,c=i.value,l=r.units.slice(n,c),d=[],u=Object(s.a)(l);try{for(u.s();!(o=u.n()).done;){var h=o.value;"penalty"!==h.type&&("box"===h.type&&d.length>0&&"box"===d[d.length-1].type?(d[d.length-1].text+=h.text,d[d.length-1].width+=h.width):d.push(Object.assign({},h)))}}catch(p){u.e(p)}finally{u.f()}"penalty"===r.units[c].type&&r.units[c].text.length>0&&d.push(r.units[c]),n=c+1,t.push(d)}}catch(p){a.e(p)}finally{a.f()}return t},this.layout=function(e,t){var n=t.lineHeight,i=t.cssLineHeight,a=t.fontSize,o=t.align,c=(t.verticalAlign,t.autoLength),l=[],d=e.map((function(e){return e.reduce((function(e,t){return e+t.width}),0)})),u=e.map((function(e,t){return r.getLineLength(t)}));if(c)for(var h=Math.max.apply(Math,Object(cn.a)(d)),p=0;p<u.length;p++)u[p]>h&&(u[p]=h);for(var f=0;f<e.length;f++){var b=e[f],v=d[f],j=u[f],g=b.filter((function(e){return"glue"===e.type})).length,y=v<j&&"justify"!==o?r.spaceWidth:Math.abs(j-v)/g+r.spaceWidth,O=(f+1)*n-a*(i-1)/2,x=0;if("center"===o?x+=(j-v)/2:"right"===o&&(x+=j-v),y===r.spaceWidth){var m=Object.assign({x:x,y:O,renderedWidth:v,lineNumber:f},b[0]);m.text=b.map((function(e){return e.text})).join(""),l.push(m)}else{var w,k=Object(s.a)(b);try{for(k.s();!(w=k.n()).done;){var I=w.value,S="glue"===I.type?y:I.width,C=Object.assign({x:x,y:O,renderedWidth:S,lineNumber:f},I);x+=S,l.push(C)}}catch(E){k.e(E)}finally{k.f()}}}return{units:l,lineLengths:d}},this.units=t,this.lineLengths=n,Array.isArray(n)?this.getLineLength=function(e){return e<n.length?n[e]:n[n.length-1]}:this.getLineLength=function(e){return n},this.spaceWidth=0;var i,a=Object(s.a)(t);try{for(a.s();!(i=a.n()).done;){var o=i.value;if("glue"===o.type){this.spaceWidth=o.width;break}}}catch(l){a.e(l)}finally{a.f()}}return Object(l.a)(e,null,[{key:"getUnitsFromText",value:function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:1e3,a=[],o=e.split(/(\s+)/).filter((function(e){return e.length>0}));if(void 0!==r&&r.length>0){var s=new RegExp(".*?[".concat(r.join(""),"]|.+"),"g");o=o.flatMap((function(e){return e.match(s)}))}var c=t(" "),l=t("-"),d=function(e){return/\s/.test(e.charAt(0))},u=c/2,h=c/3;return o.forEach((function(e){if(d(e)){var r={type:"glue",width:c,shrink:h,stretch:u,text:e};a.push(r)}else if(a.length>0&&"box"===a[a.length-1].type&&a.push({type:"penalty",width:0,cost:1,flagged:!1,text:""}),n){var o=n(e);o.forEach((function(e,n){var r={type:"box",width:t(e),text:e};if(a.push(r),n<o.length-1){var s={type:"penalty",text:"-",width:l,cost:i,flagged:!0};a.push(s)}}))}else{var s={type:"box",width:t(e),text:e};a.push(s)}})),a.push({type:"glue",width:0,stretch:1e4,shrink:0,text:""}),a}}]),e}(),yn=Object(l.a)((function e(t,n){var r=this;Object(c.a)(this,e),this.measureCtx=void 0,this.circleLayout=void 0,this.hypher=void 0,this.font=void 0,this.fontFamily=void 0,this.fontSize=void 0,this.cssLineHeight=1.428,this.lineHeight=void 0,this.spaceWidth=void 0,this.separable=["{","}",":",",","'",'"',".","/"],this.wrapText=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"justify",i=new gn(gn.getUnitsFromText(e,r.measureText,r.hyphenate,r.separable),t),a=new jn(i).optimize().breakpoints,o=i.layout(i.groupByLine(a),{align:n,cssLineHeight:r.cssLineHeight,fontSize:r.fontSize,lineHeight:r.lineHeight,verticalAlign:"middle",autoLength:!0}),s=o.units,c=o.lineLengths,l=Math.max.apply(Math,Object(cn.a)(c)),d=(a.length+1)*r.lineHeight;return{units:s,width:l,height:d}},this.wrapTextCircle=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,a=r.circleLayout.findRadius(r.measureText(e),n,i)+12,o=r.circleLayout.getLayout(a),c=o.lines,l=r.wrapText(e,c.slice(0,3),"center"),d=l.units,u=l.width,h=Math.max.apply(Math,Object(cn.a)(d.map((function(e){return e.lineNumber}))))+1,p=-(a=u/2),f=-(h%2===1?(h-1)/2:h/2)*r.lineHeight-r.lineHeight/2,b=Object(s.a)(d);try{for(b.s();!(t=b.n()).done;){var v=t.value;v.x+=p,v.y+=f}}catch(j){b.e(j)}finally{b.f()}return{units:d,radius:a}},this.hyphenate=function(e){return e.length>4?r.hypher.hyphenate(e):[e]},this.getApproximateWidth=function(e){return e*r.measureText("abcij ")},this.measureText=function(e){return r.measureCtx.measureText(e).width};var i=document.createElement("canvas");this.measureCtx=i.getContext("2d"),this.spaceWidth=this.measureText(" "),this.font=t.font||"".concat(t.fontSize,"px ").concat(t.fontFamily),this.fontFamily=t.fontFamily,this.fontSize=t.fontSize,this.measureCtx.font=this.font,this.hypher=new bn.a(pn.a),void 0!==n&&(void 0!==n.lineHeight&&(this.cssLineHeight=n.lineHeight),void 0!==n.separable&&(this.separable=n.separable)),this.lineHeight=this.fontSize*this.cssLineHeight,this.circleLayout=new On(this)}));yn.getCssFont=function(e){var t=getComputedStyle(e),n=t.fontStyle,r=t.fontVariant,i=t.fontWeight,a=t.fontSize,o=t.fontFamily;return{font:"".concat(n," ").concat(r," ").concat(i," ").concat(a," ").concat(o),fontSize:parseFloat(a),fontFamily:o}};var On=Object(l.a)((function e(t){var n=this;Object(c.a)(this,e),this.lineBreak=void 0,this.lineHeight=void 0,this.radius2layout=void 0,this.findRadius=function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,i=0,a=t,o=void 0,s=0;s<t;s++){if(a-i===1){o=a;break}var c=Math.ceil((i+a)/2),l=n.getLayout(c).totalLength;if(l<e)i=c;else{if(!(l-e>r)){o=c;break}a=c}}if(void 0===o)throw new Error("The text of ".concat(e," is too long to render in a circle that has the maximum radius: ").concat(t," - ").concat(n.getLayout(t).totalLength));return o},this.getLayout=function(e){if(void 0===n.radius2layout[e]){for(var t=n.computeHalfNumberOfLines(e),r=[],i=[],a=t;a>0;a--)r.push(n.computeLineLength(a,e)),i.push(e-n.lineHeight*(a+.5));r.push(n.computeCentralLineLength(e)),i.push(e-n.lineHeight/2);for(var o=t-1;o>=0;o--)r.push(r[o]),i.push(e+n.lineHeight*(o-.5));n.radius2layout[e]={lines:r,linesY:i,centralLine:r[t],totalLength:r.reduce((function(e,t){return e+t}))}}return n.radius2layout[e]},this.computeHalfNumberOfLines=function(e){return Math.floor((e-n.lineHeight/2)/n.lineHeight)},this.computeLineLength=function(e,t){return 2*Math.sqrt(Math.pow(t,2)-Math.pow(n.lineHeight*e,2))},this.computeCentralLineLength=function(e){return 2*Math.sqrt(Math.pow(e,2)-Math.pow(n.lineHeight/2,2))},this.lineBreak=t,this.lineHeight=t.lineHeight,this.radius2layout={}})),xn=function(){function e(t,n){var r=this;Object(c.a)(this,e),this.version=void 0,this.container=void 0,this.graph=void 0,this.data=void 0,this.props=void 0,this.wordwrap=void 0,this.hotswapProps=function(e){return!!st.a.isEqual(r.props.layout,e.layout)&&(r.props.enableActivateRelations===e.enableActivateRelations&&(r.props=e,!0))},this.destroy=function(){r.graph.destroy()},this.fitCenter=function(){r.graph.fitCenter()},this.setDataAndRender=function(e,t){r.version>0&&r.graph.clear(),r.data=e,r.graph.data({nodes:e.nodes,edges:e.edges}),r.graph.render(),r.version+=1,void 0!==t&&t()},this.updateLayout=function(e){r.graph.updateLayout(e),r.graph.layout()},this.updateContainerSize=function(e){var t=e.center,n=e.height,i=r.graph.get("group");i.resetMatrix();var a=i.getCanvasBBox();if(0!==a.width&&0!==a.height){var o,s=r.container.clientWidth;switch(n.type){case"fit-graph":o=a.height+n.extraHeight;break;case"fit-remaining-window":var c=r.container.getBoundingClientRect().top,l=window.scrollY;o=document.documentElement.clientHeight-(c+l)-n.offsetHeight;break;case"keep-as-is":o=r.props.initHeight}r.graph.changeSize(s,o),!0===t?r.graph.moveTo(s/2-a.width/2,o/2-a.height/2):r.graph.moveTo(r.props.leftOffset||0,r.props.topOffset||0)}return a},this.untilLayoutStable=function(e,t,n,i,a,o,s){if(e<=0)return n.apply(void 0,Object(cn.a)(i)),void(void 0!==a&&a());var c=r.graph.get("group").getCanvasBBox();if(o=o||10,void 0!==s){if(Math.abs(s.width-c.width)<o&&Math.abs(s.height-c.height)<o)return void setTimeout((function(){var s=r.graph.get("group").getCanvasBBox();Math.abs(c.width-s.width)>=o||Math.abs(c.height-s.height)>=o?r.untilLayoutStable(e-1,t,n,i,a,o,s):(n.apply(void 0,Object(cn.a)(i)),void 0!==a&&a())}),t);setTimeout((function(){r.untilLayoutStable(e-1,t,n,i,a,o,c)}),t)}else setTimeout((function(){r.untilLayoutStable(e,t,n,i,a,o,c)}),t)},this.version=0,this.props=n,this.container=t,this.data={nodes:[],edges:[]};this.wordwrap=new yn({fontFamily:"-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, 'Noto Sans', sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji'",fontSize:12}),function(e){var t=e.getApproximateWidth(4),n=function(n,r){var i,a=n.style.paddingWidth||0,o=n.style.paddingHeight||0,s=e.wrapText(n.label,n.size||t,"center"),c=s.units,l=s.width,d=s.height,u=r.addShape("rect",{attrs:Object(fe.a)({width:l+2*a,height:d+2*o},n.style),name:"rect"});return dn(r,e,c,{xoffset:a,yoffset:o,cfg:null===(i=n.labelCfg)||void 0===i?void 0:i.style}),u};ln.a.registerNode("rect-wrap",{draw:function(e,t){return n(e,t)},setState:function(e,t,r){for(var i,a=r._cfg,c=a.model,l=a.states,d={},u=Object(fe.a)({},null===(i=c.labelCfg)||void 0===i?void 0:i.style),h=0,p=Object.entries(c.style);h<p.length;h++){var f=Object(o.a)(p[h],2),b=f[0],v=f[1];"object"!==typeof v&&(d[b]=v)}var j,g=Object(s.a)(l);try{for(g.s();!(j=g.n()).done;)for(var y=j.value,O=0,x=Object.entries(a.styles[y]);O<x.length;O++){var m=Object(o.a)(x[O],2),w=m[0],k=m[1];"label"===w?Object.assign(u,k):d[w]=k}}catch(S){g.e(S)}finally{g.f()}var I=a.group;I.clear(),n({label:c.label,size:c.size,style:d,labelCfg:{style:u}},I)}},"single-node")}(this.wordwrap),un(this.wordwrap);var i=["drag-canvas","drag-node"];n.enableActivateRelations&&i.push({type:"activate-relations",resetSelected:!0}),this.graph=new ln.a.Graph({container:t,width:t.scrollWidth,height:n.initHeight,layout:n.layout||{type:"force",preventOverlap:!0,linkDistance:50,nodeSpacing:50},defaultEdge:{type:"quadratic",style:{stroke:"black",endArrow:{fill:"black",path:ln.a.Arrow.triangle(6,8)}},labelCfg:{style:{fill:"black",background:{fill:"#ffffff",stroke:"#9EC9FF",padding:[2,2,2,2],radius:2}}}},modes:{default:i,edit:["click-select"]},nodeStateStyles:{active:{opacity:1,label:{opacity:1}},inactive:{opacity:.2,label:{opacity:.2}}},edgeStateStyles:{active:{stroke:"black",opacity:1},inactive:{opacity:.2,text:{opacity:.2}}}}),void 0!==n.onNodeClick&&this.graph.on("node:click",(function(e){r.props.onNodeClick(e.item._cfg.model.id)})),void 0!==n.onEdgeClick&&this.graph.on("edge:click",(function(e){r.props.onEdgeClick(e.item._cfg.model)}))}return Object(l.a)(e,null,[{key:"transformData",value:function(e,t){var n=e.map((function(e,t){var n;n=e.label.trim().length>0&&("rect"===e.shape||"circle"===e.shape)?e.shape+"-wrap":e.shape;var r={id:e.id,label:e.label,type:n,style:Object(fe.a)(Object(fe.a)({},e.style),{},{radius:4,paddingHeight:2,paddingWidth:4}),labelCfg:{style:e.labelStyle}};return"rect"===e.shape&&(r.style.radius=4),r}));st.a.uniq(t.map((function(e){return e.id}))).length!==t.length&&console.error("Edges must have unique ids. However, we get:",t.map((function(e){return e.id})));var r,i=t.map((function(e){return{id:e.id,source:e.source,target:e.target,label:e.label}})),a=new Set,o=!1,c=Object(s.a)(t);try{for(c.s();!(r=c.n()).done;){var l=r.value,d="".concat(l.source,"-").concat(l.target);if(a.has(d)){o=!0;break}a.add(d)}}catch(u){c.e(u)}finally{c.f()}return o&&ln.a.Util.processParallelEdges(i),{nodes:n,edges:i}}}]),e}(),mn={hide:{display:"none"},graph:{position:"relative",width:"100%"},toolbar:{position:"absolute",top:8,left:8,"& button.text":{borderRadius:4,paddingLeft:8,paddingRight:8},"& button.icon":{borderRadius:4,padding:4,"& svg":{fontSize:22}}},bordered:{border:"1px solid #bbb",borderRadius:4},container:{width:"100%","& canvas":{display:"block"}}},wn={Force:{type:"force",preventOverlap:!0,linkDistance:50,nodeSpacing:50},Dagre:{type:"dagre",rankdir:"TB",nodesep:70,ranksep:30}},kn=Object(N.a)(mn)(Object(U.forwardRef)((function(e,t){var n=e.id,r=e.version,i=e.nodes,a=e.edges,o=e.classes,s=e.props,c=e.className,l=e.renderingAdjustedHeight,d=void 0===l?{type:"fit-graph",extraHeight:8}:l,u=e.toolbar,h=void 0!==u&&u,p=e.bordered,f=void 0===p||p,b=e.layouts,v=void 0===b?wn:b,j=Object(U.useRef)(null),g=Object(U.useRef)(void 0);Object(U.useImperativeHandle)(t,(function(){return{graph:function(){return g.current},recenter:function(){return void 0!==g.current&&(g.current.updateContainerSize({center:!0,height:d}),!0)}}})),Object(U.useEffect)((function(){if(null!==j.current){void 0===g.current&&(g.current=new xn(j.current,s||{initHeight:500}));var e=g.current;if(void 0!==s)e.hotswapProps(s)||(e.destroy(),g.current=new xn(j.current,s||{initHeight:500}),e=g.current);e.setDataAndRender(xn.transformData(i,a),(function(){window.g=e,e.untilLayoutStable(20,50,e.updateContainerSize,[{center:!0,height:d}],(function(){}))}))}}),[n,r,i,a,s,d]);var y=!1===h?null:Object(T.jsx)(In,{autoHide:"auto-hide"===h,graph:g,layouts:v});return Object(T.jsxs)("div",{className:c,children:[Object(T.jsx)("div",{className:o.hide,children:r}),Object(T.jsxs)("div",{className:o.graph,children:[y,Object(T.jsx)("div",{ref:j,className:o.container+(f?" "+o.bordered:"")})]})]})}))),In=Object(N.a)(mn)((function(e){var t=e.autoHide,n=void 0!==t&&t,r=e.graph,i=e.classes,a=e.layouts,s=Object(U.useState)(!1),c=Object(o.a)(s,2),l=c[0],d=c[1],u=Object(U.useState)("Force"),h=Object(o.a)(u,2),p=h[0],f=h[1],b=function(){n&&d(!0)},v=function(){n&&d(!1)};if(n&&!l)return Object(T.jsx)("div",{className:i.toolbar,onMouseEnter:b,onMouseLeave:v,children:Object(T.jsx)(F.a,{className:"icon",children:Object(T.jsx)(rn.a,{})})});var j=function(){var e;null===(e=r.current)||void 0===e||e.graph.fitCenter()},g=function(e){var t,n;f(e),null===(t=r.current)||void 0===t||t.updateLayout(a[e]),null===(n=r.current)||void 0===n||n.untilLayoutStable(20,50,j,[],(function(){}))};return Object(T.jsx)("div",{className:i.toolbar,onMouseEnter:b,onMouseLeave:v,children:Object(T.jsxs)(R.b,{size:4,align:"start",children:[Object(T.jsx)(sn.a,{title:"Center the graph",children:Object(T.jsx)(F.a,{className:"icon",onClick:j,children:Object(T.jsx)(on.a,{})})}),Object(T.jsx)(sn.a,{title:"Make the graph full screen",children:Object(T.jsx)(F.a,{className:"icon",children:Object(T.jsx)(en.a,{})})}),Object(T.jsx)(sn.a,{title:"Change graph layout",children:Object(T.jsx)(Ut.a,{overlay:Object(T.jsx)(ne.a,{onClick:function(e){g(e.key)},children:Object.keys(wn).map((function(e){return Object(T.jsx)(ne.a.Item,{children:e},e)}))}),children:Object(T.jsxs)(F.a,{className:"text",icon:Object(T.jsx)(tn.a,{}),onClick:function(){"Force"===p&&g("Dagre"),"Dagre"===p&&g("Force")},children:[p," ",Object(T.jsx)(Ft.a,{})]})})})]})})})),Sn={hide:{display:"none"},graphContainer:{},draft:{border:"1px dashed ".concat(Xe.o[7]," !important"),"&:hover":{color:"".concat(Xe.e[5]," !important")}},selectedDraft:{backgroundColor:"".concat(Xe.e[5]," !important")}},Cn=Object(N.a)(Sn)(Object(Ge.a)(Object(U.forwardRef)((function(e,t){var n=e.classes,r=(e.table,e.sm),i=Object(U.useRef)(void 0);Object(U.useImperativeHandle)(t,(function(){return{recenter:function(){var e;return(null===(e=i.current)||void 0===e?void 0:e.recenter())||!1}}}));var a=Object(U.useMemo)((function(){return[r.graph.nodes.map((function(e){var t,n;switch(e.nodetype){case"class_node":t="circle",n={fill:Xe.f[2],stroke:Xe.f[8]};break;case"data_node":t="rect",n={fill:Xe.e[3],stroke:Xe.e[8]};break;case"literal_node":t="entity-id"===e.value.type?"circle":"rect",n=e.isInContext?{fill:"#C6E5FF",stroke:"#5B8FF9"}:{fill:Xe.l[2],stroke:"#c41d7f"};break;default:throw new Error("Unreachable!")}return{id:e.id,label:En(r,e),style:n,shape:t}})),r.graph.edges.map((function(e){return{id:"".concat(e.source,"-").concat(e.target,"-").concat(e.uri),source:e.source,target:e.target,label:e.label}}))]}),[we.isDraft(r)?r.draftID:null,r.id,r.graph.version]),s=Object(o.a)(a,2),c=s[0],l=s[1];return Object(T.jsx)(kn,{ref:i,className:n.graphContainer,id:r.id,version:r.graph.version,nodes:c,edges:l,toolbar:!1,renderingAdjustedHeight:{type:"fit-graph",extraHeight:20},props:{initHeight:300,layout:{type:"dagre",rankdir:"TB",nodesep:50,ranksep:15},onNodeClick:function(e){$t({type:"node",sm:r,node:r.graph.node(e)})},onEdgeClick:function(e){$t({type:"edge",sm:r,edge:r.graph.edge(e.source,e.target)})}}})})))),En=function(e,t){switch(t.nodetype){case"data_node":case"literal_node":return t.label;case"class_node":return e.graph.uriCount.label(t)}},Ln=n(215),Tn=n(13),Nn=["entity","nolink","onCtrlClick"],Pn=function(e){var t=e.entity,n=e.nolink,r=void 0!==n&&n,i=e.onCtrlClick,a=Object(Tn.a)(e,Nn);return r?Object(T.jsx)("span",Object(fe.a)(Object(fe.a)({},a),{},{children:t.readableLabel})):Object(T.jsx)($,Object(fe.a)(Object(fe.a)({href:t.uri,openInNewPage:!0,onCtrlClick:i},a),{},{children:t.readableLabel}))},_n=n(497),Dn=n.n(_n),Rn=n(142);function Fn(e){var t=Object(U.useMemo)((function(){for(var t=new Set,n=0,r=Object.entries(e.properties);n<r.length;n++){var i=Object(o.a)(r[n],2),a=i[0],c=i[1];t.add(a);var l,d=Object(s.a)(c);try{for(d.s();!(l=d.n()).done;)for(var u=l.value,h=0,p=Object.keys(u.qualifiers);h<p.length;h++){var f=p[h];t.add(f)}}catch(b){d.e(b)}finally{d.f()}}return Array.from(t)}),[e.id]),n=Ve().propertyStore;return Object(U.useEffect)((function(){n.batch.fetchByIds(t)}),[e.id]),Object.fromEntries(t.map((function(e){var t=n.get(e);return t?[e,t]:[e,{id:e,doesNotExist:null===t}]})))}var An=Object(Ge.a)((function(e){var t=e.entityId,n=e.render,r=e.renderLoading,i=e.renderNotFound,a=e.forceWaiting,o=void 0!==a&&a,s=Ve(),c=s.entityStore,l=s.uiSettings;Object(U.useEffect)((function(){c.batch.fetchById(t)}),[c,t]);var d=c.get(t);return void 0===d?o?void 0!==r?r():Object(T.jsx)(_,{}):Object(T.jsx)("span",{children:t}):null===d?void 0!==i?i():Object(T.jsx)(D.a,{status:"404",title:"404",subTitle:"Entity ".concat(t," does not exist")}):n(d,l.entity)})),Bn=["property","nolink","showId"],zn=function(e){var t=e.property,n=e.nolink,r=void 0!==n&&n,i=e.showId,a=void 0!==i&&i,o=Object(Tn.a)(e,Bn);if(void 0!==t.doesNotExist)return t.doesNotExist?Object(T.jsx)("span",Object(fe.a)(Object(fe.a)({},o),{},{children:Object(T.jsxs)("i",{children:["Property ",t.id," doesn't exist"]})})):r?Object(T.jsxs)("span",Object(fe.a)(Object(fe.a)({},o),{},{children:["(",t.id,")"]})):Object(T.jsxs)($,Object(fe.a)(Object(fe.a)({href:"",openInNewPage:!0},o),{},{children:["(",t.id,")"]}));if(r)return Object(T.jsxs)("span",Object(fe.a)(Object(fe.a)({},o),{},{children:[t.label," (",t.id,")"]}));var s=a?"".concat(t.label," (").concat(t.id,")"):t.label;return Object(T.jsx)($,Object(fe.a)(Object(fe.a)({href:t.uri,openInNewPage:!0},o),{},{children:s}))},Mn=n(505),Un=n(216),Hn=Object(N.a)({hide:{display:"none"}})((function(e){var t=Object(U.useState)(!1),n=Object(o.a)(t,2),r=n[0],i=n[1],a=function(){i(!r)},s=r?Object(T.jsx)(Mn.a,{onClick:a}):Object(T.jsx)(Un.a,{onClick:a});return Object(T.jsxs)("div",{children:[Object(T.jsxs)(R.b,{size:4,children:[e.children,s]}),Object(T.jsx)("div",{className:r?"":e.classes.hide,children:e.collapsible})]})})),qn=Object(N.a)({})((function(e){var t=e.value;return"entityid"===t.type?Object(T.jsx)(An,{entityId:t.value,render:function(e){return Object(T.jsx)(Pn,{entity:e})}}):"time"===t.type?Object(T.jsx)(Hn,{collapsible:Object(T.jsxs)("ul",{children:[Object(T.jsxs)("li",{children:[Object(T.jsx)("b",{children:"Timezone:"})," ",t.value.timezone]}),Object(T.jsxs)("li",{children:[Object(T.jsx)("b",{children:"From:"})," ",t.value.before," - ",t.value.after]}),Object(T.jsxs)("li",{children:[Object(T.jsx)("b",{children:"Precision:"})," ",t.value.precision]}),Object(T.jsxs)("li",{children:[Object(T.jsx)("b",{children:"Calendar Model:"})," ",Object(T.jsx)($,{href:t.value.calendarmodel,openInNewPage:!0,children:t.value.calendarmodel})]})]}),children:t.value.time}):"quantity"===t.type?Object(T.jsx)(Hn,{collapsible:Object(T.jsxs)("ul",{children:[Object(T.jsxs)("li",{children:[Object(T.jsx)("b",{children:"Bound:"})," ",t.value.lowerBound," -"," ",t.value.upperBound]}),Object(T.jsxs)("li",{children:[Object(T.jsx)("b",{children:"Unit:"})," ",t.value.unit]})]}),children:t.value.amount}):"monolingualtext"===t.type?Object(T.jsxs)("span",{children:[t.value.text," ",Object(T.jsxs)("i",{children:["@",t.value.language]})]}):"globecoordinate"===t.type?Object(T.jsx)(Hn,{collapsible:Object(T.jsxs)("ul",{children:[Object(T.jsxs)("li",{children:[Object(T.jsx)("b",{children:"Precision:"})," ",t.value.precision]}),Object(T.jsxs)("li",{children:[Object(T.jsx)("b",{children:"Globe:"})," ",Object(T.jsx)($,{href:t.value.globe,openInNewPage:!0,children:t.value.globe})]})]}),children:Object(T.jsxs)($,{href:"http://maps.google.com/maps?q=".concat(t.value.latitude,",").concat(t.value.longitude),openInNewPage:!0,children:[t.value.latitude," N,",t.value.longitude," W"]})}):"object"===typeof t.value?Object(T.jsx)("span",{children:JSON.stringify(t.value)}):Object(T.jsx)("span",{children:t.value})})),Vn=["stmt","classes","id2prop"],Wn=Object(N.a)({qualifiers:{marginLeft:24}})((function(e){var t,n=e.stmt,r=e.classes,i=e.id2prop,a=Object(Tn.a)(e,Vn),o=[],c=Object(s.a)(n.qualifiersOrder);try{for(c.s();!(t=c.n()).done;){var l=t.value,d=void 0;d=0===n.qualifiers[l].length?Object(T.jsx)(Ye.a.Text,{type:"secondary",italic:!0,children:"no value"}):n.qualifiers[l].map((function(e,t){return Object(T.jsx)("div",{children:Object(T.jsx)(qn,{value:e})},t)})),o.push(Object(T.jsxs)(We.a,{gutter:8,children:[Object(T.jsx)(Ke.a,{span:6,children:Object(T.jsx)(zn,{property:i[l]})}),Object(T.jsx)(Ke.a,{span:18,children:d})]},l))}}catch(u){c.e(u)}finally{c.f()}return Object(T.jsxs)("div",Object(fe.a)(Object(fe.a)({},a),{},{children:[Object(T.jsx)("div",{children:Object(T.jsx)(qn,{value:n.value})}),Object(T.jsx)("div",{className:r.qualifiers,children:o})]}))})),Kn=Object(N.a)({propDivider:{height:1,border:"none",color:"#ddd",backgroundColor:"#ddd"}})(Object(Ge.a)((function(e){var t=e.entity,n=e.id2prop,r=e.filteredProps,i=e.showId,a=void 0!==i&&i,o=e.classes;0===r.length&&(r=Object.keys(t.properties));var c,l=[],d=Object(s.a)(r);try{for(d.s();!(c=d.n()).done;){var u=c.value;if(void 0!==t.properties[u]){var h=t.properties[u];l.length>0&&l.push(Object(T.jsx)("hr",{className:o.propDivider},"divider-".concat(u))),l.push(Object(T.jsxs)(We.a,{gutter:8,children:[Object(T.jsx)(Ke.a,{span:6,children:Object(T.jsx)(Ye.a.Text,{strong:!0,children:Object(T.jsx)(zn,{property:n[u],showId:a})})}),Object(T.jsx)(Ke.a,{span:18,children:Object(T.jsx)(R.b,{direction:"vertical",style:{width:"100%"},children:h.map((function(e,t){return Object(T.jsx)(Wn,{stmt:e,id2prop:n},t)}))})})]},u))}}}catch(p){d.e(p)}finally{d.f()}return Object(T.jsx)(R.b,{direction:"vertical",style:{width:"100%"},size:2,children:l})}))),Yn=n(147),Jn=Object(N.a)({root:{width:240}})(Object(Ge.a)((function(e){var t=e.entity,n=e.enable,r=e.setEnable,i=e.id2prop,a=e.filteredProps,o=e.addFilteredProp,s=e.removeFilteredProp,c=e.classes,l=Object(U.useMemo)((function(){return Object.keys(t.properties).map((function(e){return{label:"".concat(i[e].label," (").concat(e,")"),value:e}}))}),[i,t.id]);return Object(T.jsxs)("div",{children:[Object(T.jsx)(Yn.a,{onChange:function(){return r(!n)},checked:n,children:"Enable Filtering"}),Object(T.jsx)(ht.a,{mode:"multiple",allowClear:!0,options:l,optionFilterProp:"label",className:c.root,value:a,onSelect:o,onDeselect:s})]})}))),Qn=Object(N.a)({root:{"& > h2, p, span":{margin:0},minWidth:360}})(Object(Ge.a)((function(e){var t=e.entity,n=e.settings,r=Fn(t),i=Object(U.useState)(!0),a=Object(o.a)(i,2),s=a[0],c=a[1];return Object(T.jsxs)("div",{children:[Object(T.jsx)(R.b,{style:{float:"right"},children:Object(T.jsx)(Jn,{enable:s,setEnable:c,entity:t,id2prop:r,filteredProps:n.showedPropsInFullView,addFilteredProp:n.addShowedPropsInFullView,removeFilteredProp:n.removeShowedPropsInFullView})}),Object(T.jsxs)("h2",{children:[Object(T.jsx)($,{href:t.uri,openInNewPage:!0,children:t.label.lang2value[t.label.lang]}),"\xa0",Object(T.jsxs)(Ye.a.Text,{italic:!0,strong:!1,style:{fontSize:14,fontWeight:400},copyable:{text:t.id},children:["(",t.id,")"]})]}),Object(T.jsx)(Ye.a.Text,{type:"secondary",children:t.aliases.lang2values[t.aliases.lang].join(" | ")}),Object(T.jsx)("p",{children:t.description.lang2value[t.description.lang]}),Object(T.jsx)("hr",{}),Object(T.jsx)(Kn,{entity:t,id2prop:r,showId:!0,filteredProps:s?n.showedPropsInFullView:[]})]})})));function Gn(e,t){var n;n="string"!==typeof e?Object(T.jsx)(Qn,{entity:e.entity,settings:e.settings}):Object(T.jsx)(An,{entityId:e,render:function(e,t){return Object(T.jsx)(Qn,{entity:e,settings:t})}}),M.a.info({icon:null,content:n,bodyStyle:{margin:-8,marginTop:-16},okButtonProps:{style:{display:"none"}},maskClosable:!0,mask:!0,zIndex:t,width:"calc(100% - 128px)",style:{top:64}})}var Xn=["entity","children","classes","zIndex","settings"],$n=Object(N.a)({root:{"& > h2, p, span":{margin:0},minWidth:600}})((function(e){var t=e.entity,n=e.children,r=e.classes,i=e.zIndex,a=e.settings,o=Object(Tn.a)(e,Xn),s=Fn(t),c=Object(T.jsxs)("div",Object(fe.a)(Object(fe.a)({},o),{},{className:"".concat(r.root," ").concat(o.className),children:[Object(T.jsxs)("h2",{children:[Object(T.jsx)($,{href:t.uri,openInNewPage:!0,children:t.label.lang2value[t.label.lang]}),"\xa0",Object(T.jsxs)(Ye.a.Text,{italic:!0,strong:!1,style:{fontSize:14,fontWeight:400},copyable:{text:t.id},children:["(",t.id,")"]}),Object(T.jsx)(Dn.a,{style:{marginBottom:-2,paddingTop:4,cursor:"pointer"},onClick:function(){Gn({entity:t,settings:a},void 0!==i?i+1:void 0)}})]}),Object(T.jsx)(Ye.a.Text,{type:"secondary",children:t.aliases.lang2values[t.aliases.lang].join(" | ")}),Object(T.jsx)("p",{children:t.description.lang2value[t.description.lang]}),Object(T.jsx)("hr",{}),Object(T.jsx)(Kn,{id2prop:s,entity:t,filteredProps:a.showedPropsInPopoverView})]}));return Object(T.jsx)(Rn.a,{content:c,zIndex:i,children:n})})),Zn=n(306),er={treeNode:{},levelMarker:{},table:{"& th":{minWidth:30,textAlign:"left"}}},tr=Object(N.a)(er)(Object(Ge.a)((function(e){var t=e.types,n=e.classes,r=e.filter,i=Object(U.useState)([]),a=Object(o.a)(i,2),c=a[0],l=a[1];return Object(U.useMemo)((function(){for(var e=Object.fromEntries(Object.keys(t).map((function(e){return[e,new Set]}))),n=0,i=Object.values(t);n<i.length;n++){var a,c=i[n],d=Object(s.a)(c.parents);try{for(d.s();!(a=d.n()).done;){var u=a.value;void 0!==t[u]&&e[u].add(c.id)}}catch(S){d.e(S)}finally{d.f()}}for(var h=new Set(Object.keys(e)),p=0,f=Object.entries(e);p<f.length;p++){var b,v=Object(o.a)(f[p],2),j=(v[0],v[1]),g=Object(s.a)(j);try{for(g.s();!(b=g.n()).done;){var y=b.value;h.delete(y)}}catch(S){g.e(S)}finally{g.f()}}r.addTypes(Object.keys(t));var O,x={start:"",nodes:t,p2cs:e,visited:{},counter:0,filter:r},m=[],w=Object(s.a)(h);try{for(w.s();!(O=w.n()).done;){var k=O.value;x.start=k,rr(x,m)}}catch(S){w.e(S)}finally{w.f()}for(var I in e)void 0===x.visited[I]&&(x.start=I,rr(x,m));l(m)}),[Object.keys(t).sort().join("\t")]),Object(T.jsxs)(T.Fragment,{children:[Object(T.jsxs)("table",{className:n.table,children:[Object(T.jsx)("thead",{children:Object(T.jsxs)("tr",{children:[Object(T.jsx)("th",{children:Object(T.jsx)(Ye.a.Text,{type:"secondary",strong:!0,children:"#"})}),Object(T.jsx)("th",{children:Object(T.jsx)(sn.a,{title:"Include: select rows that have a specific type",children:Object(T.jsx)(Ye.a.Text,{type:"secondary",strong:!0,children:"In"})})}),Object(T.jsx)("th",{children:Object(T.jsx)(sn.a,{title:"Exclude: select rows that do not have a specific type",children:Object(T.jsx)(Ye.a.Text,{type:"secondary",strong:!0,children:"Ex"})})}),Object(T.jsx)("th",{children:Object(T.jsx)(Ye.a.Text,{type:"secondary",strong:!0,children:"Type"})})]})}),Object(T.jsxs)("tbody",{children:[Object(T.jsxs)("tr",{children:[Object(T.jsx)("td",{}),Object(T.jsx)(sn.a,{title:"Select all checkbox in this `Include` column",placement:"left",children:Object(T.jsx)("td",{children:Object(T.jsx)(Yn.a,{indeterminate:r.hasAnyOp("include")&&!r.hasAllOp("include"),checked:r.hasAllOp("include"),onChange:function(e){return r.toggleAllType("include",e.target.checked)}})})}),Object(T.jsx)(sn.a,{title:"Select all checkbox in this `Exclude` column",placement:"right",children:Object(T.jsx)("td",{children:Object(T.jsx)(Yn.a,{indeterminate:r.hasAnyOp("exclude")&&!r.hasAllOp("exclude"),checked:r.hasAllOp("exclude"),onChange:function(e){return r.toggleAllType("exclude",e.target.checked)}})})}),Object(T.jsx)("td",{children:Object(T.jsx)(Ye.a.Text,{type:"secondary",children:"(Select all)"})})]}),c]})]}),Object(T.jsx)(Zn.a,{style:{margin:"8px 0"}}),Object(T.jsxs)(R.b,{children:[Object(T.jsx)(Ye.a.Text,{type:"secondary",strong:!0,title:"Reset all filters",onClick:function(){return r.toggleAllType("null",!0)},style:{cursor:"pointer"},children:"Reset"}),Object(T.jsx)(Zn.a,{type:"vertical"}),Object(T.jsx)(sn.a,{title:"Select rows containing NIL entities",placement:"bottom",children:Object(T.jsxs)(Ye.a.Text,{type:"secondary",strong:!0,onClick:function(){return r.setSelectNil(!r.selectNil)},style:{cursor:"pointer",userSelect:"none"},children:[Object(T.jsx)(Yn.a,{checked:r.selectNil,onChange:function(e){return r.setSelectNil(e.target.checked)}}),"\xa0NIL Rows"]})}),Object(T.jsx)(Zn.a,{type:"vertical"}),Object(T.jsx)(sn.a,{title:"Select rows that do not link to any entity",placement:"bottom",children:Object(T.jsxs)(Ye.a.Text,{type:"secondary",strong:!0,onClick:function(){return r.setSelectUnlinked(!r.selectUnlinked)},style:{cursor:"pointer",userSelect:"none"},children:[Object(T.jsx)(Yn.a,{checked:r.selectUnlinked,onChange:function(e){return r.setSelectUnlinked(e.target.checked)}}),"\xa0Unlinked Rows"]})}),Object(T.jsx)(Zn.a,{type:"vertical"}),Object(T.jsx)(sn.a,{title:"Applying filters to candidate entities",placement:"bottom",children:Object(T.jsxs)(Ye.a.Text,{type:"secondary",strong:!0,onClick:function(){return r.setIncludeCandidateEntities(!r.includeCandidateEntities)},style:{cursor:"pointer",userSelect:"none"},children:[Object(T.jsx)(Yn.a,{checked:r.includeCandidateEntities,onChange:function(e){return r.setIncludeCandidateEntities(e.target.checked)}}),"\xa0Candidate entities"]})})]})]})}))),nr=Object(N.a)(er)(Object(Ge.a)((function(e){var t,n=e.nodeId,r=e.nodes,i=e.visited,a=e.unknown,o=e.depth,s=e.counter,c=e.classes,l=e.filter,d=(null===(t=r[n])||void 0===t?void 0:t.readableLabel)||n,u=[];if(0===o)u.push(Object(T.jsx)("span",{children:d},"2"));else{for(var h="",p=1;p<o;p++)h+="\u2502&nbsp;&nbsp;&nbsp;";u.push(Object(T.jsx)("code",{className:c.levelMarker,dangerouslySetInnerHTML:{__html:"".concat(h,"\u251c\u2500\u2500&nbsp;")}},"1")),u.push(Object(T.jsx)("span",{children:d},"2"))}return void 0!==i&&u.push(Object(T.jsxs)(Ye.a.Text,{type:"secondary",style:{marginLeft:4},children:["(visited at #",i,")"]})),a&&u.push(Object(T.jsx)(Ye.a.Text,{type:"secondary",style:{marginLeft:4},children:"(unknown)"})),Object(T.jsxs)("tr",{className:c.treeNode,children:[Object(T.jsx)("td",{title:"The index number of this type",children:Object(T.jsxs)(Ye.a.Text,{type:"secondary",children:[s,"."]})}),Object(T.jsx)("td",{title:"Select rows having entities of this type",children:void 0===i?Object(T.jsx)(Yn.a,{checked:"include"===l.type2op[n],onChange:function(e){l.setTypeOp(n,e.target.checked?"include":"null")}}):null}),Object(T.jsx)("td",{title:"Select rows having entities that do not be part of this type",children:void 0===i?Object(T.jsx)(Yn.a,{checked:"exclude"===l.type2op[n],onChange:function(e){l.setTypeOp(n,e.target.checked?"exclude":"null")}}):null}),Object(T.jsx)("td",{children:u})]})}))),rr=function(e,t){for(var n=[[e.start,0]];n.length>0;){e.counter+=1;var r=n.pop(),i=Object(o.a)(r,2),a=i[0],c=i[1];if(t.push(Object(T.jsx)(nr,{counter:e.counter,nodeId:a,nodes:e.nodes,unknown:void 0===e.nodes[a],depth:c,visited:e.visited[a],filter:e.filter},e.counter)),void 0===e.visited[a]){e.visited[a]=e.counter;var l,d=Object(s.a)(e.p2cs[a]);try{for(d.s();!(l=d.n()).done;){var u=l.value;n.push([u,c+1])}}catch(h){d.e(h)}finally{d.f()}}}},ir=function(e){var t=e.table,n=e.columnIndex,r=e.filter,i=Object(U.useState)("by-type"),a=Object(o.a)(i,2),s=a[0],c=(a[1],Ve()),l=c.assistantService,d=(c.semanticModelStore,c.classStore,Object(U.useState)({})),u=Object(o.a)(d,2),h=u[0],p=u[1],f=Object(U.useState)({includeNil:!1,includeUnlinked:!1}),b=Object(o.a)(f,2);b[0],b[1];Object(U.useEffect)((function(){"by-type"===s&&l.getColumnTypes(t,n,!1).then(p)}),[s]);var v=null;return"by-type"===s&&(v=Object(T.jsx)(tr,{types:h,filter:r},"".concat(t.id," ").concat(n))),Object(T.jsx)("div",{style:{minWidth:300,padding:8},children:Object(T.jsxs)(R.b,{style:{width:"100%"},direction:"vertical",children:[Object(T.jsx)(Ye.a.Text,{strong:!0,children:"Filter By Type"}),v]})})},ar=["value","fractionDigits"],or=function(e){var t=e.value,n=e.fractionDigits,r=Object(Tn.a)(e,ar);return Object(T.jsx)("span",Object(fe.a)(Object(fe.a)({title:t.toString()},r),{},{children:t.toFixed(n)}))},sr=Object(N.a)({checkboxIcon:{padding:"1px 2px",border:"1px solid",borderRadius:2,fontSize:12,marginBottom:-1}})((function(e){var t=e.icon,n=e.classes,r=e.selected,i=e.onChange,a=e.colorSelected,s=void 0===a?Xe.a[5]:a,c=e.colorUnselected,l=void 0===c?Xe.g[5]:c,d=Object(U.useState)(!1),u=Object(o.a)(d,2),h=u[0],p=u[1],f=void 0===r?h:r;return Object(T.jsx)(zt.a,{icon:t,color:f?s:l,className:n.checkboxIcon,onClick:function(){if(void 0!==r&&void 0!==i)return i(!r);p(!h),void 0!==i&&i(!h)}})})),cr=function(e){var t=e.children,n=e.title,r=e.ms,i=Object(U.useState)(!1),a=Object(o.a)(i,2),s=a[0],c=a[1];return Object(T.jsx)(sn.a,{title:n,visible:s,onVisibleChange:function(e){e&&(c(!0),setTimeout((function(){c(!1)}),r))},trigger:"click",children:t})},lr={correctCandidateEntity:{color:Xe.a[5]},candidateEntity:{color:Xe.g[5],"&:hover":{color:"".concat(Xe.g[5]," !important")}},candidateEntitySeeMore:{color:Xe.g[5],cursor:"pointer"}},dr=Object(N.a)(lr)(Object(Ge.a)((function(e){var t=e.record,n=e.index,r=e.classes,i=e.topK,a=void 0===i?3:i,c=Ve(),l=c.tableRowStore,d=c.tableStore,h=Object(U.useState)(!1),p=Object(o.a)(h,2),f=p[0],b=p[1],v=function(e){return function(r){return l.updateCellLinks(t,n,r?e:void 0,!1)}},j=function(e){return function(r){var i=t.row[n];if("number"===typeof i)throw new Error("Can't not link a number \"".concat(i,'" to an entity'));return l.updateColumnLinks(d.get(t.table),n,i,r?e:void 0)}},g=t.links[n]||[],y=[];if(g.length>0){var O,x=Object(s.a)(g[0].candidateEntities.slice(0,a));try{var m=function(){var e=O.value,t=e.entityId===g[0].entityId?r.correctCandidateEntity:r.candidateEntity;y.push(Object(T.jsx)("div",{children:Object(T.jsxs)(R.b,{size:4,children:[Object(T.jsx)(sr,{icon:Bt.a,selected:g[0].entityId===e.entityId,onChange:v(e.entityId)}),Object(T.jsx)(sr,{icon:Bt.b,selected:g[0].entityId===e.entityId,onChange:j(e.entityId)}),Object(T.jsx)(An,{entityId:e.entityId,render:function(e,n){return Object(T.jsx)($n,{entity:e,settings:n,children:Object(T.jsx)(Pn,{nolink:!0,entity:e,className:t})})}}),Object(T.jsxs)("span",{className:t,children:["(",Object(T.jsx)(or,{value:e.probability,fractionDigits:3}),")"]})]})},e.entityId))};for(x.s();!(O=x.n()).done;)m()}catch(C){x.e(C)}finally{x.f()}var w=g[0].candidateEntities.findIndex((function(e){return e.entityId===g[0].entityId}));if(-1!==w&&w>=a){var k=g[0].candidateEntities[w];y.push(Object(T.jsx)("div",{children:Object(T.jsxs)(R.b,{size:4,children:[Object(T.jsx)(sr,{icon:Bt.a,selected:g[0].entityId===k.entityId,onChange:v(k.entityId)}),Object(T.jsx)(sr,{icon:Bt.b,selected:g[0].entityId===k.entityId,onChange:j(k.entityId)}),Object(T.jsx)(An,{entityId:k.entityId,render:function(e,t){return Object(T.jsxs)("span",{className:r.correctCandidateEntity,children:["(",w,")\xa0",Object(T.jsx)($n,{entity:e,settings:t,children:Object(T.jsx)(Pn,{nolink:!0,entity:e})})]})}}),Object(T.jsxs)("span",{className:r.correctCandidateEntity,children:["(",Object(T.jsx)(or,{value:k.probability,fractionDigits:3}),")"]})]})},k.entityId))}g[0].candidateEntities.length>a&&y.push(Object(T.jsx)("div",{children:Object(T.jsx)(Ye.a.Text,{className:r.candidateEntitySeeMore,onClick:function(){return b(!f)},children:"See more"})},"see-more"))}var I=g.length>0&&g[0].entityId===ye.NIL_ENTITY?r.correctCandidateEntity:r.candidateEntity;y.push(Object(T.jsx)("div",{className:I,children:Object(T.jsxs)(R.b,{size:4,children:[Object(T.jsx)(sr,{icon:Bt.a,selected:g.length>0&&g[0].entityId===ye.NIL_ENTITY,onChange:v(ye.NIL_ENTITY)}),Object(T.jsx)(sr,{icon:Bt.b,selected:g.length>0&&g[0].entityId===ye.NIL_ENTITY,onChange:j(ye.NIL_ENTITY)}),Object(T.jsx)(An,{entityId:ye.NIL_ENTITY,render:function(e,t){return Object(T.jsx)($n,{entity:e,settings:t,children:Object(T.jsx)(Pn,{nolink:!0,entity:e,className:I})})}})]})},"nil-entity")),y.push(Object(T.jsx)("div",{className:r.candidateEntity,children:Object(T.jsxs)(R.b,{size:4,style:{cursor:"pointer"},onClick:function(){var e=Object(T.jsx)(Et,{onSelect:function(e){v(e)(!0).then((function(){M.a.destroyAll()}))}});M.a.info({title:Object(T.jsx)("span",{style:{marginBottom:16,display:"inline-block"},children:"Search Entity"}),content:e,bodyStyle:{margin:-8},okButtonProps:{style:{display:"none"}},maskClosable:!0,mask:!0})},children:[Object(T.jsx)(sr,{icon:Bt.d}),"Create"]})},"new-entity"));var S=[{dataIndex:"id",title:"Entity",render:function(e){return Object(T.jsx)(An,{entityId:e,render:function(e,t){return Object(T.jsx)($n,{entity:e,settings:t,children:Object(T.jsx)(Pn,{nolink:!0,entity:e})})}})}},{dataIndex:"score",title:"Score",render:function(e){return Object(T.jsx)(or,{value:e,fractionDigits:5})}},{title:"action",render:function(){return Object(T.jsx)(R.b,{size:4,children:Object(T.jsx)(F.a,{children:"Select"})})}}];return Object(T.jsxs)(H.a.Fragment,{children:[y,Object(T.jsx)(M.a,{title:"Candidate Entities",visible:f,style:{top:20},bodyStyle:{padding:0},width:"60%",onOk:function(){return b(!1)},onCancel:function(){return b(!1)},children:Object(T.jsx)(it.a,{defaultSize:"small",bordered:!0,search:!1,pagination:{pageSize:20,pageSizeOptions:["20","50","100","200","500","1000"]},rowKey:"id",columns:S,request:function(){var e=Object(he.a)(u.a.mark((function e(t,n,r){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",Promise.resolve({total:g.length>0?g[0].candidateEntities.length:0,success:!0,data:0===g.length?[]:g[0].candidateEntities.slice((t.current-1)*t.pageSize,t.current*t.pageSize).map((function(e,t){return{id:e.entityId,score:e.probability}}))}));case 1:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}()})})]})}))),ur={link:{textDecoration:"underline","&:hover":{textDecoration:"underline"}},noEntityLink:{color:Xe.g[5],"&:hover":{color:Xe.g[5]}}},hr=Object(N.a)(ur)(Object(Ge.a)((function(e){var t=e.cell,n=e.record,r=e.index,i=e.classes,a=e.topK,o=void 0===a?3:a,s=Ve().uiSettings,c=n.links[r]||[],l=c.flatMap((function(e,n){var r=0===n?t.substring(0,e.start):t.substring(c[n-1].end,e.start),a=t.substring(e.start,e.end),o=void 0;void 0!==e.entityId&&(o=function(){Gn(e.entityId)});var s=void 0===e.url&&void 0===e.entityId?a:Object(T.jsx)($,{href:e.url,openInNewPage:!0,dangerouslySetInnerHTML:{__html:""===a.trim()?"&blank;":a},className:i.link+(void 0===e.entityId||e.entityId===ye.NIL_ENTITY?" "+i.noEntityLink:""),style:null===e.entityId?{color:"#aaa"}:{},onCtrlClick:o},n);return void 0===e.entityId?[r,s]:[r,Object(T.jsx)(An,{entityId:e.entityId,render:function(e,t){return Object(T.jsx)($n,{entity:e,zIndex:500,settings:t,children:s})},renderNotFound:function(){return Object(T.jsx)("span",{className:i.noEntityLink,children:s})}},n)]}));return 0===c.length?l.push(t):l.push(t.substring(c[c.length-1].end)),Object(T.jsxs)("div",{children:[l,s.table.showEntityLinkingEditor&&"number"!==typeof n.row[r]?Object(T.jsx)(dr,{record:n,index:r,topK:o}):null]})}))),pr=function(){function e(t,n){var r=this;Object(c.a)(this,e),this.type2op={},this.selectNil=!1,this.selectUnlinked=!1,this.includeCandidateEntities=!0,this.columnIndex=void 0,this.onChange=void 0,this.addTypes=function(e){var t,n=Object(s.a)(e);try{for(n.s();!(t=n.n()).done;){var i=t.value;r.type2op[i]="null"}}catch(a){n.e(a)}finally{n.f()}},this.setIncludeCandidateEntities=function(e){r.includeCandidateEntities!==e&&(r.includeCandidateEntities=e,r.onChange())},this.setSelectNil=function(e){r.selectNil!==e&&(r.selectNil=e,r.onChange())},this.setSelectUnlinked=function(e){r.selectUnlinked!==e&&(r.selectUnlinked=e,r.onChange())},this.toggleAllType=function(e,t){var n=!1;if(t)for(var i in r.type2op)r.type2op[i]!==e&&(r.type2op[i]=e,n=!0);else for(var a in r.type2op)r.type2op[a]===e&&(r.type2op[a]="null",n=!0);n&&r.onChange()},this.setTypeOp=function(e,t){r.type2op[e]!==t&&(r.type2op[e]=t,r.onChange())},this.hasAnyOp=function(e){for(var t in r.type2op)if(r.type2op[t]===e)return!0;return!1},this.hasAllOp=function(e){for(var t in r.type2op)if(r.type2op[t]!==e)return!1;return!0},this.getFilterExec=function(e,t){var n=[],i=[];for(var a in r.type2op)"include"===r.type2op[a]?n.push(a):"exclude"===r.type2op[a]&&i.push(a);return function(){var a=Object(he.a)(u.a.mark((function a(o){var c,l,d,h,p,f,b,v,j,g,y,O;return u.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(r.hasFilter){a.next=2;break}return a.abrupt("return",!0);case 2:if(!r.selectNil&&!r.selectUnlinked){a.next=23;break}c=Object(s.a)(o.links[r.columnIndex]||[]),a.prev=4,c.s();case 6:if((l=c.n()).done){a.next=12;break}if(d=l.value,!(r.selectNil&&d.entityId===ye.NIL_ENTITY||r.selectUnlinked&&void 0===d.entityId)){a.next=10;break}return a.abrupt("return",!0);case 10:a.next=6;break;case 12:a.next=17;break;case 14:a.prev=14,a.t0=a.catch(4),c.e(a.t0);case 17:return a.prev=17,c.f(),a.finish(17);case 20:if(!r.selectUnlinked||0!==(o.links[r.columnIndex]||[]).length){a.next=22;break}return a.abrupt("return",!0);case 22:return a.abrupt("return",!1);case 23:h=new Set,p=Object(s.a)(o.links[r.columnIndex]||[]);try{for(p.s();!(f=p.n()).done;)if((b=f.value).entityId!==ye.NIL_ENTITY&&void 0!==b.entityId&&h.add(b.entityId),r.includeCandidateEntities){v=Object(s.a)(b.candidateEntities);try{for(v.s();!(j=v.n()).done;)g=j.value,h.add(g.entityId)}catch(u){v.e(u)}finally{v.f()}}}catch(u){p.e(u)}finally{p.f()}if(0!==h.size){a.next=28;break}return a.abrupt("return",!1);case 28:return a.next=30,e.fetchByIds(Array.from(h));case 30:return y=a.sent,a.next=33,t.fetchByIds(Object.values(y).flatMap((function(e){var t=ye.instanceof(e.uri);if(void 0===t||void 0===e.properties[t])return[];var n,r=[],i=Object(s.a)(e.properties[t]);try{for(i.s();!(n=i.n()).done;){var a=n.value;"entityid"===a.value.type&&r.push(a.value.value)}}catch(u){i.e(u)}finally{i.f()}return r})));case 33:return O=a.sent,a.abrupt("return",(0===n.length||Object.values(O).some((function(e){return n.some((function(t){return e.id===t||e.parentsClosure.has(t)}))})))&&(0===i.length||!Object.values(O).some((function(e){return i.some((function(t){return e.id===t||e.parentsClosure.has(t)}))}))));case 35:case"end":return a.stop()}}),a,null,[[4,14,17,20]])})));return function(e){return a.apply(this,arguments)}}()},this.columnIndex=t,this.onChange=n,Object(f.o)(this,{type2op:f.p,selectNil:f.p,selectUnlinked:f.p,includeCandidateEntities:f.p,hasFilter:f.g,addTypes:f.f,setSelectNil:f.f,setSelectUnlinked:f.f,setIncludeCandidateEntities:f.f,toggleAllType:f.f,setTypeOp:f.f})}return Object(l.a)(e,[{key:"hasFilter",get:function(){for(var e in this.type2op)if("null"!==this.type2op[e])return!0;return this.selectNil||this.selectUnlinked}}]),e}(),fr=Object(l.a)((function e(t,n){var r=this;Object(c.a)(this,e),this.columnFilters=[],this.onChange=function(e){},this.setOnChange=function(e){r.onChange=e},this.handleChange=function(){r.onChange(r)},this.hasFilter=function(){return r.columnFilters.some((function(e){return e.hasFilter}))},this.filter=function(){var e=Object(he.a)(u.a.mark((function e(t,n,i){var a,o;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=r.columnFilters.map((function(e){return e.getFilterExec(n,i)})),e.next=3,Promise.all(t.map((function(e){return Promise.all(a.map((function(t){return t(e)}))).then((function(e){return e.every((function(e){return e}))}))})));case 3:return o=e.sent,e.abrupt("return",t.filter((function(e,t){return o[t]})));case 5:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),void 0!==n&&(this.onChange=n);for(var i=0;i<t;i++)this.columnFilters.push(new pr(i,(function(){r.handleChange()})));Object(f.o)(this,{columnFilters:f.p,setOnChange:f.f})})),br={table:{width:"100%","& div.ant-table-container":{border:"1px solid #bbb",borderRadius:4,borderLeft:"1px solid #bbb !important"},"& div.ant-card-body":{paddingLeft:0,paddingRight:0},"& th":{fontWeight:600},"& .ant-table-cell":{verticalAlign:"top"}}},vr=Object(N.a)(br)(Object(Ge.a)(Object(U.forwardRef)((function(e,t){var n=e.table,r=e.query,i=e.classes,a=e.toolBarRender,s=e.showRowIndex,c=void 0!==s&&s,l=Object(U.useRef)(),d=Object(U.useState)(new fr(n.columns.length,(function(e){var t;null===(t=l.current)||void 0===t||t.reload(!0)}))),h=Object(o.a)(d,2),p=h[0];h[1];Object(U.useImperativeHandle)(t,(function(){return{reload:function(){var e;null===(e=l.current)||void 0===e||e.reload()}}}));var f=n.columns.map((function(e,t){return{dataIndex:["row",t],title:n.columns[t],render:function(e,n){return Object(T.jsx)(hr,{cell:e,record:n,index:t})},filterDropdown:Object(T.jsx)(ir,{table:n,columnIndex:t,filter:p.columnFilters[t]}),filterIcon:Object(T.jsx)(Ln.a,{style:{color:p.columnFilters[t].hasFilter?"#1890ff":void 0}})}}));return c&&f.splice(0,0,{title:Object(T.jsx)(Ye.a.Text,{type:"secondary",disabled:!0,children:"#"}),dataIndex:"index"}),Object(T.jsxs)(T.Fragment,{children:[Object(T.jsx)(it.a,{actionRef:l,className:i.table,defaultSize:"small",bordered:!0,params:{filter:p},request:function(){var e=Object(he.a)(u.a.mark((function e(t,n,i){var a,o,s;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r(t.pageSize,(t.current-1)*t.pageSize,t.filter);case 2:return a=e.sent,o=a.rows,s=a.total,e.abrupt("return",{data:o,success:!0,total:s});case 6:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),search:!1,pagination:{pageSize:5,pageSizeOptions:["5","10","20","50","100","200","500","1000"]},headerTitle:void 0!==n.contextPage.url?Object(T.jsx)($,{href:n.contextPage.url,openInNewPage:!0,children:n.name}):n.name,toolBarRender:a,rowKey:"index",columns:f}),Object(T.jsx)(jr,{table:n})]})})))),jr=function(e){var t=e.table,n=[["Description",t.description]];void 0!==t.contextPage.url?n.push(["From website",Object(T.jsx)($,{href:t.contextPage.url,openInNewPage:!0,children:t.contextPage.title})]):n.push(["From website","N/A"]),n.push(["Associated Entity",void 0!==t.contextPage.entityId?Object(T.jsx)(An,{entityId:t.contextPage.entityId,render:function(e,t){return Object(T.jsx)($n,{entity:e,zIndex:500,settings:t,children:Object(T.jsx)(Pn,{entity:e,onCtrlClick:function(){Gn({entity:e,settings:t})}})})},renderNotFound:function(){return Object(T.jsxs)("span",{children:["`Entity $",t.contextPage.entityId," does not exist`"]})}}):"N/A"]);var r=(t.contextHierarchy||[]).flatMap((function(e,t){return 0===e.level&&0===e.heading.trim().length&&e.contentBefore.every(Re)&&0===e.contentAfter.length?[]:[Object(T.jsx)("p",{children:Object(T.jsxs)("b",{children:["#".repeat(e.level)," ",e.heading]})},"".concat(t,"-head"))].concat(gr("".concat(t,"-before"),e.contentBefore)).concat(gr("".concat(t,"-after"),e.contentAfter))}));return n.push(["Content Hierarchy",r.length>0?Object(T.jsx)("div",{children:r}):"N/A"]),Object(T.jsx)(wt.b,{title:"Table Info",size:"small",children:n.map((function(e){var t=Object(o.a)(e,2),n=t[0],r=t[1];return Object(T.jsx)(wt.b.Item,{label:n,children:r},n)}))})},gr=function(e,t){var n,r=[[]],i=Object(s.a)(t);try{for(i.s();!(n=i.n()).done;){var a=n.value;Re(a)?r.push([]):r[r.length-1].push(a.value)}}catch(o){i.e(o)}finally{i.f()}return r.filter((function(e){return e.length>0})).map((function(t,n){return Object(T.jsx)("p",{children:t},"".concat(e,"-").concat(n))}))},yr=n(853);var Or=function(e){var t=e.project||new Te(0,"",""),n=function(e){var t=Ve().tableStore,n=50,r=Cr.table.useQueryParams(),i=null===r?"":r.query,a=Object(U.useMemo)((function(){return""!==i?t.decodeWhereQuery(i):{}}),[t,i]),s=Object(U.useState)({tableId:-1,tableIndex:-1,query:"",records:[],leftOffset:0,total:0,hasPrev:!1,hasNext:!1,allLeft:!1,allRight:!1,version:0}),c=Object(o.a)(s,2),l=c[0],d=c[1];Object(U.useEffect)((function(){var r=function(){var r=Object(he.a)(u.a.mark((function r(){var s,c,h,p,f,b,v,j,g;return u.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(s=st.a.sortedIndex(l.records,e),l.query===i&&l.records[s]===e){r.next=13;break}return r.next=5,Promise.all([t.query({limit:n,offset:0,fields:["id"],conditions:Object(fe.a)(Object(fe.a)({},a),{},{id:{op:"gte",value:e}})}),t.query({limit:n,offset:0,fields:["id"],conditions:Object(fe.a)(Object(fe.a)({},a),{},{id:{op:"lt",value:e}})})]);case 5:h=r.sent,p=Object(o.a)(h,2),f=p[0],b=p[1],v=b.records.map((function(e){return e.id})).concat(f.records.map((function(e){return e.id}))),c={tableIndex:b.records.length,records:v,total:b.total+f.total,leftOffset:b.total-b.records.length,allLeft:b.total<=n,allRight:f.total<=n,hasPrev:b.records.length>0,hasNext:f.records.length>1},r.next=28;break;case 13:if(0!==s||l.allLeft){r.next=20;break}return r.next=16,t.query({limit:n,offset:0,fields:["id"],conditions:Object(fe.a)(Object(fe.a)({},a),{},{id:{op:"lt",value:e}})});case 16:j=r.sent,c={tableIndex:j.records.length,leftOffset:j.total-j.records.length,records:j.records.map((function(e){return e.id})).concat(l.records),allLeft:j.total<=n,hasPrev:j.records.length>0},r.next=28;break;case 20:if(s!==l.records.length-1||l.allRight){r.next=27;break}return r.next=23,t.query({limit:n,offset:0,fields:["id"],conditions:Object(fe.a)(Object(fe.a)({},a),{},{id:{op:"gt",value:e}})});case 23:g=r.sent,c={tableIndex:s,records:l.records.concat(g.records.map((function(e){return e.id}))),allRight:g.total<=n,hasNext:g.records.length>0},r.next=28;break;case 27:c={tableIndex:s,hasNext:s<l.records.length-1,hasPrev:s>0};case 28:d(Object(fe.a)(Object(fe.a)(Object(fe.a)({},l),c),{},{version:l.version+1,query:i,tableId:e}));case 29:case"end":return r.stop()}}),r)})));return function(){return r.apply(this,arguments)}}();r()}),[e,i]);var h=function(t){if(e===l.tableId){var n=l.records[l.tableIndex+t];void 0!==n&&Cr.table.path({tableId:n},{query:i}).open()}};return{toPreviousTable:function(){h(-1)},toNextTable:function(){h(1)},navState:l}}(e.table.id),r=n.navState,i=n.toNextTable,a=n.toPreviousTable;return Object(Ht.a)("b",a,[r.version]),Object(Ht.a)("n",i,[r.version]),Object(T.jsx)(yr.a,{onBack:function(){return V.push(Cr.project.getURL({projectId:e.table.project}))},title:Object(T.jsxs)(R.b,{children:[Object(T.jsx)("span",{style:{fontWeight:500},children:"Table "}),Object(T.jsx)(cr,{title:"copied",ms:500,children:Object(T.jsx)("span",{style:{color:"#237804",textDecoration:"underline",cursor:"pointer"},onClick:function(){return navigator.clipboard.writeText(e.table.name)},children:e.table.name})})]},"title"),subTitle:Object(T.jsxs)(R.b,{children:[Object(T.jsxs)("span",{children:["(Project ",Object(T.jsx)("b",{children:t.name}),")"]}),Object(T.jsxs)("span",{className:"ml-2",children:["Position:"," ",Object(T.jsxs)("b",{children:[" ",r.leftOffset+r.tableIndex+1,"/",r.total]})]})]},"sub-title"),extra:[Object(T.jsx)(F.a,{onClick:a,disabled:!r.hasPrev,children:"Previous Table (B)"},"prev"),Object(T.jsx)(F.a,{onClick:i,disabled:!r.hasNext,children:"Next Table (N)"},"next")]})},xr=Object(N.a)({table:{marginTop:8,"& div.ant-table-container":{border:"1px solid #bbb",borderRadius:4,borderLeft:"1px solid #bbb !important"}},container:{marginLeft:24,marginRight:24}})(Object(Ge.a)((function(e){var t=e.classes,n=Ve(),r=n.projectStore,i=n.tableStore,a=n.tableRowStore,s=n.semanticModelStore,c=(n.assistantService,n.classStore),l=n.entityStore,d=Cr.table.useURLParams().tableId,h=function(e){var t=Ve(),n=t.tableStore,r=t.semanticModelStore,i=Object(U.useState)(!1),a=Object(o.a)(i,2),s=a[0],c=a[1],l=Object(U.useState)(0),d=Object(o.a)(l,2),u=d[0],h=d[1];Object(U.useEffect)((function(){r.hasByTable(e)||r.fetch({limit:1e3,offset:0,conditions:{table:e}}).then((function(){return c(!0)}))}),[r,e]);var p=n.get(e);if(void 0===p||null===p||!r.hasByTable(e)&&!s)return{index:u,sms:[],setIndex:h};var f=r.findByTable(e),b=r.getCreateDraftsByTable(p);if(u>=f.length+b.length){var v=r.getNewCreateDraftId(p),j=ke.getDefaultDraftSemanticModel(v,"sm-".concat(f.length),p);r.setCreateDraft(j),b.push(j)}u<f.length?f[u]:b[u-f.length];return{sms:f.concat(b),index:u,setIndex:h}}(d),p=h.sms,f=h.index,b=h.setIndex,v=Object(U.useRef)(),j=Object(U.useRef)();Object(U.useEffect)((function(){i.fetchById(d).then((function(e){void 0!==e&&r.fetchById(e.project)}))}),[i,r,s,d]);var g=i.get(d);return null===g?Object(T.jsx)(te,{}):void 0===g||0===p.length?Object(T.jsx)(_,{}):Object(T.jsxs)(H.a.Fragment,{children:[Object(T.jsx)(Or,{project:r.get(g.project),table:g}),Object(T.jsx)("div",{className:t.container,children:Object(T.jsxs)(R.b,{direction:"vertical",size:8,children:[Object(T.jsx)(Zt,{graphRef:j,tableRef:v,table:g,semanticmodel:{sms:p,index:f,setIndex:b}}),Object(T.jsx)(Cn,{ref:j,table:g,sm:p[f]},d),Object(T.jsx)(vr,{ref:v,toolBarRender:!1,table:g,query:function(){var e=Object(he.a)(u.a.mark((function e(t,n,r){var i,o,s;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r.hasFilter()){e.next=5;break}return e.next=3,a.fetchByTable(g,n,t);case 3:return i=e.sent,e.abrupt("return",{rows:i,total:g.size});case 5:return e.next=7,a.fetchByTable(g,0,g.size);case 7:return o=e.sent,e.next=10,r.filter(o,l,c);case 10:return s=e.sent,e.abrupt("return",{rows:s.slice(n,n+t),total:s.length});case 12:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),showRowIndex:!0},d),Object(T.jsx)(Tt,{})]})})]})})));var mr=n.p+"static/media/logo.e35779db.png",wr=n(864),kr=n(865),Ir=n(856),Sr=function(){return Object(T.jsx)("h1",{children:"Not supposed to see this page"})},Cr={project:new Y({component:xt,urlSchema:{projectId:"number"},pathDef:"/projects/:projectId"}),table:new W({component:xr,urlSchema:{tableId:"number"},querySchema:{query:"string"},pathDef:"/tables/:tableId"}),tableExportModel:new W({component:Sr,urlSchema:{tableId:"number"},querySchema:{attachment:"optionalboolean"},pathDef:"/api/table/:tableId/export-models"}),tableExportData:new W({component:Sr,urlSchema:{tableId:"number"},querySchema:{attachment:"optionalboolean"},pathDef:"/api/table/:tableId/export"}),settings:new K({component:function(){return Object(T.jsx)(We.a,{gutter:16,children:Object(T.jsx)(Ke.a,{className:"gutter-row",span:24})})},pathDef:"/settings",exact:!0}),upload:new K({component:nt,pathDef:"/upload",exact:!0}),projects:new K({component:nt,pathDef:"/projects",exact:!0}),home:new K({component:nt,pathDef:"/",exact:!0})};window._routes=Cr,function(e,t,n){if(void 0===n&&(n=new Set),Array.isArray(n)?n=new Set(n):n instanceof Set||(n=new Set(Object.keys(n))),"function"===typeof t)for(var r=0,i=Object.entries(e);r<i.length;r++){var a=Object(o.a)(i[r],2),s=a[0],c=a[1];n.has(s)||(c.routeDef.component=t(c.component,e))}else for(var l=0,d=Object.entries(e);l<d.length;l++){var u=Object(o.a)(d[l],2),h=u[0],p=u[1];n.has(h)||void 0===t[h]||(p.routeDef.component=t[h](p.component,e))}}(Cr,(function(e){return function(t){var n=H.a.createElement(e,t);return Object(T.jsxs)(R.b,{direction:"vertical",style:{width:"100%"},children:[Object(T.jsx)(ae,{menus:{home:Object(T.jsx)("img",{src:mr,alt:"logo"}),projects:{icon:Object(T.jsx)(wr.a,{}),children:"Projects"},upload:{icon:Object(T.jsx)(kr.a,{}),children:"Upload"},settings:{icon:Object(T.jsx)(Ir.a,{}),children:"Settings"}},routes:Cr,isFirstItemLogo:!0}),Object(T.jsx)("div",{className:"wide-container",children:n})]})}}),["table"]),He.uiSettings.fetchSettings().then((function(){i.a.render(Object(T.jsx)(qe.Provider,{value:He,children:Object(T.jsx)(de,{enUSLocale:!0,routes:Cr})}),document.getElementById("root"))})),ue()}},[[829,1,2]]]);
//# sourceMappingURL=main.31c472af.chunk.js.map